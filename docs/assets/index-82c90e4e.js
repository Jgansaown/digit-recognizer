var bo=Object.defineProperty;var yo=(i,t,e)=>t in i?bo(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var nt=(i,t,e)=>(yo(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))s(u);new MutationObserver(u=>{for(const g of u)if(g.type==="childList")for(const v of g.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&s(v)}).observe(document,{childList:!0,subtree:!0});function e(u){const g={};return u.integrity&&(g.integrity=u.integrity),u.referrerPolicy&&(g.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?g.credentials="include":u.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function s(u){if(u.ep)return;u.ep=!0;const g=e(u);fetch(u.href,g)}})();function yt(){}function je(i,t){for(const e in t)i[e]=t[e];return i}function _r(i){return i()}function Jn(){return Object.create(null)}function ce(i){i.forEach(_r)}function br(i){return typeof i=="function"}function Xt(i,t){return i!=i?t==t:i!==t||i&&typeof i=="object"||typeof i=="function"}function xo(i){return Object.keys(i).length===0}function Ni(i){const t={};for(const e in i)e[0]!=="$"&&(t[e]=i[e]);return t}function rt(i,t){i.appendChild(t)}function ft(i,t,e){i.insertBefore(t,e||null)}function ut(i){i.parentNode&&i.parentNode.removeChild(i)}function ot(i){return document.createElement(i)}function Vi(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function Jt(i){return document.createTextNode(i)}function bt(){return Jt(" ")}function jt(i,t,e,s){return i.addEventListener(t,e,s),()=>i.removeEventListener(t,e,s)}function ht(i,t,e){e==null?i.removeAttribute(t):i.getAttribute(t)!==e&&i.setAttribute(t,e)}function Yi(i,t){for(const e in t)ht(i,e,t[e])}function se(i){return i===""?null:+i}function Co(i){return Array.from(i.childNodes)}function Qn(i,t){t=""+t,i.data!==t&&(i.data=t)}function zt(i,t){i.value=t??""}function Ve(i,t,e,s){e==null?i.style.removeProperty(t):i.style.setProperty(t,e,s?"important":"")}function Zn(i,t,e){for(let s=0;s<i.options.length;s+=1){const u=i.options[s];if(u.__value===t){u.selected=!0;return}}(!e||t!==void 0)&&(i.selectedIndex=-1)}function So(i){const t=i.querySelector(":checked");return t&&t.__value}function wo(i,t,{bubbles:e=!1,cancelable:s=!1}={}){return new CustomEvent(i,{detail:t,bubbles:e,cancelable:s})}let ri;function Ze(i){ri=i}function yr(){if(!ri)throw new Error("Function called outside component initialization");return ri}function en(i){yr().$$.on_mount.push(i)}function xr(){const i=yr();return(t,e,{cancelable:s=!1}={})=>{const u=i.$$.callbacks[t];if(u){const g=wo(t,e,{cancelable:s});return u.slice().forEach(v=>{v.call(i,g)}),!g.defaultPrevented}return!0}}function To(i,t){const e=i.$$.callbacks[t.type];e&&e.slice().forEach(s=>s.call(this,t))}const Re=[],Zt=[];let Ie=[];const yn=[],Oo=Promise.resolve();let xn=!1;function ko(){xn||(xn=!0,Oo.then(Cr))}function Xi(i){Ie.push(i)}function Rn(i){yn.push(i)}const on=new Set;let Ee=0;function Cr(){if(Ee!==0)return;const i=ri;do{try{for(;Ee<Re.length;){const t=Re[Ee];Ee++,Ze(t),Po(t.$$)}}catch(t){throw Re.length=0,Ee=0,t}for(Ze(null),Re.length=0,Ee=0;Zt.length;)Zt.pop()();for(let t=0;t<Ie.length;t+=1){const e=Ie[t];on.has(e)||(on.add(e),e())}Ie.length=0}while(Re.length);for(;yn.length;)yn.pop()();xn=!1,on.clear(),Ze(i)}function Po(i){if(i.fragment!==null){i.update(),ce(i.before_update);const t=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,t),i.after_update.forEach(Xi)}}function Mo(i){const t=[],e=[];Ie.forEach(s=>i.indexOf(s)===-1?t.push(s):e.push(s)),e.forEach(s=>s()),Ie=t}const Fi=new Set;let Oe;function Do(){Oe={r:0,c:[],p:Oe}}function Ao(){Oe.r||ce(Oe.c),Oe=Oe.p}function Dt(i,t){i&&i.i&&(Fi.delete(i),i.i(t))}function Rt(i,t,e,s){if(i&&i.o){if(Fi.has(i))return;Fi.add(i),Oe.c.push(()=>{Fi.delete(i),s&&(e&&i.d(1),s())}),i.o(t)}else s&&s()}function Sr(i,t){const e={},s={},u={$$scope:1};let g=i.length;for(;g--;){const v=i[g],o=t[g];if(o){for(const n in v)n in o||(s[n]=1);for(const n in o)u[n]||(e[n]=o[n],u[n]=1);i[g]=o}else for(const n in v)u[n]=1}for(const v in s)v in e||(e[v]=void 0);return e}function In(i,t,e){const s=i.$$.props[t];s!==void 0&&(i.$$.bound[s]=e,e(i.$$.ctx[s]))}function qt(i){i&&i.c()}function Nt(i,t,e){const{fragment:s,after_update:u}=i.$$;s&&s.m(t,e),Xi(()=>{const g=i.$$.on_mount.map(_r).filter(br);i.$$.on_destroy?i.$$.on_destroy.push(...g):ce(g),i.$$.on_mount=[]}),u.forEach(Xi)}function Vt(i,t){const e=i.$$;e.fragment!==null&&(Mo(e.after_update),ce(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function Eo(i,t){i.$$.dirty[0]===-1&&(Re.push(i),ko(),i.$$.dirty.fill(0)),i.$$.dirty[t/31|0]|=1<<t%31}function Ht(i,t,e,s,u,g,v,o=[-1]){const n=ri;Ze(i);const h=i.$$={fragment:null,ctx:[],props:g,update:yt,not_equal:u,bound:Jn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(n?n.$$.context:[])),callbacks:Jn(),dirty:o,skip_bound:!1,root:t.target||n.$$.root};v&&v(h.root);let f=!1;if(h.ctx=e?e(i,t.props||{},(r,l,...a)=>{const d=a.length?a[0]:l;return h.ctx&&u(h.ctx[r],h.ctx[r]=d)&&(!h.skip_bound&&h.bound[r]&&h.bound[r](d),f&&Eo(i,r)),l}):[],h.update(),f=!0,ce(h.before_update),h.fragment=s?s(h.ctx):!1,t.target){if(t.hydrate){const r=Co(t.target);h.fragment&&h.fragment.l(r),r.forEach(ut)}else h.fragment&&h.fragment.c();t.intro&&Dt(i.$$.fragment),Nt(i,t.target,t.anchor),Cr()}Ze(n)}class Ut{constructor(){nt(this,"$$");nt(this,"$$set")}$destroy(){Vt(this,1),this.$destroy=yt}$on(t,e){if(!br(e))return yt;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const u=s.indexOf(e);u!==-1&&s.splice(u,1)}}$set(t){this.$$set&&!xo(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Fo="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Fo);function Lo(i){let t,e,s,u,g,v,o,n,h,f,r;return{c(){t=ot("h4"),t.textContent="Hyperparameters",e=bt(),s=ot("label"),u=Jt(`Number of Clusters (K)
    `),g=ot("input"),v=bt(),o=ot("label"),n=Jt(`Max Iteration
    `),h=ot("input"),ht(g,"type","number"),ht(h,"type","number")},m(l,a){ft(l,t,a),ft(l,e,a),ft(l,s,a),rt(s,u),rt(s,g),zt(g,i[0].n_clusters),ft(l,v,a),ft(l,o,a),rt(o,n),rt(o,h),zt(h,i[0].max_iter),f||(r=[jt(g,"input",i[1]),jt(h,"input",i[2])],f=!0)},p(l,[a]){a&1&&se(g.value)!==l[0].n_clusters&&zt(g,l[0].n_clusters),a&1&&se(h.value)!==l[0].max_iter&&zt(h,l[0].max_iter)},i:yt,o:yt,d(l){l&&(ut(t),ut(e),ut(s),ut(v),ut(o)),f=!1,ce(r)}}}function Ro(i,t,e){let{param:s}=t;function u(){s.n_clusters=se(this.value),e(0,s)}function g(){s.max_iter=se(this.value),e(0,s)}return i.$$set=v=>{"param"in v&&e(0,s=v.param)},[s,u,g]}class Io extends Ut{constructor(t){super(),Ht(this,t,Ro,Lo,Xt,{param:0})}}function Bo(i){let t,e,s,u,g,v,o;return{c(){t=ot("h4"),t.textContent="Hyperparameters",e=bt(),s=ot("label"),u=Jt(`K
    `),g=ot("input"),ht(g,"type","number")},m(n,h){ft(n,t,h),ft(n,e,h),ft(n,s,h),rt(s,u),rt(s,g),zt(g,i[0].k),v||(o=jt(g,"input",i[1]),v=!0)},p(n,[h]){h&1&&se(g.value)!==n[0].k&&zt(g,n[0].k)},i:yt,o:yt,d(n){n&&(ut(t),ut(e),ut(s)),v=!1,o()}}}function jo(i,t,e){let{param:s}=t;function u(){s.k=se(this.value),e(0,s)}return i.$$set=g=>{"param"in g&&e(0,s=g.param)},[s,u]}class zo extends Ut{constructor(t){super(),Ht(this,t,jo,Bo,Xt,{param:0})}}function Wo(i){let t,e,s,u,g,v,o,n,h,f,r;return{c(){t=ot("h4"),t.textContent="Hyperparameters",e=bt(),s=ot("label"),u=Jt(`Learning Rate
    `),g=ot("input"),v=bt(),o=ot("label"),n=Jt(`Max Iteration
    `),h=ot("input"),ht(g,"type","number"),ht(g,"min","0.0"),ht(g,"step","0.01"),ht(h,"type","number"),ht(h,"min","1")},m(l,a){ft(l,t,a),ft(l,e,a),ft(l,s,a),rt(s,u),rt(s,g),zt(g,i[0].learning_rate),ft(l,v,a),ft(l,o,a),rt(o,n),rt(o,h),zt(h,i[0].max_iter),f||(r=[jt(g,"input",i[1]),jt(h,"input",i[2])],f=!0)},p(l,[a]){a&1&&se(g.value)!==l[0].learning_rate&&zt(g,l[0].learning_rate),a&1&&se(h.value)!==l[0].max_iter&&zt(h,l[0].max_iter)},i:yt,o:yt,d(l){l&&(ut(t),ut(e),ut(s),ut(v),ut(o)),f=!1,ce(r)}}}function No(i,t,e){let{param:s}=t;function u(){s.learning_rate=se(this.value),e(0,s)}function g(){s.max_iter=se(this.value),e(0,s)}return i.$$set=v=>{"param"in v&&e(0,s=v.param)},[s,u,g]}class Vo extends Ut{constructor(t){super(),Ht(this,t,No,Wo,Xt,{param:0})}}/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function di(i){return i+.5|0}const ue=(i,t,e)=>Math.max(Math.min(i,e),t);function $e(i){return ue(di(i*2.55),0,255)}function ge(i){return ue(di(i*255),0,255)}function le(i){return ue(di(i/2.55)/100,0,1)}function ts(i){return ue(di(i*100),0,100)}const Gt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Cn=[..."0123456789ABCDEF"],Yo=i=>Cn[i&15],Xo=i=>Cn[(i&240)>>4]+Cn[i&15],mi=i=>(i&240)>>4===(i&15),Ho=i=>mi(i.r)&&mi(i.g)&&mi(i.b)&&mi(i.a);function Uo(i){var t=i.length,e;return i[0]==="#"&&(t===4||t===5?e={r:255&Gt[i[1]]*17,g:255&Gt[i[2]]*17,b:255&Gt[i[3]]*17,a:t===5?Gt[i[4]]*17:255}:(t===7||t===9)&&(e={r:Gt[i[1]]<<4|Gt[i[2]],g:Gt[i[3]]<<4|Gt[i[4]],b:Gt[i[5]]<<4|Gt[i[6]],a:t===9?Gt[i[7]]<<4|Gt[i[8]]:255})),e}const Go=(i,t)=>i<255?t(i):"";function $o(i){var t=Ho(i)?Yo:Xo;return i?"#"+t(i.r)+t(i.g)+t(i.b)+Go(i.a,t):void 0}const qo=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function wr(i,t,e){const s=t*Math.min(e,1-e),u=(g,v=(g+i/30)%12)=>e-s*Math.max(Math.min(v-3,9-v,1),-1);return[u(0),u(8),u(4)]}function Ko(i,t,e){const s=(u,g=(u+i/60)%6)=>e-e*t*Math.max(Math.min(g,4-g,1),0);return[s(5),s(3),s(1)]}function Jo(i,t,e){const s=wr(i,1,.5);let u;for(t+e>1&&(u=1/(t+e),t*=u,e*=u),u=0;u<3;u++)s[u]*=1-t-e,s[u]+=t;return s}function Qo(i,t,e,s,u){return i===u?(t-e)/s+(t<e?6:0):t===u?(e-i)/s+2:(i-t)/s+4}function Bn(i){const e=i.r/255,s=i.g/255,u=i.b/255,g=Math.max(e,s,u),v=Math.min(e,s,u),o=(g+v)/2;let n,h,f;return g!==v&&(f=g-v,h=o>.5?f/(2-g-v):f/(g+v),n=Qo(e,s,u,f,g),n=n*60+.5),[n|0,h||0,o]}function jn(i,t,e,s){return(Array.isArray(t)?i(t[0],t[1],t[2]):i(t,e,s)).map(ge)}function zn(i,t,e){return jn(wr,i,t,e)}function Zo(i,t,e){return jn(Jo,i,t,e)}function ta(i,t,e){return jn(Ko,i,t,e)}function Tr(i){return(i%360+360)%360}function ea(i){const t=qo.exec(i);let e=255,s;if(!t)return;t[5]!==s&&(e=t[6]?$e(+t[5]):ge(+t[5]));const u=Tr(+t[2]),g=+t[3]/100,v=+t[4]/100;return t[1]==="hwb"?s=Zo(u,g,v):t[1]==="hsv"?s=ta(u,g,v):s=zn(u,g,v),{r:s[0],g:s[1],b:s[2],a:e}}function ia(i,t){var e=Bn(i);e[0]=Tr(e[0]+t),e=zn(e),i.r=e[0],i.g=e[1],i.b=e[2]}function na(i){if(!i)return;const t=Bn(i),e=t[0],s=ts(t[1]),u=ts(t[2]);return i.a<255?`hsla(${e}, ${s}%, ${u}%, ${le(i.a)})`:`hsl(${e}, ${s}%, ${u}%)`}const es={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},is={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function sa(){const i={},t=Object.keys(is),e=Object.keys(es);let s,u,g,v,o;for(s=0;s<t.length;s++){for(v=o=t[s],u=0;u<e.length;u++)g=e[u],o=o.replace(g,es[g]);g=parseInt(is[v],16),i[o]=[g>>16&255,g>>8&255,g&255]}return i}let vi;function ra(i){vi||(vi=sa(),vi.transparent=[0,0,0,0]);const t=vi[i.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const oa=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function aa(i){const t=oa.exec(i);let e=255,s,u,g;if(t){if(t[7]!==s){const v=+t[7];e=t[8]?$e(v):ue(v*255,0,255)}return s=+t[1],u=+t[3],g=+t[5],s=255&(t[2]?$e(s):ue(s,0,255)),u=255&(t[4]?$e(u):ue(u,0,255)),g=255&(t[6]?$e(g):ue(g,0,255)),{r:s,g:u,b:g,a:e}}}function la(i){return i&&(i.a<255?`rgba(${i.r}, ${i.g}, ${i.b}, ${le(i.a)})`:`rgb(${i.r}, ${i.g}, ${i.b})`)}const an=i=>i<=.0031308?i*12.92:Math.pow(i,1/2.4)*1.055-.055,Fe=i=>i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4);function ha(i,t,e){const s=Fe(le(i.r)),u=Fe(le(i.g)),g=Fe(le(i.b));return{r:ge(an(s+e*(Fe(le(t.r))-s))),g:ge(an(u+e*(Fe(le(t.g))-u))),b:ge(an(g+e*(Fe(le(t.b))-g))),a:i.a+e*(t.a-i.a)}}function _i(i,t,e){if(i){let s=Bn(i);s[t]=Math.max(0,Math.min(s[t]+s[t]*e,t===0?360:1)),s=zn(s),i.r=s[0],i.g=s[1],i.b=s[2]}}function Or(i,t){return i&&Object.assign(t||{},i)}function ns(i){var t={r:0,g:0,b:0,a:255};return Array.isArray(i)?i.length>=3&&(t={r:i[0],g:i[1],b:i[2],a:255},i.length>3&&(t.a=ge(i[3]))):(t=Or(i,{r:0,g:0,b:0,a:1}),t.a=ge(t.a)),t}function ca(i){return i.charAt(0)==="r"?aa(i):ea(i)}class oi{constructor(t){if(t instanceof oi)return t;const e=typeof t;let s;e==="object"?s=ns(t):e==="string"&&(s=Uo(t)||ra(t)||ca(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=Or(this._rgb);return t&&(t.a=le(t.a)),t}set rgb(t){this._rgb=ns(t)}rgbString(){return this._valid?la(this._rgb):void 0}hexString(){return this._valid?$o(this._rgb):void 0}hslString(){return this._valid?na(this._rgb):void 0}mix(t,e){if(t){const s=this.rgb,u=t.rgb;let g;const v=e===g?.5:e,o=2*v-1,n=s.a-u.a,h=((o*n===-1?o:(o+n)/(1+o*n))+1)/2;g=1-h,s.r=255&h*s.r+g*u.r+.5,s.g=255&h*s.g+g*u.g+.5,s.b=255&h*s.b+g*u.b+.5,s.a=v*s.a+(1-v)*u.a,this.rgb=s}return this}interpolate(t,e){return t&&(this._rgb=ha(this._rgb,t._rgb,e)),this}clone(){return new oi(this.rgb)}alpha(t){return this._rgb.a=ge(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=di(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return _i(this._rgb,2,t),this}darken(t){return _i(this._rgb,2,-t),this}saturate(t){return _i(this._rgb,1,t),this}desaturate(t){return _i(this._rgb,1,-t),this}rotate(t){return ia(this._rgb,t),this}}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function re(){}const ua=(()=>{let i=0;return()=>i++})();function _t(i){return i===null||typeof i>"u"}function Ct(i){if(Array.isArray&&Array.isArray(i))return!0;const t=Object.prototype.toString.call(i);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function gt(i){return i!==null&&Object.prototype.toString.call(i)==="[object Object]"}function kt(i){return(typeof i=="number"||i instanceof Number)&&isFinite(+i)}function Bt(i,t){return kt(i)?i:t}function pt(i,t){return typeof i>"u"?t:i}const fa=(i,t)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100:+i/t,kr=(i,t)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100*t:+i;function wt(i,t,e){if(i&&typeof i.call=="function")return i.apply(e,t)}function vt(i,t,e,s){let u,g,v;if(Ct(i))if(g=i.length,s)for(u=g-1;u>=0;u--)t.call(e,i[u],u);else for(u=0;u<g;u++)t.call(e,i[u],u);else if(gt(i))for(v=Object.keys(i),g=v.length,u=0;u<g;u++)t.call(e,i[v[u]],v[u])}function Hi(i,t){let e,s,u,g;if(!i||!t||i.length!==t.length)return!1;for(e=0,s=i.length;e<s;++e)if(u=i[e],g=t[e],u.datasetIndex!==g.datasetIndex||u.index!==g.index)return!1;return!0}function Ui(i){if(Ct(i))return i.map(Ui);if(gt(i)){const t=Object.create(null),e=Object.keys(i),s=e.length;let u=0;for(;u<s;++u)t[e[u]]=Ui(i[e[u]]);return t}return i}function Pr(i){return["__proto__","prototype","constructor"].indexOf(i)===-1}function da(i,t,e,s){if(!Pr(i))return;const u=t[i],g=e[i];gt(u)&&gt(g)?ai(u,g,s):t[i]=Ui(g)}function ai(i,t,e){const s=Ct(t)?t:[t],u=s.length;if(!gt(i))return i;e=e||{};const g=e.merger||da;let v;for(let o=0;o<u;++o){if(v=s[o],!gt(v))continue;const n=Object.keys(v);for(let h=0,f=n.length;h<f;++h)g(n[h],i,v,e)}return i}function ti(i,t){return ai(i,t,{merger:ga})}function ga(i,t,e){if(!Pr(i))return;const s=t[i],u=e[i];gt(s)&&gt(u)?ti(s,u):Object.prototype.hasOwnProperty.call(t,i)||(t[i]=Ui(u))}const ss={"":i=>i,x:i=>i.x,y:i=>i.y};function pa(i){const t=i.split("."),e=[];let s="";for(const u of t)s+=u,s.endsWith("\\")?s=s.slice(0,-1)+".":(e.push(s),s="");return e}function ma(i){const t=pa(i);return e=>{for(const s of t){if(s==="")break;e=e&&e[s]}return e}}function me(i,t){return(ss[t]||(ss[t]=ma(t)))(i)}function Wn(i){return i.charAt(0).toUpperCase()+i.slice(1)}const li=i=>typeof i<"u",ve=i=>typeof i=="function",rs=(i,t)=>{if(i.size!==t.size)return!1;for(const e of i)if(!t.has(e))return!1;return!0};function va(i){return i.type==="mouseup"||i.type==="click"||i.type==="contextmenu"}const St=Math.PI,Pt=2*St,_a=Pt+St,Gi=Number.POSITIVE_INFINITY,ba=St/180,At=St/2,ye=St/4,os=St*2/3,fe=Math.log10,ne=Math.sign;function ei(i,t,e){return Math.abs(i-t)<e}function as(i){const t=Math.round(i);i=ei(i,t,i/1e3)?t:i;const e=Math.pow(10,Math.floor(fe(i))),s=i/e;return(s<=1?1:s<=2?2:s<=5?5:10)*e}function ya(i){const t=[],e=Math.sqrt(i);let s;for(s=1;s<e;s++)i%s===0&&(t.push(s),t.push(i/s));return e===(e|0)&&t.push(e),t.sort((u,g)=>u-g).pop(),t}function hi(i){return!isNaN(parseFloat(i))&&isFinite(i)}function xa(i,t){const e=Math.round(i);return e-t<=i&&e+t>=i}function Mr(i,t,e){let s,u,g;for(s=0,u=i.length;s<u;s++)g=i[s][e],isNaN(g)||(t.min=Math.min(t.min,g),t.max=Math.max(t.max,g))}function Qt(i){return i*(St/180)}function Nn(i){return i*(180/St)}function ls(i){if(!kt(i))return;let t=1,e=0;for(;Math.round(i*t)/t!==i;)t*=10,e++;return e}function Ca(i,t){const e=t.x-i.x,s=t.y-i.y,u=Math.sqrt(e*e+s*s);let g=Math.atan2(s,e);return g<-.5*St&&(g+=Pt),{angle:g,distance:u}}function Sn(i,t){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}function Sa(i,t){return(i-t+_a)%Pt-St}function Kt(i){return(i%Pt+Pt)%Pt}function $i(i,t,e,s){const u=Kt(i),g=Kt(t),v=Kt(e),o=Kt(g-u),n=Kt(v-u),h=Kt(u-g),f=Kt(u-v);return u===g||u===v||s&&g===v||o>n&&h<f}function Wt(i,t,e){return Math.max(t,Math.min(e,i))}function wa(i){return Wt(i,-32768,32767)}function wn(i,t,e,s=1e-6){return i>=Math.min(t,e)-s&&i<=Math.max(t,e)+s}function Vn(i,t,e){e=e||(v=>i[v]<t);let s=i.length-1,u=0,g;for(;s-u>1;)g=u+s>>1,e(g)?u=g:s=g;return{lo:u,hi:s}}const ke=(i,t,e,s)=>Vn(i,e,s?u=>{const g=i[u][t];return g<e||g===e&&i[u+1][t]===e}:u=>i[u][t]<e),Ta=(i,t,e)=>Vn(i,e,s=>i[s][t]>=e);function Oa(i,t,e){let s=0,u=i.length;for(;s<u&&i[s]<t;)s++;for(;u>s&&i[u-1]>e;)u--;return s>0||u<i.length?i.slice(s,u):i}const Dr=["push","pop","shift","splice","unshift"];function ka(i,t){if(i._chartjs){i._chartjs.listeners.push(t);return}Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Dr.forEach(e=>{const s="_onData"+Wn(e),u=i[e];Object.defineProperty(i,e,{configurable:!0,enumerable:!1,value(...g){const v=u.apply(this,g);return i._chartjs.listeners.forEach(o=>{typeof o[s]=="function"&&o[s](...g)}),v}})})}function hs(i,t){const e=i._chartjs;if(!e)return;const s=e.listeners,u=s.indexOf(t);u!==-1&&s.splice(u,1),!(s.length>0)&&(Dr.forEach(g=>{delete i[g]}),delete i._chartjs)}function Ar(i){const t=new Set(i);return t.size===i.length?i:Array.from(t)}const Er=function(){return typeof window>"u"?function(i){return i()}:window.requestAnimationFrame}();function Fr(i,t){let e=[],s=!1;return function(...u){e=u,s||(s=!0,Er.call(window,()=>{s=!1,i.apply(t,e)}))}}function Pa(i,t){let e;return function(...s){return t?(clearTimeout(e),e=setTimeout(i,t,s)):i.apply(this,s),t}}const Lr=i=>i==="start"?"left":i==="end"?"right":"center",ii=(i,t,e)=>i==="start"?t:i==="end"?e:(t+e)/2;function Ma(i,t,e){const s=t.length;let u=0,g=s;if(i._sorted){const{iScale:v,_parsed:o}=i,n=v.axis,{min:h,max:f,minDefined:r,maxDefined:l}=v.getUserBounds();r&&(u=Wt(Math.min(ke(o,n,h).lo,e?s:ke(t,n,v.getPixelForValue(h)).lo),0,s-1)),l?g=Wt(Math.max(ke(o,v.axis,f,!0).hi+1,e?0:ke(t,n,v.getPixelForValue(f),!0).hi+1),u,s)-u:g=s-u}return{start:u,count:g}}function Da(i){const{xScale:t,yScale:e,_scaleRanges:s}=i,u={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!s)return i._scaleRanges=u,!0;const g=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==e.min||s.ymax!==e.max;return Object.assign(s,u),g}const bi=i=>i===0||i===1,cs=(i,t,e)=>-(Math.pow(2,10*(i-=1))*Math.sin((i-t)*Pt/e)),us=(i,t,e)=>Math.pow(2,-10*i)*Math.sin((i-t)*Pt/e)+1,ni={linear:i=>i,easeInQuad:i=>i*i,easeOutQuad:i=>-i*(i-2),easeInOutQuad:i=>(i/=.5)<1?.5*i*i:-.5*(--i*(i-2)-1),easeInCubic:i=>i*i*i,easeOutCubic:i=>(i-=1)*i*i+1,easeInOutCubic:i=>(i/=.5)<1?.5*i*i*i:.5*((i-=2)*i*i+2),easeInQuart:i=>i*i*i*i,easeOutQuart:i=>-((i-=1)*i*i*i-1),easeInOutQuart:i=>(i/=.5)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2),easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>(i-=1)*i*i*i*i+1,easeInOutQuint:i=>(i/=.5)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2),easeInSine:i=>-Math.cos(i*At)+1,easeOutSine:i=>Math.sin(i*At),easeInOutSine:i=>-.5*(Math.cos(St*i)-1),easeInExpo:i=>i===0?0:Math.pow(2,10*(i-1)),easeOutExpo:i=>i===1?1:-Math.pow(2,-10*i)+1,easeInOutExpo:i=>bi(i)?i:i<.5?.5*Math.pow(2,10*(i*2-1)):.5*(-Math.pow(2,-10*(i*2-1))+2),easeInCirc:i=>i>=1?i:-(Math.sqrt(1-i*i)-1),easeOutCirc:i=>Math.sqrt(1-(i-=1)*i),easeInOutCirc:i=>(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1),easeInElastic:i=>bi(i)?i:cs(i,.075,.3),easeOutElastic:i=>bi(i)?i:us(i,.075,.3),easeInOutElastic(i){return bi(i)?i:i<.5?.5*cs(i*2,.1125,.45):.5+.5*us(i*2-1,.1125,.45)},easeInBack(i){return i*i*((1.70158+1)*i-1.70158)},easeOutBack(i){return(i-=1)*i*((1.70158+1)*i+1.70158)+1},easeInOutBack(i){let t=1.70158;return(i/=.5)<1?.5*(i*i*(((t*=1.525)+1)*i-t)):.5*((i-=2)*i*(((t*=1.525)+1)*i+t)+2)},easeInBounce:i=>1-ni.easeOutBounce(1-i),easeOutBounce(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},easeInOutBounce:i=>i<.5?ni.easeInBounce(i*2)*.5:ni.easeOutBounce(i*2-1)*.5+.5};function Yn(i){if(i&&typeof i=="object"){const t=i.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function fs(i){return Yn(i)?i:new oi(i)}function ln(i){return Yn(i)?i:new oi(i).saturate(.5).darken(.1).hexString()}const Aa=["x","y","borderWidth","radius","tension"],Ea=["color","borderColor","backgroundColor"];function Fa(i){i.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),i.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),i.set("animations",{colors:{type:"color",properties:Ea},numbers:{type:"number",properties:Aa}}),i.describe("animations",{_fallback:"animation"}),i.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function La(i){i.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const ds=new Map;function Ra(i,t){t=t||{};const e=i+JSON.stringify(t);let s=ds.get(e);return s||(s=new Intl.NumberFormat(i,t),ds.set(e,s)),s}function gi(i,t,e){return Ra(t,e).format(i)}const Rr={values(i){return Ct(i)?i:""+i},numeric(i,t,e){if(i===0)return"0";const s=this.chart.options.locale;let u,g=i;if(e.length>1){const h=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(h<1e-4||h>1e15)&&(u="scientific"),g=Ia(i,e)}const v=fe(Math.abs(g)),o=isNaN(v)?1:Math.max(Math.min(-1*Math.floor(v),20),0),n={notation:u,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(n,this.options.ticks.format),gi(i,s,n)},logarithmic(i,t,e){if(i===0)return"0";const s=e[t].significand||i/Math.pow(10,Math.floor(fe(i)));return[1,2,3,5,10,15].includes(s)||t>.8*e.length?Rr.numeric.call(this,i,t,e):""}};function Ia(i,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&i!==Math.floor(i)&&(e=i-Math.floor(i)),e}var nn={formatters:Rr};function Ba(i){i.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:nn.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),i.route("scale.ticks","color","","color"),i.route("scale.grid","color","","borderColor"),i.route("scale.border","color","","borderColor"),i.route("scale.title","color","","color"),i.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),i.describe("scales",{_fallback:"scale"}),i.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Me=Object.create(null),Tn=Object.create(null);function si(i,t){if(!t)return i;const e=t.split(".");for(let s=0,u=e.length;s<u;++s){const g=e[s];i=i[g]||(i[g]=Object.create(null))}return i}function hn(i,t,e){return typeof t=="string"?ai(si(i,t),e):ai(si(i,""),t)}class ja{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,u)=>ln(u.backgroundColor),this.hoverBorderColor=(s,u)=>ln(u.borderColor),this.hoverColor=(s,u)=>ln(u.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return hn(this,t,e)}get(t){return si(this,t)}describe(t,e){return hn(Tn,t,e)}override(t,e){return hn(Me,t,e)}route(t,e,s,u){const g=si(this,t),v=si(this,s),o="_"+e;Object.defineProperties(g,{[o]:{value:g[e],writable:!0},[e]:{enumerable:!0,get(){const n=this[o],h=v[u];return gt(n)?Object.assign({},h,n):pt(n,h)},set(n){this[o]=n}}})}apply(t){t.forEach(e=>e(this))}}var Tt=new ja({_scriptable:i=>!i.startsWith("on"),_indexable:i=>i!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Fa,La,Ba]);function za(i){return!i||_t(i.size)||_t(i.family)?null:(i.style?i.style+" ":"")+(i.weight?i.weight+" ":"")+i.size+"px "+i.family}function qi(i,t,e,s,u){let g=t[u];return g||(g=t[u]=i.measureText(u).width,e.push(u)),g>s&&(s=g),s}function Wa(i,t,e,s){s=s||{};let u=s.data=s.data||{},g=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(u=s.data={},g=s.garbageCollect=[],s.font=t),i.save(),i.font=t;let v=0;const o=e.length;let n,h,f,r,l;for(n=0;n<o;n++)if(r=e[n],r!=null&&!Ct(r))v=qi(i,u,g,v,r);else if(Ct(r))for(h=0,f=r.length;h<f;h++)l=r[h],l!=null&&!Ct(l)&&(v=qi(i,u,g,v,l));i.restore();const a=g.length/2;if(a>e.length){for(n=0;n<a;n++)delete u[g[n]];g.splice(0,a)}return v}function xe(i,t,e){const s=i.currentDevicePixelRatio,u=e!==0?Math.max(e/2,.5):0;return Math.round((t-u)*s)/s+u}function gs(i,t){t=t||i.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,i.width,i.height),t.restore()}function On(i,t,e,s){Na(i,t,e,s,null)}function Na(i,t,e,s,u){let g,v,o,n,h,f,r,l;const a=t.pointStyle,d=t.rotation,p=t.radius;let c=(d||0)*ba;if(a&&typeof a=="object"&&(g=a.toString(),g==="[object HTMLImageElement]"||g==="[object HTMLCanvasElement]")){i.save(),i.translate(e,s),i.rotate(c),i.drawImage(a,-a.width/2,-a.height/2,a.width,a.height),i.restore();return}if(!(isNaN(p)||p<=0)){switch(i.beginPath(),a){default:u?i.ellipse(e,s,u/2,p,0,0,Pt):i.arc(e,s,p,0,Pt),i.closePath();break;case"triangle":f=u?u/2:p,i.moveTo(e+Math.sin(c)*f,s-Math.cos(c)*p),c+=os,i.lineTo(e+Math.sin(c)*f,s-Math.cos(c)*p),c+=os,i.lineTo(e+Math.sin(c)*f,s-Math.cos(c)*p),i.closePath();break;case"rectRounded":h=p*.516,n=p-h,v=Math.cos(c+ye)*n,r=Math.cos(c+ye)*(u?u/2-h:n),o=Math.sin(c+ye)*n,l=Math.sin(c+ye)*(u?u/2-h:n),i.arc(e-r,s-o,h,c-St,c-At),i.arc(e+l,s-v,h,c-At,c),i.arc(e+r,s+o,h,c,c+At),i.arc(e-l,s+v,h,c+At,c+St),i.closePath();break;case"rect":if(!d){n=Math.SQRT1_2*p,f=u?u/2:n,i.rect(e-f,s-n,2*f,2*n);break}c+=ye;case"rectRot":r=Math.cos(c)*(u?u/2:p),v=Math.cos(c)*p,o=Math.sin(c)*p,l=Math.sin(c)*(u?u/2:p),i.moveTo(e-r,s-o),i.lineTo(e+l,s-v),i.lineTo(e+r,s+o),i.lineTo(e-l,s+v),i.closePath();break;case"crossRot":c+=ye;case"cross":r=Math.cos(c)*(u?u/2:p),v=Math.cos(c)*p,o=Math.sin(c)*p,l=Math.sin(c)*(u?u/2:p),i.moveTo(e-r,s-o),i.lineTo(e+r,s+o),i.moveTo(e+l,s-v),i.lineTo(e-l,s+v);break;case"star":r=Math.cos(c)*(u?u/2:p),v=Math.cos(c)*p,o=Math.sin(c)*p,l=Math.sin(c)*(u?u/2:p),i.moveTo(e-r,s-o),i.lineTo(e+r,s+o),i.moveTo(e+l,s-v),i.lineTo(e-l,s+v),c+=ye,r=Math.cos(c)*(u?u/2:p),v=Math.cos(c)*p,o=Math.sin(c)*p,l=Math.sin(c)*(u?u/2:p),i.moveTo(e-r,s-o),i.lineTo(e+r,s+o),i.moveTo(e+l,s-v),i.lineTo(e-l,s+v);break;case"line":v=u?u/2:Math.cos(c)*p,o=Math.sin(c)*p,i.moveTo(e-v,s-o),i.lineTo(e+v,s+o);break;case"dash":i.moveTo(e,s),i.lineTo(e+Math.cos(c)*(u?u/2:p),s+Math.sin(c)*p);break;case!1:i.closePath();break}i.fill(),t.borderWidth>0&&i.stroke()}}function he(i,t,e){return e=e||.5,!t||i&&i.x>t.left-e&&i.x<t.right+e&&i.y>t.top-e&&i.y<t.bottom+e}function Ir(i,t){i.save(),i.beginPath(),i.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),i.clip()}function Br(i){i.restore()}function Va(i,t,e,s,u){if(!t)return i.lineTo(e.x,e.y);if(u==="middle"){const g=(t.x+e.x)/2;i.lineTo(g,t.y),i.lineTo(g,e.y)}else u==="after"!=!!s?i.lineTo(t.x,e.y):i.lineTo(e.x,t.y);i.lineTo(e.x,e.y)}function Ya(i,t,e,s){if(!t)return i.lineTo(e.x,e.y);i.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?e.cp2x:e.cp1x,s?e.cp2y:e.cp1y,e.x,e.y)}function Xa(i,t){t.translation&&i.translate(t.translation[0],t.translation[1]),_t(t.rotation)||i.rotate(t.rotation),t.color&&(i.fillStyle=t.color),t.textAlign&&(i.textAlign=t.textAlign),t.textBaseline&&(i.textBaseline=t.textBaseline)}function Ha(i,t,e,s,u){if(u.strikethrough||u.underline){const g=i.measureText(s),v=t-g.actualBoundingBoxLeft,o=t+g.actualBoundingBoxRight,n=e-g.actualBoundingBoxAscent,h=e+g.actualBoundingBoxDescent,f=u.strikethrough?(n+h)/2:h;i.strokeStyle=i.fillStyle,i.beginPath(),i.lineWidth=u.decorationWidth||2,i.moveTo(v,f),i.lineTo(o,f),i.stroke()}}function Ua(i,t){const e=i.fillStyle;i.fillStyle=t.color,i.fillRect(t.left,t.top,t.width,t.height),i.fillStyle=e}function ci(i,t,e,s,u,g={}){const v=Ct(t)?t:[t],o=g.strokeWidth>0&&g.strokeColor!=="";let n,h;for(i.save(),i.font=u.string,Xa(i,g),n=0;n<v.length;++n)h=v[n],g.backdrop&&Ua(i,g.backdrop),o&&(g.strokeColor&&(i.strokeStyle=g.strokeColor),_t(g.strokeWidth)||(i.lineWidth=g.strokeWidth),i.strokeText(h,e,s,g.maxWidth)),i.fillText(h,e,s,g.maxWidth),Ha(i,e,s,h,g),s+=Number(u.lineHeight);i.restore()}function Ki(i,t){const{x:e,y:s,w:u,h:g,radius:v}=t;i.arc(e+v.topLeft,s+v.topLeft,v.topLeft,1.5*St,St,!0),i.lineTo(e,s+g-v.bottomLeft),i.arc(e+v.bottomLeft,s+g-v.bottomLeft,v.bottomLeft,St,At,!0),i.lineTo(e+u-v.bottomRight,s+g),i.arc(e+u-v.bottomRight,s+g-v.bottomRight,v.bottomRight,At,0,!0),i.lineTo(e+u,s+v.topRight),i.arc(e+u-v.topRight,s+v.topRight,v.topRight,0,-At,!0),i.lineTo(e+v.topLeft,s)}const Ga=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,$a=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function qa(i,t){const e=(""+i).match(Ga);if(!e||e[1]==="normal")return t*1.2;switch(i=+e[2],e[3]){case"px":return i;case"%":i/=100;break}return t*i}const Ka=i=>+i||0;function jr(i,t){const e={},s=gt(t),u=s?Object.keys(t):t,g=gt(i)?s?v=>pt(i[v],i[t[v]]):v=>i[v]:()=>i;for(const v of u)e[v]=Ka(g(v));return e}function zr(i){return jr(i,{top:"y",right:"x",bottom:"y",left:"x"})}function Be(i){return jr(i,["topLeft","topRight","bottomLeft","bottomRight"])}function Yt(i){const t=zr(i);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Et(i,t){i=i||{},t=t||Tt.font;let e=pt(i.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let s=pt(i.style,t.style);s&&!(""+s).match($a)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const u={family:pt(i.family,t.family),lineHeight:qa(pt(i.lineHeight,t.lineHeight),e),size:e,style:s,weight:pt(i.weight,t.weight),string:""};return u.string=za(u),u}function yi(i,t,e,s){let u=!0,g,v,o;for(g=0,v=i.length;g<v;++g)if(o=i[g],o!==void 0&&(t!==void 0&&typeof o=="function"&&(o=o(t),u=!1),e!==void 0&&Ct(o)&&(o=o[e%o.length],u=!1),o!==void 0))return s&&!u&&(s.cacheable=!1),o}function Ja(i,t,e){const{min:s,max:u}=i,g=kr(t,(u-s)/2),v=(o,n)=>e&&o===0?0:o+n;return{min:v(s,-Math.abs(g)),max:v(u,g)}}function _e(i,t){return Object.assign(Object.create(i),t)}function Xn(i,t=[""],e,s,u=()=>i[0]){const g=e||i;typeof s>"u"&&(s=Yr("_fallback",i));const v={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:g,_fallback:s,_getTarget:u,override:o=>Xn([o,...i],t,g,s)};return new Proxy(v,{deleteProperty(o,n){return delete o[n],delete o._keys,delete i[0][n],!0},get(o,n){return Nr(o,n,()=>rl(n,t,i,o))},getOwnPropertyDescriptor(o,n){return Reflect.getOwnPropertyDescriptor(o._scopes[0],n)},getPrototypeOf(){return Reflect.getPrototypeOf(i[0])},has(o,n){return ms(o).includes(n)},ownKeys(o){return ms(o)},set(o,n,h){const f=o._storage||(o._storage=u());return o[n]=f[n]=h,delete o._keys,!0}})}function ze(i,t,e,s){const u={_cacheable:!1,_proxy:i,_context:t,_subProxy:e,_stack:new Set,_descriptors:Wr(i,s),setContext:g=>ze(i,g,e,s),override:g=>ze(i.override(g),t,e,s)};return new Proxy(u,{deleteProperty(g,v){return delete g[v],delete i[v],!0},get(g,v,o){return Nr(g,v,()=>Za(g,v,o))},getOwnPropertyDescriptor(g,v){return g._descriptors.allKeys?Reflect.has(i,v)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(i,v)},getPrototypeOf(){return Reflect.getPrototypeOf(i)},has(g,v){return Reflect.has(i,v)},ownKeys(){return Reflect.ownKeys(i)},set(g,v,o){return i[v]=o,delete g[v],!0}})}function Wr(i,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:s=t.indexable,_allKeys:u=t.allKeys}=i;return{allKeys:u,scriptable:e,indexable:s,isScriptable:ve(e)?e:()=>e,isIndexable:ve(s)?s:()=>s}}const Qa=(i,t)=>i?i+Wn(t):t,Hn=(i,t)=>gt(t)&&i!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Nr(i,t,e){if(Object.prototype.hasOwnProperty.call(i,t))return i[t];const s=e();return i[t]=s,s}function Za(i,t,e){const{_proxy:s,_context:u,_subProxy:g,_descriptors:v}=i;let o=s[t];return ve(o)&&v.isScriptable(t)&&(o=tl(t,o,i,e)),Ct(o)&&o.length&&(o=el(t,o,i,v.isIndexable)),Hn(t,o)&&(o=ze(o,u,g&&g[t],v)),o}function tl(i,t,e,s){const{_proxy:u,_context:g,_subProxy:v,_stack:o}=e;if(o.has(i))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+i);o.add(i);let n=t(g,v||s);return o.delete(i),Hn(i,n)&&(n=Un(u._scopes,u,i,n)),n}function el(i,t,e,s){const{_proxy:u,_context:g,_subProxy:v,_descriptors:o}=e;if(typeof g.index<"u"&&s(i))return t[g.index%t.length];if(gt(t[0])){const n=t,h=u._scopes.filter(f=>f!==n);t=[];for(const f of n){const r=Un(h,u,i,f);t.push(ze(r,g,v&&v[i],o))}}return t}function Vr(i,t,e){return ve(i)?i(t,e):i}const il=(i,t)=>i===!0?t:typeof i=="string"?me(t,i):void 0;function nl(i,t,e,s,u){for(const g of t){const v=il(e,g);if(v){i.add(v);const o=Vr(v._fallback,e,u);if(typeof o<"u"&&o!==e&&o!==s)return o}else if(v===!1&&typeof s<"u"&&e!==s)return null}return!1}function Un(i,t,e,s){const u=t._rootScopes,g=Vr(t._fallback,e,s),v=[...i,...u],o=new Set;o.add(s);let n=ps(o,v,e,g||e,s);return n===null||typeof g<"u"&&g!==e&&(n=ps(o,v,g,n,s),n===null)?!1:Xn(Array.from(o),[""],u,g,()=>sl(t,e,s))}function ps(i,t,e,s,u){for(;e;)e=nl(i,t,e,s,u);return e}function sl(i,t,e){const s=i._getTarget();t in s||(s[t]={});const u=s[t];return Ct(u)&&gt(e)?e:u||{}}function rl(i,t,e,s){let u;for(const g of t)if(u=Yr(Qa(g,i),e),typeof u<"u")return Hn(i,u)?Un(e,s,i,u):u}function Yr(i,t){for(const e of t){if(!e)continue;const s=e[i];if(typeof s<"u")return s}}function ms(i){let t=i._keys;return t||(t=i._keys=ol(i._scopes)),t}function ol(i){const t=new Set;for(const e of i)for(const s of Object.keys(e).filter(u=>!u.startsWith("_")))t.add(s);return Array.from(t)}function al(i,t,e,s){const{iScale:u}=i,{key:g="r"}=this._parsing,v=new Array(s);let o,n,h,f;for(o=0,n=s;o<n;++o)h=o+e,f=t[h],v[o]={r:u.parse(me(f,g),h)};return v}const ll=Number.EPSILON||1e-14,We=(i,t)=>t<i.length&&!i[t].skip&&i[t],Xr=i=>i==="x"?"y":"x";function hl(i,t,e,s){const u=i.skip?t:i,g=t,v=e.skip?t:e,o=Sn(g,u),n=Sn(v,g);let h=o/(o+n),f=n/(o+n);h=isNaN(h)?0:h,f=isNaN(f)?0:f;const r=s*h,l=s*f;return{previous:{x:g.x-r*(v.x-u.x),y:g.y-r*(v.y-u.y)},next:{x:g.x+l*(v.x-u.x),y:g.y+l*(v.y-u.y)}}}function cl(i,t,e){const s=i.length;let u,g,v,o,n,h=We(i,0);for(let f=0;f<s-1;++f)if(n=h,h=We(i,f+1),!(!n||!h)){if(ei(t[f],0,ll)){e[f]=e[f+1]=0;continue}u=e[f]/t[f],g=e[f+1]/t[f],o=Math.pow(u,2)+Math.pow(g,2),!(o<=9)&&(v=3/Math.sqrt(o),e[f]=u*v*t[f],e[f+1]=g*v*t[f])}}function ul(i,t,e="x"){const s=Xr(e),u=i.length;let g,v,o,n=We(i,0);for(let h=0;h<u;++h){if(v=o,o=n,n=We(i,h+1),!o)continue;const f=o[e],r=o[s];v&&(g=(f-v[e])/3,o[`cp1${e}`]=f-g,o[`cp1${s}`]=r-g*t[h]),n&&(g=(n[e]-f)/3,o[`cp2${e}`]=f+g,o[`cp2${s}`]=r+g*t[h])}}function fl(i,t="x"){const e=Xr(t),s=i.length,u=Array(s).fill(0),g=Array(s);let v,o,n,h=We(i,0);for(v=0;v<s;++v)if(o=n,n=h,h=We(i,v+1),!!n){if(h){const f=h[t]-n[t];u[v]=f!==0?(h[e]-n[e])/f:0}g[v]=o?h?ne(u[v-1])!==ne(u[v])?0:(u[v-1]+u[v])/2:u[v-1]:u[v]}cl(i,u,g),ul(i,g,t)}function xi(i,t,e){return Math.max(Math.min(i,e),t)}function dl(i,t){let e,s,u,g,v,o=he(i[0],t);for(e=0,s=i.length;e<s;++e)v=g,g=o,o=e<s-1&&he(i[e+1],t),g&&(u=i[e],v&&(u.cp1x=xi(u.cp1x,t.left,t.right),u.cp1y=xi(u.cp1y,t.top,t.bottom)),o&&(u.cp2x=xi(u.cp2x,t.left,t.right),u.cp2y=xi(u.cp2y,t.top,t.bottom)))}function gl(i,t,e,s,u){let g,v,o,n;if(t.spanGaps&&(i=i.filter(h=>!h.skip)),t.cubicInterpolationMode==="monotone")fl(i,u);else{let h=s?i[i.length-1]:i[0];for(g=0,v=i.length;g<v;++g)o=i[g],n=hl(h,o,i[Math.min(g+1,v-(s?0:1))%v],t.tension),o.cp1x=n.previous.x,o.cp1y=n.previous.y,o.cp2x=n.next.x,o.cp2y=n.next.y,h=o}t.capBezierPoints&&dl(i,e)}function Hr(){return typeof window<"u"&&typeof document<"u"}function Gn(i){let t=i.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Ji(i,t,e){let s;return typeof i=="string"?(s=parseInt(i,10),i.indexOf("%")!==-1&&(s=s/100*t.parentNode[e])):s=i,s}const sn=i=>i.ownerDocument.defaultView.getComputedStyle(i,null);function pl(i,t){return sn(i).getPropertyValue(t)}const ml=["top","right","bottom","left"];function Pe(i,t,e){const s={};e=e?"-"+e:"";for(let u=0;u<4;u++){const g=ml[u];s[g]=parseFloat(i[t+"-"+g+e])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const vl=(i,t,e)=>(i>0||t>0)&&(!e||!e.shadowRoot);function _l(i,t){const e=i.touches,s=e&&e.length?e[0]:i,{offsetX:u,offsetY:g}=s;let v=!1,o,n;if(vl(u,g,i.target))o=u,n=g;else{const h=t.getBoundingClientRect();o=s.clientX-h.left,n=s.clientY-h.top,v=!0}return{x:o,y:n,box:v}}function we(i,t){if("native"in i)return i;const{canvas:e,currentDevicePixelRatio:s}=t,u=sn(e),g=u.boxSizing==="border-box",v=Pe(u,"padding"),o=Pe(u,"border","width"),{x:n,y:h,box:f}=_l(i,e),r=v.left+(f&&o.left),l=v.top+(f&&o.top);let{width:a,height:d}=t;return g&&(a-=v.width+o.width,d-=v.height+o.height),{x:Math.round((n-r)/a*e.width/s),y:Math.round((h-l)/d*e.height/s)}}function bl(i,t,e){let s,u;if(t===void 0||e===void 0){const g=Gn(i);if(!g)t=i.clientWidth,e=i.clientHeight;else{const v=g.getBoundingClientRect(),o=sn(g),n=Pe(o,"border","width"),h=Pe(o,"padding");t=v.width-h.width-n.width,e=v.height-h.height-n.height,s=Ji(o.maxWidth,g,"clientWidth"),u=Ji(o.maxHeight,g,"clientHeight")}}return{width:t,height:e,maxWidth:s||Gi,maxHeight:u||Gi}}const Ci=i=>Math.round(i*10)/10;function yl(i,t,e,s){const u=sn(i),g=Pe(u,"margin"),v=Ji(u.maxWidth,i,"clientWidth")||Gi,o=Ji(u.maxHeight,i,"clientHeight")||Gi,n=bl(i,t,e);let{width:h,height:f}=n;if(u.boxSizing==="content-box"){const l=Pe(u,"border","width"),a=Pe(u,"padding");h-=a.width+l.width,f-=a.height+l.height}return h=Math.max(0,h-g.width),f=Math.max(0,s?h/s:f-g.height),h=Ci(Math.min(h,v,n.maxWidth)),f=Ci(Math.min(f,o,n.maxHeight)),h&&!f&&(f=Ci(h/2)),(t!==void 0||e!==void 0)&&s&&n.height&&f>n.height&&(f=n.height,h=Ci(Math.floor(f*s))),{width:h,height:f}}function vs(i,t,e){const s=t||1,u=Math.floor(i.height*s),g=Math.floor(i.width*s);i.height=Math.floor(i.height),i.width=Math.floor(i.width);const v=i.canvas;return v.style&&(e||!v.style.height&&!v.style.width)&&(v.style.height=`${i.height}px`,v.style.width=`${i.width}px`),i.currentDevicePixelRatio!==s||v.height!==u||v.width!==g?(i.currentDevicePixelRatio=s,v.height=u,v.width=g,i.ctx.setTransform(s,0,0,s,0,0),!0):!1}const xl=function(){let i=!1;try{const t={get passive(){return i=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}return i}();function _s(i,t){const e=pl(i,t),s=e&&e.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Te(i,t,e,s){return{x:i.x+e*(t.x-i.x),y:i.y+e*(t.y-i.y)}}function Cl(i,t,e,s){return{x:i.x+e*(t.x-i.x),y:s==="middle"?e<.5?i.y:t.y:s==="after"?e<1?i.y:t.y:e>0?t.y:i.y}}function Sl(i,t,e,s){const u={x:i.cp2x,y:i.cp2y},g={x:t.cp1x,y:t.cp1y},v=Te(i,u,e),o=Te(u,g,e),n=Te(g,t,e),h=Te(v,o,e),f=Te(o,n,e);return Te(h,f,e)}const wl=function(i,t){return{x(e){return i+i+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,s){return e-s},leftForLtr(e,s){return e-s}}},Tl=function(){return{x(i){return i},setWidth(i){},textAlign(i){return i},xPlus(i,t){return i+t},leftForLtr(i,t){return i}}};function cn(i,t,e){return i?wl(t,e):Tl()}function Ol(i,t){let e,s;(t==="ltr"||t==="rtl")&&(e=i.canvas.style,s=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),i.prevTextDirection=s)}function kl(i,t){t!==void 0&&(delete i.prevTextDirection,i.canvas.style.setProperty("direction",t[0],t[1]))}function Ur(i){return i==="angle"?{between:$i,compare:Sa,normalize:Kt}:{between:wn,compare:(t,e)=>t-e,normalize:t=>t}}function bs({start:i,end:t,count:e,loop:s,style:u}){return{start:i%e,end:t%e,loop:s&&(t-i+1)%e===0,style:u}}function Pl(i,t,e){const{property:s,start:u,end:g}=e,{between:v,normalize:o}=Ur(s),n=t.length;let{start:h,end:f,loop:r}=i,l,a;if(r){for(h+=n,f+=n,l=0,a=n;l<a&&v(o(t[h%n][s]),u,g);++l)h--,f--;h%=n,f%=n}return f<h&&(f+=n),{start:h,end:f,loop:r,style:i.style}}function Ml(i,t,e){if(!e)return[i];const{property:s,start:u,end:g}=e,v=t.length,{compare:o,between:n,normalize:h}=Ur(s),{start:f,end:r,loop:l,style:a}=Pl(i,t,e),d=[];let p=!1,c=null,m,_,b;const y=()=>n(u,b,m)&&o(u,b)!==0,x=()=>o(g,m)===0||n(g,b,m),C=()=>p||y(),T=()=>!p||x();for(let k=f,E=f;k<=r;++k)_=t[k%v],!_.skip&&(m=h(_[s]),m!==b&&(p=n(m,u,g),c===null&&C()&&(c=o(m,u)===0?k:E),c!==null&&T()&&(d.push(bs({start:c,end:k,loop:l,count:v,style:a})),c=null),E=k,b=m));return c!==null&&d.push(bs({start:c,end:r,loop:l,count:v,style:a})),d}function Dl(i,t){const e=[],s=i.segments;for(let u=0;u<s.length;u++){const g=Ml(s[u],i.points,t);g.length&&e.push(...g)}return e}function Al(i,t,e,s){let u=0,g=t-1;if(e&&!s)for(;u<t&&!i[u].skip;)u++;for(;u<t&&i[u].skip;)u++;for(u%=t,e&&(g+=u);g>u&&i[g%t].skip;)g--;return g%=t,{start:u,end:g}}function El(i,t,e,s){const u=i.length,g=[];let v=t,o=i[t],n;for(n=t+1;n<=e;++n){const h=i[n%u];h.skip||h.stop?o.skip||(s=!1,g.push({start:t%u,end:(n-1)%u,loop:s}),t=v=h.stop?n:null):(v=n,o.skip&&(t=n)),o=h}return v!==null&&g.push({start:t%u,end:v%u,loop:s}),g}function Fl(i,t){const e=i.points,s=i.options.spanGaps,u=e.length;if(!u)return[];const g=!!i._loop,{start:v,end:o}=Al(e,u,g,s);if(s===!0)return ys(i,[{start:v,end:o,loop:g}],e,t);const n=o<v?o+u:o,h=!!i._fullLoop&&v===0&&o===u-1;return ys(i,El(e,v,n,h),e,t)}function ys(i,t,e,s){return!s||!s.setContext||!e?t:Ll(i,t,e,s)}function Ll(i,t,e,s){const u=i._chart.getContext(),g=xs(i.options),{_datasetIndex:v,options:{spanGaps:o}}=i,n=e.length,h=[];let f=g,r=t[0].start,l=r;function a(d,p,c,m){const _=o?-1:1;if(d!==p){for(d+=n;e[d%n].skip;)d-=_;for(;e[p%n].skip;)p+=_;d%n!==p%n&&(h.push({start:d%n,end:p%n,loop:c,style:m}),f=m,r=p%n)}}for(const d of t){r=o?r:d.start;let p=e[r%n],c;for(l=r+1;l<=d.end;l++){const m=e[l%n];c=xs(s.setContext(_e(u,{type:"segment",p0:p,p1:m,p0DataIndex:(l-1)%n,p1DataIndex:l%n,datasetIndex:v}))),Rl(c,f)&&a(r,l-1,d.loop,f),p=m,f=c}r<l-1&&a(r,l-1,d.loop,f)}return h}function xs(i){return{backgroundColor:i.backgroundColor,borderCapStyle:i.borderCapStyle,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderJoinStyle:i.borderJoinStyle,borderWidth:i.borderWidth,borderColor:i.borderColor}}function Rl(i,t){if(!t)return!1;const e=[],s=function(u,g){return Yn(g)?(e.includes(g)||e.push(g),e.indexOf(g)):g};return JSON.stringify(i,s)!==JSON.stringify(t,s)}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class Il{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,s,u){const g=e.listeners[u],v=e.duration;g.forEach(o=>o({chart:t,initial:e.initial,numSteps:v,currentStep:Math.min(s-e.start,v)}))}_refresh(){this._request||(this._running=!0,this._request=Er.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((s,u)=>{if(!s.running||!s.items.length)return;const g=s.items;let v=g.length-1,o=!1,n;for(;v>=0;--v)n=g[v],n._active?(n._total>s.duration&&(s.duration=n._total),n.tick(t),o=!0):(g[v]=g[g.length-1],g.pop());o&&(u.draw(),this._notify(u,s,t,"progress")),g.length||(s.running=!1,this._notify(u,s,t,"complete"),s.initial=!1),e+=g.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let s=e.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,s)),s}listen(t,e,s){this._getAnims(t).listeners[e].push(s)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((s,u)=>Math.max(s,u._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const s=e.items;let u=s.length-1;for(;u>=0;--u)s[u].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var oe=new Il;const Cs="transparent",Bl={boolean(i,t,e){return e>.5?t:i},color(i,t,e){const s=fs(i||Cs),u=s.valid&&fs(t||Cs);return u&&u.valid?u.mix(s,e).hexString():t},number(i,t,e){return i+(t-i)*e}};class jl{constructor(t,e,s,u){const g=e[s];u=yi([t.to,u,g,t.from]);const v=yi([t.from,g,u]);this._active=!0,this._fn=t.fn||Bl[t.type||typeof v],this._easing=ni[t.easing]||ni.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=s,this._from=v,this._to=u,this._promises=void 0}active(){return this._active}update(t,e,s){if(this._active){this._notify(!1);const u=this._target[this._prop],g=s-this._start,v=this._duration-g;this._start=s,this._duration=Math.floor(Math.max(v,t.duration)),this._total+=g,this._loop=!!t.loop,this._to=yi([t.to,e,u,t.from]),this._from=yi([t.from,u,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,s=this._duration,u=this._prop,g=this._from,v=this._loop,o=this._to;let n;if(this._active=g!==o&&(v||e<s),!this._active){this._target[u]=o,this._notify(!0);return}if(e<0){this._target[u]=g;return}n=e/s%2,n=v&&n>1?2-n:n,n=this._easing(Math.min(1,Math.max(0,n))),this._target[u]=this._fn(g,o,n)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,s)=>{t.push({res:e,rej:s})})}_notify(t){const e=t?"res":"rej",s=this._promises||[];for(let u=0;u<s.length;u++)s[u][e]()}}class Gr{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!gt(t))return;const e=Object.keys(Tt.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(u=>{const g=t[u];if(!gt(g))return;const v={};for(const o of e)v[o]=g[o];(Ct(g.properties)&&g.properties||[u]).forEach(o=>{(o===u||!s.has(o))&&s.set(o,v)})})}_animateOptions(t,e){const s=e.options,u=Wl(t,s);if(!u)return[];const g=this._createAnimations(u,s);return s.$shared&&zl(t.options.$animations,s).then(()=>{t.options=s},()=>{}),g}_createAnimations(t,e){const s=this._properties,u=[],g=t.$animations||(t.$animations={}),v=Object.keys(e),o=Date.now();let n;for(n=v.length-1;n>=0;--n){const h=v[n];if(h.charAt(0)==="$")continue;if(h==="options"){u.push(...this._animateOptions(t,e));continue}const f=e[h];let r=g[h];const l=s.get(h);if(r)if(l&&r.active()){r.update(l,f,o);continue}else r.cancel();if(!l||!l.duration){t[h]=f;continue}g[h]=r=new jl(l,t,h,f),u.push(r)}return u}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const s=this._createAnimations(t,e);if(s.length)return oe.add(this._chart,s),!0}}function zl(i,t){const e=[],s=Object.keys(t);for(let u=0;u<s.length;u++){const g=i[s[u]];g&&g.active()&&e.push(g.wait())}return Promise.all(e)}function Wl(i,t){if(!t)return;let e=i.options;if(!e){i.options=t;return}return e.$shared&&(i.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function Ss(i,t){const e=i&&i.options||{},s=e.reverse,u=e.min===void 0?t:0,g=e.max===void 0?t:0;return{start:s?g:u,end:s?u:g}}function Nl(i,t,e){if(e===!1)return!1;const s=Ss(i,e),u=Ss(t,e);return{top:u.end,right:s.end,bottom:u.start,left:s.start}}function Vl(i){let t,e,s,u;return gt(i)?(t=i.top,e=i.right,s=i.bottom,u=i.left):t=e=s=u=i,{top:t,right:e,bottom:s,left:u,disabled:i===!1}}function $r(i,t){const e=[],s=i._getSortedDatasetMetas(t);let u,g;for(u=0,g=s.length;u<g;++u)e.push(s[u].index);return e}function ws(i,t,e,s={}){const u=i.keys,g=s.mode==="single";let v,o,n,h;if(t!==null){for(v=0,o=u.length;v<o;++v){if(n=+u[v],n===e){if(s.all)continue;break}h=i.values[n],kt(h)&&(g||t===0||ne(t)===ne(h))&&(t+=h)}return t}}function Yl(i){const t=Object.keys(i),e=new Array(t.length);let s,u,g;for(s=0,u=t.length;s<u;++s)g=t[s],e[s]={x:g,y:i[g]};return e}function Ts(i,t){const e=i&&i.options.stacked;return e||e===void 0&&t.stack!==void 0}function Xl(i,t,e){return`${i.id}.${t.id}.${e.stack||e.type}`}function Hl(i){const{min:t,max:e,minDefined:s,maxDefined:u}=i.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:u?e:Number.POSITIVE_INFINITY}}function Ul(i,t,e){const s=i[t]||(i[t]={});return s[e]||(s[e]={})}function Os(i,t,e,s){for(const u of t.getMatchingVisibleMetas(s).reverse()){const g=i[u.index];if(e&&g>0||!e&&g<0)return u.index}return null}function ks(i,t){const{chart:e,_cachedMeta:s}=i,u=e._stacks||(e._stacks={}),{iScale:g,vScale:v,index:o}=s,n=g.axis,h=v.axis,f=Xl(g,v,s),r=t.length;let l;for(let a=0;a<r;++a){const d=t[a],{[n]:p,[h]:c}=d,m=d._stacks||(d._stacks={});l=m[h]=Ul(u,f,p),l[o]=c,l._top=Os(l,v,!0,s.type),l._bottom=Os(l,v,!1,s.type);const _=l._visualValues||(l._visualValues={});_[o]=c}}function un(i,t){const e=i.scales;return Object.keys(e).filter(s=>e[s].axis===t).shift()}function Gl(i,t){return _e(i,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function $l(i,t,e){return _e(i,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function Ye(i,t){const e=i.controller.index,s=i.vScale&&i.vScale.axis;if(s){t=t||i._parsed;for(const u of t){const g=u._stacks;if(!g||g[s]===void 0||g[s][e]===void 0)return;delete g[s][e],g[s]._visualValues!==void 0&&g[s]._visualValues[e]!==void 0&&delete g[s]._visualValues[e]}}}const fn=i=>i==="reset"||i==="none",Ps=(i,t)=>t?i:Object.assign({},i),ql=(i,t,e)=>i&&!t.hidden&&t._stacked&&{keys:$r(e,!0),values:null};class pe{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Ts(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Ye(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,s=this.getDataset(),u=(r,l,a,d)=>r==="x"?l:r==="r"?d:a,g=e.xAxisID=pt(s.xAxisID,un(t,"x")),v=e.yAxisID=pt(s.yAxisID,un(t,"y")),o=e.rAxisID=pt(s.rAxisID,un(t,"r")),n=e.indexAxis,h=e.iAxisID=u(n,g,v,o),f=e.vAxisID=u(n,v,g,o);e.xScale=this.getScaleForId(g),e.yScale=this.getScaleForId(v),e.rScale=this.getScaleForId(o),e.iScale=this.getScaleForId(h),e.vScale=this.getScaleForId(f)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&hs(this._data,this),t._stacked&&Ye(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),s=this._data;if(gt(e))this._data=Yl(e);else if(s!==e){if(s){hs(s,this);const u=this._cachedMeta;Ye(u),u._parsed=[]}e&&Object.isExtensible(e)&&ka(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,s=this.getDataset();let u=!1;this._dataCheck();const g=e._stacked;e._stacked=Ts(e.vScale,e),e.stack!==s.stack&&(u=!0,Ye(e),e.stack=s.stack),this._resyncElements(t),(u||g!==e._stacked)&&ks(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:s,_data:u}=this,{iScale:g,_stacked:v}=s,o=g.axis;let n=t===0&&e===u.length?!0:s._sorted,h=t>0&&s._parsed[t-1],f,r,l;if(this._parsing===!1)s._parsed=u,s._sorted=!0,l=u;else{Ct(u[t])?l=this.parseArrayData(s,u,t,e):gt(u[t])?l=this.parseObjectData(s,u,t,e):l=this.parsePrimitiveData(s,u,t,e);const a=()=>r[o]===null||h&&r[o]<h[o];for(f=0;f<e;++f)s._parsed[f+t]=r=l[f],n&&(a()&&(n=!1),h=r);s._sorted=n}v&&ks(this,l)}parsePrimitiveData(t,e,s,u){const{iScale:g,vScale:v}=t,o=g.axis,n=v.axis,h=g.getLabels(),f=g===v,r=new Array(u);let l,a,d;for(l=0,a=u;l<a;++l)d=l+s,r[l]={[o]:f||g.parse(h[d],d),[n]:v.parse(e[d],d)};return r}parseArrayData(t,e,s,u){const{xScale:g,yScale:v}=t,o=new Array(u);let n,h,f,r;for(n=0,h=u;n<h;++n)f=n+s,r=e[f],o[n]={x:g.parse(r[0],f),y:v.parse(r[1],f)};return o}parseObjectData(t,e,s,u){const{xScale:g,yScale:v}=t,{xAxisKey:o="x",yAxisKey:n="y"}=this._parsing,h=new Array(u);let f,r,l,a;for(f=0,r=u;f<r;++f)l=f+s,a=e[l],h[f]={x:g.parse(me(a,o),l),y:v.parse(me(a,n),l)};return h}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,s){const u=this.chart,g=this._cachedMeta,v=e[t.axis],o={keys:$r(u,!0),values:e._stacks[t.axis]._visualValues};return ws(o,v,g.index,{mode:s})}updateRangeFromParsed(t,e,s,u){const g=s[e.axis];let v=g===null?NaN:g;const o=u&&s._stacks[e.axis];u&&o&&(u.values=o,v=ws(u,g,this._cachedMeta.index)),t.min=Math.min(t.min,v),t.max=Math.max(t.max,v)}getMinMax(t,e){const s=this._cachedMeta,u=s._parsed,g=s._sorted&&t===s.iScale,v=u.length,o=this._getOtherScale(t),n=ql(e,s,this.chart),h={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:f,max:r}=Hl(o);let l,a;function d(){a=u[l];const p=a[o.axis];return!kt(a[t.axis])||f>p||r<p}for(l=0;l<v&&!(!d()&&(this.updateRangeFromParsed(h,t,a,n),g));++l);if(g){for(l=v-1;l>=0;--l)if(!d()){this.updateRangeFromParsed(h,t,a,n);break}}return h}getAllParsedValues(t){const e=this._cachedMeta._parsed,s=[];let u,g,v;for(u=0,g=e.length;u<g;++u)v=e[u][t.axis],kt(v)&&s.push(v);return s}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,s=e.iScale,u=e.vScale,g=this.getParsed(t);return{label:s?""+s.getLabelForValue(g[s.axis]):"",value:u?""+u.getLabelForValue(g[u.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=Vl(pt(this.options.clip,Nl(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,s=this._cachedMeta,u=s.data||[],g=e.chartArea,v=[],o=this._drawStart||0,n=this._drawCount||u.length-o,h=this.options.drawActiveElementsOnTop;let f;for(s.dataset&&s.dataset.draw(t,g,o,n),f=o;f<o+n;++f){const r=u[f];r.hidden||(r.active&&h?v.push(r):r.draw(t,g))}for(f=0;f<v.length;++f)v[f].draw(t,g)}getStyle(t,e){const s=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,e,s){const u=this.getDataset();let g;if(t>=0&&t<this._cachedMeta.data.length){const v=this._cachedMeta.data[t];g=v.$context||(v.$context=$l(this.getContext(),t,v)),g.parsed=this.getParsed(t),g.raw=u.data[t],g.index=g.dataIndex=t}else g=this.$context||(this.$context=Gl(this.chart.getContext(),this.index)),g.dataset=u,g.index=g.datasetIndex=this.index;return g.active=!!e,g.mode=s,g}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",s){const u=e==="active",g=this._cachedDataOpts,v=t+"-"+e,o=g[v],n=this.enableOptionSharing&&li(s);if(o)return Ps(o,n);const h=this.chart.config,f=h.datasetElementScopeKeys(this._type,t),r=u?[`${t}Hover`,"hover",t,""]:[t,""],l=h.getOptionScopes(this.getDataset(),f),a=Object.keys(Tt.elements[t]),d=()=>this.getContext(s,u,e),p=h.resolveNamedOptions(l,a,d,r);return p.$shared&&(p.$shared=n,g[v]=Object.freeze(Ps(p,n))),p}_resolveAnimations(t,e,s){const u=this.chart,g=this._cachedDataOpts,v=`animation-${e}`,o=g[v];if(o)return o;let n;if(u.options.animation!==!1){const f=this.chart.config,r=f.datasetAnimationScopeKeys(this._type,e),l=f.getOptionScopes(this.getDataset(),r);n=f.createResolver(l,this.getContext(t,s,e))}const h=new Gr(u,n&&n.animations);return n&&n._cacheable&&(g[v]=Object.freeze(h)),h}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||fn(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const s=this.resolveDataElementOptions(t,e),u=this._sharedOptions,g=this.getSharedOptions(s),v=this.includeOptions(e,g)||g!==u;return this.updateSharedOptions(g,e,s),{sharedOptions:g,includeOptions:v}}updateElement(t,e,s,u){fn(u)?Object.assign(t,s):this._resolveAnimations(e,u).update(t,s)}updateSharedOptions(t,e,s){t&&!fn(e)&&this._resolveAnimations(void 0,e).update(t,s)}_setStyle(t,e,s,u){t.active=u;const g=this.getStyle(e,u);this._resolveAnimations(e,s,u).update(t,{options:!u&&this.getSharedOptions(g)||g})}removeHoverStyle(t,e,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,e,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,s=this._cachedMeta.data;for(const[o,n,h]of this._syncList)this[o](n,h);this._syncList=[];const u=s.length,g=e.length,v=Math.min(g,u);v&&this.parse(0,v),g>u?this._insertElements(u,g-u,t):g<u&&this._removeElements(g,u-g)}_insertElements(t,e,s=!0){const u=this._cachedMeta,g=u.data,v=t+e;let o;const n=h=>{for(h.length+=e,o=h.length-1;o>=v;o--)h[o]=h[o-e]};for(n(g),o=t;o<v;++o)g[o]=new this.dataElementType;this._parsing&&n(u._parsed),this.parse(t,e),s&&this.updateElements(g,t,e,"reset")}updateElements(t,e,s,u){}_removeElements(t,e){const s=this._cachedMeta;if(this._parsing){const u=s._parsed.splice(t,e);s._stacked&&Ye(s,u)}s.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,s,u]=t;this[e](s,u)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}nt(pe,"defaults",{}),nt(pe,"datasetElementType",null),nt(pe,"dataElementType",null);function Kl(i,t){if(!i._cache.$bar){const e=i.getMatchingVisibleMetas(t);let s=[];for(let u=0,g=e.length;u<g;u++)s=s.concat(e[u].controller.getAllParsedValues(i));i._cache.$bar=Ar(s.sort((u,g)=>u-g))}return i._cache.$bar}function Jl(i){const t=i.iScale,e=Kl(t,i.type);let s=t._length,u,g,v,o;const n=()=>{v===32767||v===-32768||(li(o)&&(s=Math.min(s,Math.abs(v-o)||s)),o=v)};for(u=0,g=e.length;u<g;++u)v=t.getPixelForValue(e[u]),n();for(o=void 0,u=0,g=t.ticks.length;u<g;++u)v=t.getPixelForTick(u),n();return s}function Ql(i,t,e,s){const u=e.barThickness;let g,v;return _t(u)?(g=t.min*e.categoryPercentage,v=e.barPercentage):(g=u*s,v=1),{chunk:g/s,ratio:v,start:t.pixels[i]-g/2}}function Zl(i,t,e,s){const u=t.pixels,g=u[i];let v=i>0?u[i-1]:null,o=i<u.length-1?u[i+1]:null;const n=e.categoryPercentage;v===null&&(v=g-(o===null?t.end-t.start:o-g)),o===null&&(o=g+g-v);const h=g-(g-Math.min(v,o))/2*n;return{chunk:Math.abs(o-v)/2*n/s,ratio:e.barPercentage,start:h}}function th(i,t,e,s){const u=e.parse(i[0],s),g=e.parse(i[1],s),v=Math.min(u,g),o=Math.max(u,g);let n=v,h=o;Math.abs(v)>Math.abs(o)&&(n=o,h=v),t[e.axis]=h,t._custom={barStart:n,barEnd:h,start:u,end:g,min:v,max:o}}function qr(i,t,e,s){return Ct(i)?th(i,t,e,s):t[e.axis]=e.parse(i,s),t}function Ms(i,t,e,s){const u=i.iScale,g=i.vScale,v=u.getLabels(),o=u===g,n=[];let h,f,r,l;for(h=e,f=e+s;h<f;++h)l=t[h],r={},r[u.axis]=o||u.parse(v[h],h),n.push(qr(l,r,g,h));return n}function dn(i){return i&&i.barStart!==void 0&&i.barEnd!==void 0}function eh(i,t,e){return i!==0?ne(i):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function ih(i){let t,e,s,u,g;return i.horizontal?(t=i.base>i.x,e="left",s="right"):(t=i.base<i.y,e="bottom",s="top"),t?(u="end",g="start"):(u="start",g="end"),{start:e,end:s,reverse:t,top:u,bottom:g}}function nh(i,t,e,s){let u=t.borderSkipped;const g={};if(!u){i.borderSkipped=g;return}if(u===!0){i.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:v,end:o,reverse:n,top:h,bottom:f}=ih(i);u==="middle"&&e&&(i.enableBorderRadius=!0,(e._top||0)===s?u=h:(e._bottom||0)===s?u=f:(g[Ds(f,v,o,n)]=!0,u=h)),g[Ds(u,v,o,n)]=!0,i.borderSkipped=g}function Ds(i,t,e,s){return s?(i=sh(i,t,e),i=As(i,e,t)):i=As(i,t,e),i}function sh(i,t,e){return i===t?e:i===e?t:i}function As(i,t,e){return i==="start"?t:i==="end"?e:i}function rh(i,{inflateAmount:t},e){i.inflateAmount=t==="auto"?e===1?.33:0:t}class Li extends pe{parsePrimitiveData(t,e,s,u){return Ms(t,e,s,u)}parseArrayData(t,e,s,u){return Ms(t,e,s,u)}parseObjectData(t,e,s,u){const{iScale:g,vScale:v}=t,{xAxisKey:o="x",yAxisKey:n="y"}=this._parsing,h=g.axis==="x"?o:n,f=v.axis==="x"?o:n,r=[];let l,a,d,p;for(l=s,a=s+u;l<a;++l)p=e[l],d={},d[g.axis]=g.parse(me(p,h),l),r.push(qr(me(p,f),d,v,l));return r}updateRangeFromParsed(t,e,s,u){super.updateRangeFromParsed(t,e,s,u);const g=s._custom;g&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,g.min),t.max=Math.max(t.max,g.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:s,vScale:u}=e,g=this.getParsed(t),v=g._custom,o=dn(v)?"["+v.start+", "+v.end+"]":""+u.getLabelForValue(g[u.axis]);return{label:""+s.getLabelForValue(g[s.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,s,u){const g=u==="reset",{index:v,_cachedMeta:{vScale:o}}=this,n=o.getBasePixel(),h=o.isHorizontal(),f=this._getRuler(),{sharedOptions:r,includeOptions:l}=this._getSharedOptions(e,u);for(let a=e;a<e+s;a++){const d=this.getParsed(a),p=g||_t(d[o.axis])?{base:n,head:n}:this._calculateBarValuePixels(a),c=this._calculateBarIndexPixels(a,f),m=(d._stacks||{})[o.axis],_={horizontal:h,base:p.base,enableBorderRadius:!m||dn(d._custom)||v===m._top||v===m._bottom,x:h?p.head:c.center,y:h?c.center:p.head,height:h?c.size:Math.abs(p.size),width:h?Math.abs(p.size):c.size};l&&(_.options=r||this.resolveDataElementOptions(a,t[a].active?"active":u));const b=_.options||t[a].options;nh(_,b,m,v),rh(_,b,f.ratio),this.updateElement(t[a],a,_,u)}}_getStacks(t,e){const{iScale:s}=this._cachedMeta,u=s.getMatchingVisibleMetas(this._type).filter(n=>n.controller.options.grouped),g=s.options.stacked,v=[],o=n=>{const h=n.controller.getParsed(e),f=h&&h[n.vScale.axis];if(_t(f)||isNaN(f))return!0};for(const n of u)if(!(e!==void 0&&o(n))&&((g===!1||v.indexOf(n.stack)===-1||g===void 0&&n.stack===void 0)&&v.push(n.stack),n.index===t))break;return v.length||v.push(void 0),v}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,s){const u=this._getStacks(t,s),g=e!==void 0?u.indexOf(e):-1;return g===-1?u.length-1:g}_getRuler(){const t=this.options,e=this._cachedMeta,s=e.iScale,u=[];let g,v;for(g=0,v=e.data.length;g<v;++g)u.push(s.getPixelForValue(this.getParsed(g)[s.axis],g));const o=t.barThickness;return{min:o||Jl(e),pixels:u,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:s,index:u},options:{base:g,minBarLength:v}}=this,o=g||0,n=this.getParsed(t),h=n._custom,f=dn(h);let r=n[e.axis],l=0,a=s?this.applyStack(e,n,s):r,d,p;a!==r&&(l=a-r,a=r),f&&(r=h.barStart,a=h.barEnd-h.barStart,r!==0&&ne(r)!==ne(h.barEnd)&&(l=0),l+=r);const c=!_t(g)&&!f?g:l;let m=e.getPixelForValue(c);if(this.chart.getDataVisibility(t)?d=e.getPixelForValue(l+a):d=m,p=d-m,Math.abs(p)<v){p=eh(p,e,o)*v,r===o&&(m-=p/2);const _=e.getPixelForDecimal(0),b=e.getPixelForDecimal(1),y=Math.min(_,b),x=Math.max(_,b);m=Math.max(Math.min(m,x),y),d=m+p,s&&!f&&(n._stacks[e.axis]._visualValues[u]=e.getValueForPixel(d)-e.getValueForPixel(m))}if(m===e.getPixelForValue(o)){const _=ne(p)*e.getLineWidthForValue(o)/2;m+=_,p-=_}return{size:p,base:m,head:d,center:d+p/2}}_calculateBarIndexPixels(t,e){const s=e.scale,u=this.options,g=u.skipNull,v=pt(u.maxBarThickness,1/0);let o,n;if(e.grouped){const h=g?this._getStackCount(t):e.stackCount,f=u.barThickness==="flex"?Zl(t,e,u,h):Ql(t,e,u,h),r=this._getStackIndex(this.index,this._cachedMeta.stack,g?t:void 0);o=f.start+f.chunk*r+f.chunk/2,n=Math.min(v,f.chunk*f.ratio)}else o=s.getPixelForValue(this.getParsed(t)[s.axis],t),n=Math.min(v,e.min*e.ratio);return{base:o-n/2,head:o+n/2,center:o,size:n}}draw(){const t=this._cachedMeta,e=t.vScale,s=t.data,u=s.length;let g=0;for(;g<u;++g)this.getParsed(g)[e.axis]!==null&&s[g].draw(this._ctx)}}nt(Li,"id","bar"),nt(Li,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),nt(Li,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function oh(i,t,e){let s=1,u=1,g=0,v=0;if(t<Pt){const o=i,n=o+t,h=Math.cos(o),f=Math.sin(o),r=Math.cos(n),l=Math.sin(n),a=(b,y,x)=>$i(b,o,n,!0)?1:Math.max(y,y*e,x,x*e),d=(b,y,x)=>$i(b,o,n,!0)?-1:Math.min(y,y*e,x,x*e),p=a(0,h,r),c=a(At,f,l),m=d(St,h,r),_=d(St+At,f,l);s=(p-m)/2,u=(c-_)/2,g=-(p+m)/2,v=-(c+_)/2}return{ratioX:s,ratioY:u,offsetX:g,offsetY:v}}class qe extends pe{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const s=this.getDataset().data,u=this._cachedMeta;if(this._parsing===!1)u._parsed=s;else{let g=n=>+s[n];if(gt(s[t])){const{key:n="value"}=this._parsing;g=h=>+me(s[h],n)}let v,o;for(v=t,o=t+e;v<o;++v)u._parsed[v]=g(v)}}_getRotation(){return Qt(this.options.rotation-90)}_getCircumference(){return Qt(this.options.circumference)}_getRotationExtents(){let t=Pt,e=-Pt;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const u=this.chart.getDatasetMeta(s).controller,g=u._getRotation(),v=u._getCircumference();t=Math.min(t,g),e=Math.max(e,g+v)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:s}=e,u=this._cachedMeta,g=u.data,v=this.getMaxBorderWidth()+this.getMaxOffset(g)+this.options.spacing,o=Math.max((Math.min(s.width,s.height)-v)/2,0),n=Math.min(fa(this.options.cutout,o),1),h=this._getRingWeight(this.index),{circumference:f,rotation:r}=this._getRotationExtents(),{ratioX:l,ratioY:a,offsetX:d,offsetY:p}=oh(r,f,n),c=(s.width-v)/l,m=(s.height-v)/a,_=Math.max(Math.min(c,m)/2,0),b=kr(this.options.radius,_),y=Math.max(b*n,0),x=(b-y)/this._getVisibleDatasetWeightTotal();this.offsetX=d*b,this.offsetY=p*b,u.total=this.calculateTotal(),this.outerRadius=b-x*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-x*h,0),this.updateElements(g,0,g.length,t)}_circumference(t,e){const s=this.options,u=this._cachedMeta,g=this._getCircumference();return e&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||u._parsed[t]===null||u.data[t].hidden?0:this.calculateCircumference(u._parsed[t]*g/Pt)}updateElements(t,e,s,u){const g=u==="reset",v=this.chart,o=v.chartArea,h=v.options.animation,f=(o.left+o.right)/2,r=(o.top+o.bottom)/2,l=g&&h.animateScale,a=l?0:this.innerRadius,d=l?0:this.outerRadius,{sharedOptions:p,includeOptions:c}=this._getSharedOptions(e,u);let m=this._getRotation(),_;for(_=0;_<e;++_)m+=this._circumference(_,g);for(_=e;_<e+s;++_){const b=this._circumference(_,g),y=t[_],x={x:f+this.offsetX,y:r+this.offsetY,startAngle:m,endAngle:m+b,circumference:b,outerRadius:d,innerRadius:a};c&&(x.options=p||this.resolveDataElementOptions(_,y.active?"active":u)),m+=b,this.updateElement(y,_,x,u)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let s=0,u;for(u=0;u<e.length;u++){const g=t._parsed[u];g!==null&&!isNaN(g)&&this.chart.getDataVisibility(u)&&!e[u].hidden&&(s+=Math.abs(g))}return s}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?Pt*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,u=s.data.labels||[],g=gi(e._parsed[t],s.options.locale);return{label:u[t]||"",value:g}}getMaxBorderWidth(t){let e=0;const s=this.chart;let u,g,v,o,n;if(!t){for(u=0,g=s.data.datasets.length;u<g;++u)if(s.isDatasetVisible(u)){v=s.getDatasetMeta(u),t=v.data,o=v.controller;break}}if(!t)return 0;for(u=0,g=t.length;u<g;++u)n=o.resolveDataElementOptions(u),n.borderAlign!=="inner"&&(e=Math.max(e,n.borderWidth||0,n.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let s=0,u=t.length;s<u;++s){const g=this.resolveDataElementOptions(s);e=Math.max(e,g.offset||0,g.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(e+=this._getRingWeight(s));return e}_getRingWeight(t){return Math.max(pt(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}nt(qe,"id","doughnut"),nt(qe,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),nt(qe,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),nt(qe,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:s,color:u}}=t.legend.options;return e.labels.map((g,v)=>{const n=t.getDatasetMeta(0).controller.getStyle(v);return{text:g,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,fontColor:u,lineWidth:n.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(v),index:v}})}return[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}}});class Ri extends pe{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:s,data:u=[],_dataset:g}=e,v=this.chart._animationsDisabled;let{start:o,count:n}=Ma(e,u,v);this._drawStart=o,this._drawCount=n,Da(e)&&(o=0,n=u.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!g._decimated,s.points=u;const h=this.resolveDatasetElementOptions(t);this.options.showLine||(h.borderWidth=0),h.segment=this.options.segment,this.updateElement(s,void 0,{animated:!v,options:h},t),this.updateElements(u,o,n,t)}updateElements(t,e,s,u){const g=u==="reset",{iScale:v,vScale:o,_stacked:n,_dataset:h}=this._cachedMeta,{sharedOptions:f,includeOptions:r}=this._getSharedOptions(e,u),l=v.axis,a=o.axis,{spanGaps:d,segment:p}=this.options,c=hi(d)?d:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||g||u==="none",_=e+s,b=t.length;let y=e>0&&this.getParsed(e-1);for(let x=0;x<b;++x){const C=t[x],T=m?C:{};if(x<e||x>=_){T.skip=!0;continue}const k=this.getParsed(x),E=_t(k[a]),z=T[l]=v.getPixelForValue(k[l],x),N=T[a]=g||E?o.getBasePixel():o.getPixelForValue(n?this.applyStack(o,k,n):k[a],x);T.skip=isNaN(z)||isNaN(N)||E,T.stop=x>0&&Math.abs(k[l]-y[l])>c,p&&(T.parsed=k,T.raw=h.data[x]),r&&(T.options=f||this.resolveDataElementOptions(x,C.active?"active":u)),m||this.updateElement(C,x,T,u),y=k}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,s=e.options&&e.options.borderWidth||0,u=t.data||[];if(!u.length)return s;const g=u[0].size(this.resolveDataElementOptions(0)),v=u[u.length-1].size(this.resolveDataElementOptions(u.length-1));return Math.max(s,g,v)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}nt(Ri,"id","line"),nt(Ri,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),nt(Ri,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Ii extends pe{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,u=s.data.labels||[],g=gi(e._parsed[t].r,s.options.locale);return{label:u[t]||"",value:g}}parseObjectData(t,e,s,u){return al.bind(this)(t,e,s,u)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((s,u)=>{const g=this.getParsed(u).r;!isNaN(g)&&this.chart.getDataVisibility(u)&&(g<e.min&&(e.min=g),g>e.max&&(e.max=g))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,s=t.options,u=Math.min(e.right-e.left,e.bottom-e.top),g=Math.max(u/2,0),v=Math.max(s.cutoutPercentage?g/100*s.cutoutPercentage:1,0),o=(g-v)/t.getVisibleDatasetCount();this.outerRadius=g-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(t,e,s,u){const g=u==="reset",v=this.chart,n=v.options.animation,h=this._cachedMeta.rScale,f=h.xCenter,r=h.yCenter,l=h.getIndexAngle(0)-.5*St;let a=l,d;const p=360/this.countVisibleElements();for(d=0;d<e;++d)a+=this._computeAngle(d,u,p);for(d=e;d<e+s;d++){const c=t[d];let m=a,_=a+this._computeAngle(d,u,p),b=v.getDataVisibility(d)?h.getDistanceFromCenterForValue(this.getParsed(d).r):0;a=_,g&&(n.animateScale&&(b=0),n.animateRotate&&(m=_=l));const y={x:f,y:r,innerRadius:0,outerRadius:b,startAngle:m,endAngle:_,options:this.resolveDataElementOptions(d,c.active?"active":u)};this.updateElement(c,d,y,u)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((s,u)=>{!isNaN(this.getParsed(u).r)&&this.chart.getDataVisibility(u)&&e++}),e}_computeAngle(t,e,s){return this.chart.getDataVisibility(t)?Qt(this.resolveDataElementOptions(t,e).angle||s):0}}nt(Ii,"id","polarArea"),nt(Ii,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),nt(Ii,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:s,color:u}}=t.legend.options;return e.labels.map((g,v)=>{const n=t.getDatasetMeta(0).controller.getStyle(v);return{text:g,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,fontColor:u,lineWidth:n.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(v),index:v}})}return[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});function Ce(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class $n{constructor(t){nt(this,"options");this.options=t||{}}static override(t){Object.assign($n.prototype,t)}init(){}formats(){return Ce()}parse(){return Ce()}format(){return Ce()}add(){return Ce()}diff(){return Ce()}startOf(){return Ce()}endOf(){return Ce()}}var ah={_date:$n};function lh(i,t,e,s){const{controller:u,data:g,_sorted:v}=i,o=u._cachedMeta.iScale;if(o&&t===o.axis&&t!=="r"&&v&&g.length){const n=o._reversePixels?Ta:ke;if(s){if(u._sharedOptions){const h=g[0],f=typeof h.getRange=="function"&&h.getRange(t);if(f){const r=n(g,t,e-f),l=n(g,t,e+f);return{lo:r.lo,hi:l.hi}}}}else return n(g,t,e)}return{lo:0,hi:g.length-1}}function pi(i,t,e,s,u){const g=i.getSortedVisibleDatasetMetas(),v=e[t];for(let o=0,n=g.length;o<n;++o){const{index:h,data:f}=g[o],{lo:r,hi:l}=lh(g[o],t,v,u);for(let a=r;a<=l;++a){const d=f[a];d.skip||s(d,h,a)}}}function hh(i){const t=i.indexOf("x")!==-1,e=i.indexOf("y")!==-1;return function(s,u){const g=t?Math.abs(s.x-u.x):0,v=e?Math.abs(s.y-u.y):0;return Math.sqrt(Math.pow(g,2)+Math.pow(v,2))}}function gn(i,t,e,s,u){const g=[];return!u&&!i.isPointInArea(t)||pi(i,e,t,function(o,n,h){!u&&!he(o,i.chartArea,0)||o.inRange(t.x,t.y,s)&&g.push({element:o,datasetIndex:n,index:h})},!0),g}function ch(i,t,e,s){let u=[];function g(v,o,n){const{startAngle:h,endAngle:f}=v.getProps(["startAngle","endAngle"],s),{angle:r}=Ca(v,{x:t.x,y:t.y});$i(r,h,f)&&u.push({element:v,datasetIndex:o,index:n})}return pi(i,e,t,g),u}function uh(i,t,e,s,u,g){let v=[];const o=hh(e);let n=Number.POSITIVE_INFINITY;function h(f,r,l){const a=f.inRange(t.x,t.y,u);if(s&&!a)return;const d=f.getCenterPoint(u);if(!(!!g||i.isPointInArea(d))&&!a)return;const c=o(t,d);c<n?(v=[{element:f,datasetIndex:r,index:l}],n=c):c===n&&v.push({element:f,datasetIndex:r,index:l})}return pi(i,e,t,h),v}function pn(i,t,e,s,u,g){return!g&&!i.isPointInArea(t)?[]:e==="r"&&!s?ch(i,t,e,u):uh(i,t,e,s,u,g)}function Es(i,t,e,s,u){const g=[],v=e==="x"?"inXRange":"inYRange";let o=!1;return pi(i,e,t,(n,h,f)=>{n[v](t[e],u)&&(g.push({element:n,datasetIndex:h,index:f}),o=o||n.inRange(t.x,t.y,u))}),s&&!o?[]:g}var fh={evaluateInteractionItems:pi,modes:{index(i,t,e,s){const u=we(t,i),g=e.axis||"x",v=e.includeInvisible||!1,o=e.intersect?gn(i,u,g,s,v):pn(i,u,g,!1,s,v),n=[];return o.length?(i.getSortedVisibleDatasetMetas().forEach(h=>{const f=o[0].index,r=h.data[f];r&&!r.skip&&n.push({element:r,datasetIndex:h.index,index:f})}),n):[]},dataset(i,t,e,s){const u=we(t,i),g=e.axis||"xy",v=e.includeInvisible||!1;let o=e.intersect?gn(i,u,g,s,v):pn(i,u,g,!1,s,v);if(o.length>0){const n=o[0].datasetIndex,h=i.getDatasetMeta(n).data;o=[];for(let f=0;f<h.length;++f)o.push({element:h[f],datasetIndex:n,index:f})}return o},point(i,t,e,s){const u=we(t,i),g=e.axis||"xy",v=e.includeInvisible||!1;return gn(i,u,g,s,v)},nearest(i,t,e,s){const u=we(t,i),g=e.axis||"xy",v=e.includeInvisible||!1;return pn(i,u,g,e.intersect,s,v)},x(i,t,e,s){const u=we(t,i);return Es(i,u,"x",e.intersect,s)},y(i,t,e,s){const u=we(t,i);return Es(i,u,"y",e.intersect,s)}}};const Kr=["left","top","right","bottom"];function Xe(i,t){return i.filter(e=>e.pos===t)}function Fs(i,t){return i.filter(e=>Kr.indexOf(e.pos)===-1&&e.box.axis===t)}function He(i,t){return i.sort((e,s)=>{const u=t?s:e,g=t?e:s;return u.weight===g.weight?u.index-g.index:u.weight-g.weight})}function dh(i){const t=[];let e,s,u,g,v,o;for(e=0,s=(i||[]).length;e<s;++e)u=i[e],{position:g,options:{stack:v,stackWeight:o=1}}=u,t.push({index:e,box:u,pos:g,horizontal:u.isHorizontal(),weight:u.weight,stack:v&&g+v,stackWeight:o});return t}function gh(i){const t={};for(const e of i){const{stack:s,pos:u,stackWeight:g}=e;if(!s||!Kr.includes(u))continue;const v=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});v.count++,v.weight+=g}return t}function ph(i,t){const e=gh(i),{vBoxMaxWidth:s,hBoxMaxHeight:u}=t;let g,v,o;for(g=0,v=i.length;g<v;++g){o=i[g];const{fullSize:n}=o.box,h=e[o.stack],f=h&&o.stackWeight/h.weight;o.horizontal?(o.width=f?f*s:n&&t.availableWidth,o.height=u):(o.width=s,o.height=f?f*u:n&&t.availableHeight)}return e}function mh(i){const t=dh(i),e=He(t.filter(h=>h.box.fullSize),!0),s=He(Xe(t,"left"),!0),u=He(Xe(t,"right")),g=He(Xe(t,"top"),!0),v=He(Xe(t,"bottom")),o=Fs(t,"x"),n=Fs(t,"y");return{fullSize:e,leftAndTop:s.concat(g),rightAndBottom:u.concat(n).concat(v).concat(o),chartArea:Xe(t,"chartArea"),vertical:s.concat(u).concat(n),horizontal:g.concat(v).concat(o)}}function Ls(i,t,e,s){return Math.max(i[e],t[e])+Math.max(i[s],t[s])}function Jr(i,t){i.top=Math.max(i.top,t.top),i.left=Math.max(i.left,t.left),i.bottom=Math.max(i.bottom,t.bottom),i.right=Math.max(i.right,t.right)}function vh(i,t,e,s){const{pos:u,box:g}=e,v=i.maxPadding;if(!gt(u)){e.size&&(i[u]-=e.size);const r=s[e.stack]||{size:0,count:1};r.size=Math.max(r.size,e.horizontal?g.height:g.width),e.size=r.size/r.count,i[u]+=e.size}g.getPadding&&Jr(v,g.getPadding());const o=Math.max(0,t.outerWidth-Ls(v,i,"left","right")),n=Math.max(0,t.outerHeight-Ls(v,i,"top","bottom")),h=o!==i.w,f=n!==i.h;return i.w=o,i.h=n,e.horizontal?{same:h,other:f}:{same:f,other:h}}function _h(i){const t=i.maxPadding;function e(s){const u=Math.max(t[s]-i[s],0);return i[s]+=u,u}i.y+=e("top"),i.x+=e("left"),e("right"),e("bottom")}function bh(i,t){const e=t.maxPadding;function s(u){const g={left:0,top:0,right:0,bottom:0};return u.forEach(v=>{g[v]=Math.max(t[v],e[v])}),g}return s(i?["left","right"]:["top","bottom"])}function Ke(i,t,e,s){const u=[];let g,v,o,n,h,f;for(g=0,v=i.length,h=0;g<v;++g){o=i[g],n=o.box,n.update(o.width||t.w,o.height||t.h,bh(o.horizontal,t));const{same:r,other:l}=vh(t,e,o,s);h|=r&&u.length,f=f||l,n.fullSize||u.push(o)}return h&&Ke(u,t,e,s)||f}function Si(i,t,e,s,u){i.top=e,i.left=t,i.right=t+s,i.bottom=e+u,i.width=s,i.height=u}function Rs(i,t,e,s){const u=e.padding;let{x:g,y:v}=t;for(const o of i){const n=o.box,h=s[o.stack]||{count:1,placed:0,weight:1},f=o.stackWeight/h.weight||1;if(o.horizontal){const r=t.w*f,l=h.size||n.height;li(h.start)&&(v=h.start),n.fullSize?Si(n,u.left,v,e.outerWidth-u.right-u.left,l):Si(n,t.left+h.placed,v,r,l),h.start=v,h.placed+=r,v=n.bottom}else{const r=t.h*f,l=h.size||n.width;li(h.start)&&(g=h.start),n.fullSize?Si(n,g,u.top,l,e.outerHeight-u.bottom-u.top):Si(n,g,t.top+h.placed,l,r),h.start=g,h.placed+=r,g=n.right}}t.x=g,t.y=v}var $t={addBox(i,t){i.boxes||(i.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},i.boxes.push(t)},removeBox(i,t){const e=i.boxes?i.boxes.indexOf(t):-1;e!==-1&&i.boxes.splice(e,1)},configure(i,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(i,t,e,s){if(!i)return;const u=Yt(i.options.layout.padding),g=Math.max(t-u.width,0),v=Math.max(e-u.height,0),o=mh(i.boxes),n=o.vertical,h=o.horizontal;vt(i.boxes,p=>{typeof p.beforeLayout=="function"&&p.beforeLayout()});const f=n.reduce((p,c)=>c.box.options&&c.box.options.display===!1?p:p+1,0)||1,r=Object.freeze({outerWidth:t,outerHeight:e,padding:u,availableWidth:g,availableHeight:v,vBoxMaxWidth:g/2/f,hBoxMaxHeight:v/2}),l=Object.assign({},u);Jr(l,Yt(s));const a=Object.assign({maxPadding:l,w:g,h:v,x:u.left,y:u.top},u),d=ph(n.concat(h),r);Ke(o.fullSize,a,r,d),Ke(n,a,r,d),Ke(h,a,r,d)&&Ke(n,a,r,d),_h(a),Rs(o.leftAndTop,a,r,d),a.x+=a.w,a.y+=a.h,Rs(o.rightAndBottom,a,r,d),i.chartArea={left:a.left,top:a.top,right:a.left+a.w,bottom:a.top+a.h,height:a.h,width:a.w},vt(o.chartArea,p=>{const c=p.box;Object.assign(c,i.chartArea),c.update(a.w,a.h,{left:0,top:0,right:0,bottom:0})})}};class Qr{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,s){}removeEventListener(t,e,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,s,u){return e=Math.max(0,e||t.width),s=s||t.height,{width:e,height:Math.max(0,u?Math.floor(e/u):s)}}isAttached(t){return!0}updateConfig(t){}}class yh extends Qr{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Bi="$chartjs",xh={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Is=i=>i===null||i==="";function Ch(i,t){const e=i.style,s=i.getAttribute("height"),u=i.getAttribute("width");if(i[Bi]={initial:{height:s,width:u,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",Is(u)){const g=_s(i,"width");g!==void 0&&(i.width=g)}if(Is(s))if(i.style.height==="")i.height=i.width/(t||2);else{const g=_s(i,"height");g!==void 0&&(i.height=g)}return i}const Zr=xl?{passive:!0}:!1;function Sh(i,t,e){i.addEventListener(t,e,Zr)}function wh(i,t,e){i.canvas.removeEventListener(t,e,Zr)}function Th(i,t){const e=xh[i.type]||i.type,{x:s,y:u}=we(i,t);return{type:e,chart:t,native:i,x:s!==void 0?s:null,y:u!==void 0?u:null}}function Qi(i,t){for(const e of i)if(e===t||e.contains(t))return!0}function Oh(i,t,e){const s=i.canvas,u=new MutationObserver(g=>{let v=!1;for(const o of g)v=v||Qi(o.addedNodes,s),v=v&&!Qi(o.removedNodes,s);v&&e()});return u.observe(document,{childList:!0,subtree:!0}),u}function kh(i,t,e){const s=i.canvas,u=new MutationObserver(g=>{let v=!1;for(const o of g)v=v||Qi(o.removedNodes,s),v=v&&!Qi(o.addedNodes,s);v&&e()});return u.observe(document,{childList:!0,subtree:!0}),u}const ui=new Map;let Bs=0;function to(){const i=window.devicePixelRatio;i!==Bs&&(Bs=i,ui.forEach((t,e)=>{e.currentDevicePixelRatio!==i&&t()}))}function Ph(i,t){ui.size||window.addEventListener("resize",to),ui.set(i,t)}function Mh(i){ui.delete(i),ui.size||window.removeEventListener("resize",to)}function Dh(i,t,e){const s=i.canvas,u=s&&Gn(s);if(!u)return;const g=Fr((o,n)=>{const h=u.clientWidth;e(o,n),h<u.clientWidth&&e()},window),v=new ResizeObserver(o=>{const n=o[0],h=n.contentRect.width,f=n.contentRect.height;h===0&&f===0||g(h,f)});return v.observe(u),Ph(i,g),v}function mn(i,t,e){e&&e.disconnect(),t==="resize"&&Mh(i)}function Ah(i,t,e){const s=i.canvas,u=Fr(g=>{i.ctx!==null&&e(Th(g,i))},i);return Sh(s,t,u),u}class Eh extends Qr{acquireContext(t,e){const s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(Ch(t,e),s):null}releaseContext(t){const e=t.canvas;if(!e[Bi])return!1;const s=e[Bi].initial;["height","width"].forEach(g=>{const v=s[g];_t(v)?e.removeAttribute(g):e.setAttribute(g,v)});const u=s.style||{};return Object.keys(u).forEach(g=>{e.style[g]=u[g]}),e.width=e.width,delete e[Bi],!0}addEventListener(t,e,s){this.removeEventListener(t,e);const u=t.$proxies||(t.$proxies={}),v={attach:Oh,detach:kh,resize:Dh}[e]||Ah;u[e]=v(t,e,s)}removeEventListener(t,e){const s=t.$proxies||(t.$proxies={}),u=s[e];if(!u)return;({attach:mn,detach:mn,resize:mn}[e]||wh)(t,e,u),s[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,s,u){return yl(t,e,s,u)}isAttached(t){const e=Gn(t);return!!(e&&e.isConnected)}}function Fh(i){return!Hr()||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?yh:Eh}var Ei;let De=(Ei=class{constructor(){nt(this,"x");nt(this,"y");nt(this,"active",!1);nt(this,"options");nt(this,"$animations")}tooltipPosition(t){const{x:e,y:s}=this.getProps(["x","y"],t);return{x:e,y:s}}hasValue(){return hi(this.x)&&hi(this.y)}getProps(t,e){const s=this.$animations;if(!e||!s)return this;const u={};return t.forEach(g=>{u[g]=s[g]&&s[g].active()?s[g]._to:this[g]}),u}},nt(Ei,"defaults",{}),nt(Ei,"defaultRoutes"),Ei);function Lh(i,t){const e=i.options.ticks,s=Rh(i),u=Math.min(e.maxTicksLimit||s,s),g=e.major.enabled?Bh(t):[],v=g.length,o=g[0],n=g[v-1],h=[];if(v>u)return jh(t,h,g,v/u),h;const f=Ih(g,t,u);if(v>0){let r,l;const a=v>1?Math.round((n-o)/(v-1)):null;for(wi(t,h,f,_t(a)?0:o-a,o),r=0,l=v-1;r<l;r++)wi(t,h,f,g[r],g[r+1]);return wi(t,h,f,n,_t(a)?t.length:n+a),h}return wi(t,h,f),h}function Rh(i){const t=i.options.offset,e=i._tickSize(),s=i._length/e+(t?0:1),u=i._maxLength/e;return Math.floor(Math.min(s,u))}function Ih(i,t,e){const s=zh(i),u=t.length/e;if(!s)return Math.max(u,1);const g=ya(s);for(let v=0,o=g.length-1;v<o;v++){const n=g[v];if(n>u)return n}return Math.max(u,1)}function Bh(i){const t=[];let e,s;for(e=0,s=i.length;e<s;e++)i[e].major&&t.push(e);return t}function jh(i,t,e,s){let u=0,g=e[0],v;for(s=Math.ceil(s),v=0;v<i.length;v++)v===g&&(t.push(i[v]),u++,g=e[u*s])}function wi(i,t,e,s,u){const g=pt(s,0),v=Math.min(pt(u,i.length),i.length);let o=0,n,h,f;for(e=Math.ceil(e),u&&(n=u-s,e=n/Math.floor(n/e)),f=g;f<0;)o++,f=Math.round(g+o*e);for(h=Math.max(g,0);h<v;h++)h===f&&(t.push(i[h]),o++,f=Math.round(g+o*e))}function zh(i){const t=i.length;let e,s;if(t<2)return!1;for(s=i[0],e=1;e<t;++e)if(i[e]-i[e-1]!==s)return!1;return s}const Wh=i=>i==="left"?"right":i==="right"?"left":i,js=(i,t,e)=>t==="top"||t==="left"?i[t]+e:i[t]-e,zs=(i,t)=>Math.min(t||i,i);function Ws(i,t){const e=[],s=i.length/t,u=i.length;let g=0;for(;g<u;g+=s)e.push(i[Math.floor(g)]);return e}function Nh(i,t,e){const s=i.ticks.length,u=Math.min(t,s-1),g=i._startPixel,v=i._endPixel,o=1e-6;let n=i.getPixelForTick(u),h;if(!(e&&(s===1?h=Math.max(n-g,v-n):t===0?h=(i.getPixelForTick(1)-n)/2:h=(n-i.getPixelForTick(u-1))/2,n+=u<t?h:-h,n<g-o||n>v+o)))return n}function Vh(i,t){vt(i,e=>{const s=e.gc,u=s.length/2;let g;if(u>t){for(g=0;g<u;++g)delete e.data[s[g]];s.splice(0,u)}})}function Ue(i){return i.drawTicks?i.tickLength:0}function Ns(i,t){if(!i.display)return 0;const e=Et(i.font,t),s=Yt(i.padding);return(Ct(i.text)?i.text.length:1)*e.lineHeight+s.height}function Yh(i,t){return _e(i,{scale:t,type:"scale"})}function Xh(i,t,e){return _e(i,{tick:e,index:t,type:"tick"})}function Hh(i,t,e){let s=Lr(i);return(e&&t!=="right"||!e&&t==="right")&&(s=Wh(s)),s}function Uh(i,t,e,s){const{top:u,left:g,bottom:v,right:o,chart:n}=i,{chartArea:h,scales:f}=n;let r=0,l,a,d;const p=v-u,c=o-g;if(i.isHorizontal()){if(a=ii(s,g,o),gt(e)){const m=Object.keys(e)[0],_=e[m];d=f[m].getPixelForValue(_)+p-t}else e==="center"?d=(h.bottom+h.top)/2+p-t:d=js(i,e,t);l=o-g}else{if(gt(e)){const m=Object.keys(e)[0],_=e[m];a=f[m].getPixelForValue(_)-c+t}else e==="center"?a=(h.left+h.right)/2-c+t:a=js(i,e,t);d=ii(s,v,u),r=e==="left"?-At:At}return{titleX:a,titleY:d,maxWidth:l,rotation:r}}class Ae extends De{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:s,_suggestedMax:u}=this;return t=Bt(t,Number.POSITIVE_INFINITY),e=Bt(e,Number.NEGATIVE_INFINITY),s=Bt(s,Number.POSITIVE_INFINITY),u=Bt(u,Number.NEGATIVE_INFINITY),{min:Bt(t,s),max:Bt(e,u),minDefined:kt(t),maxDefined:kt(e)}}getMinMax(t){let{min:e,max:s,minDefined:u,maxDefined:g}=this.getUserBounds(),v;if(u&&g)return{min:e,max:s};const o=this.getMatchingVisibleMetas();for(let n=0,h=o.length;n<h;++n)v=o[n].controller.getMinMax(this,t),u||(e=Math.min(e,v.min)),g||(s=Math.max(s,v.max));return e=g&&e>s?s:e,s=u&&e>s?e:s,{min:Bt(e,Bt(s,e)),max:Bt(s,Bt(e,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){wt(this.options.beforeUpdate,[this])}update(t,e,s){const{beginAtZero:u,grace:g,ticks:v}=this.options,o=v.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Ja(this,g,u),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const n=o<this.ticks.length;this._convertTicksToLabels(n?Ws(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),v.display&&(v.autoSkip||v.source==="auto")&&(this.ticks=Lh(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),n&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,s;this.isHorizontal()?(e=this.left,s=this.right):(e=this.top,s=this.bottom,t=!t),this._startPixel=e,this._endPixel=s,this._reversePixels=t,this._length=s-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){wt(this.options.afterUpdate,[this])}beforeSetDimensions(){wt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){wt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),wt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){wt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let s,u,g;for(s=0,u=t.length;s<u;s++)g=t[s],g.label=wt(e.callback,[g.value,s,t],this)}afterTickToLabelConversion(){wt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){wt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,s=zs(this.ticks.length,t.ticks.maxTicksLimit),u=e.minRotation||0,g=e.maxRotation;let v=u,o,n,h;if(!this._isVisible()||!e.display||u>=g||s<=1||!this.isHorizontal()){this.labelRotation=u;return}const f=this._getLabelSizes(),r=f.widest.width,l=f.highest.height,a=Wt(this.chart.width-r,0,this.maxWidth);o=t.offset?this.maxWidth/s:a/(s-1),r+6>o&&(o=a/(s-(t.offset?.5:1)),n=this.maxHeight-Ue(t.grid)-e.padding-Ns(t.title,this.chart.options.font),h=Math.sqrt(r*r+l*l),v=Nn(Math.min(Math.asin(Wt((f.highest.height+6)/o,-1,1)),Math.asin(Wt(n/h,-1,1))-Math.asin(Wt(l/h,-1,1)))),v=Math.max(u,Math.min(g,v))),this.labelRotation=v}afterCalculateLabelRotation(){wt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){wt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:s,title:u,grid:g}}=this,v=this._isVisible(),o=this.isHorizontal();if(v){const n=Ns(u,e.options.font);if(o?(t.width=this.maxWidth,t.height=Ue(g)+n):(t.height=this.maxHeight,t.width=Ue(g)+n),s.display&&this.ticks.length){const{first:h,last:f,widest:r,highest:l}=this._getLabelSizes(),a=s.padding*2,d=Qt(this.labelRotation),p=Math.cos(d),c=Math.sin(d);if(o){const m=s.mirror?0:c*r.width+p*l.height;t.height=Math.min(this.maxHeight,t.height+m+a)}else{const m=s.mirror?0:p*r.width+c*l.height;t.width=Math.min(this.maxWidth,t.width+m+a)}this._calculatePadding(h,f,c,p)}}this._handleMargins(),o?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,s,u){const{ticks:{align:g,padding:v},position:o}=this.options,n=this.labelRotation!==0,h=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const f=this.getPixelForTick(0)-this.left,r=this.right-this.getPixelForTick(this.ticks.length-1);let l=0,a=0;n?h?(l=u*t.width,a=s*e.height):(l=s*t.height,a=u*e.width):g==="start"?a=e.width:g==="end"?l=t.width:g!=="inner"&&(l=t.width/2,a=e.width/2),this.paddingLeft=Math.max((l-f+v)*this.width/(this.width-f),0),this.paddingRight=Math.max((a-r+v)*this.width/(this.width-r),0)}else{let f=e.height/2,r=t.height/2;g==="start"?(f=0,r=t.height):g==="end"&&(f=e.height,r=0),this.paddingTop=f+v,this.paddingBottom=r+v}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){wt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,s;for(e=0,s=t.length;e<s;e++)_t(t[e].label)&&(t.splice(e,1),s--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let s=this.ticks;e<s.length&&(s=Ws(s,e)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,s){const{ctx:u,_longestTextCache:g}=this,v=[],o=[],n=Math.floor(e/zs(e,s));let h=0,f=0,r,l,a,d,p,c,m,_,b,y,x;for(r=0;r<e;r+=n){if(d=t[r].label,p=this._resolveTickFontOptions(r),u.font=c=p.string,m=g[c]=g[c]||{data:{},gc:[]},_=p.lineHeight,b=y=0,!_t(d)&&!Ct(d))b=qi(u,m.data,m.gc,b,d),y=_;else if(Ct(d))for(l=0,a=d.length;l<a;++l)x=d[l],!_t(x)&&!Ct(x)&&(b=qi(u,m.data,m.gc,b,x),y+=_);v.push(b),o.push(y),h=Math.max(b,h),f=Math.max(y,f)}Vh(g,e);const C=v.indexOf(h),T=o.indexOf(f),k=E=>({width:v[E]||0,height:o[E]||0});return{first:k(0),last:k(e-1),widest:k(C),highest:k(T),widths:v,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return wa(this._alignToPixels?xe(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const s=e[t];return s.$context||(s.$context=Xh(this.getContext(),t,s))}return this.$context||(this.$context=Yh(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=Qt(this.labelRotation),s=Math.abs(Math.cos(e)),u=Math.abs(Math.sin(e)),g=this._getLabelSizes(),v=t.autoSkipPadding||0,o=g?g.widest.width+v:0,n=g?g.highest.height+v:0;return this.isHorizontal()?n*s>o*u?o/s:n/u:n*u<o*s?n/s:o/u}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,s=this.chart,u=this.options,{grid:g,position:v,border:o}=u,n=g.offset,h=this.isHorizontal(),r=this.ticks.length+(n?1:0),l=Ue(g),a=[],d=o.setContext(this.getContext()),p=d.display?d.width:0,c=p/2,m=function(Q){return xe(s,Q,p)};let _,b,y,x,C,T,k,E,z,N,$,J;if(v==="top")_=m(this.bottom),T=this.bottom-l,E=_-c,N=m(t.top)+c,J=t.bottom;else if(v==="bottom")_=m(this.top),N=t.top,J=m(t.bottom)-c,T=_+c,E=this.top+l;else if(v==="left")_=m(this.right),C=this.right-l,k=_-c,z=m(t.left)+c,$=t.right;else if(v==="right")_=m(this.left),z=t.left,$=m(t.right)-c,C=_+c,k=this.left+l;else if(e==="x"){if(v==="center")_=m((t.top+t.bottom)/2+.5);else if(gt(v)){const Q=Object.keys(v)[0],tt=v[Q];_=m(this.chart.scales[Q].getPixelForValue(tt))}N=t.top,J=t.bottom,T=_+c,E=T+l}else if(e==="y"){if(v==="center")_=m((t.left+t.right)/2);else if(gt(v)){const Q=Object.keys(v)[0],tt=v[Q];_=m(this.chart.scales[Q].getPixelForValue(tt))}C=_-c,k=C-l,z=t.left,$=t.right}const K=pt(u.ticks.maxTicksLimit,r),G=Math.max(1,Math.ceil(r/K));for(b=0;b<r;b+=G){const Q=this.getContext(b),tt=g.setContext(Q),it=o.setContext(Q),w=tt.lineWidth,M=tt.color,D=it.dash||[],P=it.dashOffset,R=tt.tickWidth,O=tt.tickColor,S=tt.tickBorderDash||[],A=tt.tickBorderDashOffset;y=Nh(this,b,n),y!==void 0&&(x=xe(s,y,w),h?C=k=z=$=x:T=E=N=J=x,a.push({tx1:C,ty1:T,tx2:k,ty2:E,x1:z,y1:N,x2:$,y2:J,width:w,color:M,borderDash:D,borderDashOffset:P,tickWidth:R,tickColor:O,tickBorderDash:S,tickBorderDashOffset:A}))}return this._ticksLength=r,this._borderValue=_,a}_computeLabelItems(t){const e=this.axis,s=this.options,{position:u,ticks:g}=s,v=this.isHorizontal(),o=this.ticks,{align:n,crossAlign:h,padding:f,mirror:r}=g,l=Ue(s.grid),a=l+f,d=r?-f:a,p=-Qt(this.labelRotation),c=[];let m,_,b,y,x,C,T,k,E,z,N,$,J="middle";if(u==="top")C=this.bottom-d,T=this._getXAxisLabelAlignment();else if(u==="bottom")C=this.top+d,T=this._getXAxisLabelAlignment();else if(u==="left"){const G=this._getYAxisLabelAlignment(l);T=G.textAlign,x=G.x}else if(u==="right"){const G=this._getYAxisLabelAlignment(l);T=G.textAlign,x=G.x}else if(e==="x"){if(u==="center")C=(t.top+t.bottom)/2+a;else if(gt(u)){const G=Object.keys(u)[0],Q=u[G];C=this.chart.scales[G].getPixelForValue(Q)+a}T=this._getXAxisLabelAlignment()}else if(e==="y"){if(u==="center")x=(t.left+t.right)/2-a;else if(gt(u)){const G=Object.keys(u)[0],Q=u[G];x=this.chart.scales[G].getPixelForValue(Q)}T=this._getYAxisLabelAlignment(l).textAlign}e==="y"&&(n==="start"?J="top":n==="end"&&(J="bottom"));const K=this._getLabelSizes();for(m=0,_=o.length;m<_;++m){b=o[m],y=b.label;const G=g.setContext(this.getContext(m));k=this.getPixelForTick(m)+g.labelOffset,E=this._resolveTickFontOptions(m),z=E.lineHeight,N=Ct(y)?y.length:1;const Q=N/2,tt=G.color,it=G.textStrokeColor,w=G.textStrokeWidth;let M=T;v?(x=k,T==="inner"&&(m===_-1?M=this.options.reverse?"left":"right":m===0?M=this.options.reverse?"right":"left":M="center"),u==="top"?h==="near"||p!==0?$=-N*z+z/2:h==="center"?$=-K.highest.height/2-Q*z+z:$=-K.highest.height+z/2:h==="near"||p!==0?$=z/2:h==="center"?$=K.highest.height/2-Q*z:$=K.highest.height-N*z,r&&($*=-1),p!==0&&!G.showLabelBackdrop&&(x+=z/2*Math.sin(p))):(C=k,$=(1-N)*z/2);let D;if(G.showLabelBackdrop){const P=Yt(G.backdropPadding),R=K.heights[m],O=K.widths[m];let S=$-P.top,A=0-P.left;switch(J){case"middle":S-=R/2;break;case"bottom":S-=R;break}switch(T){case"center":A-=O/2;break;case"right":A-=O;break}D={left:A,top:S,width:O+P.width,height:R+P.height,color:G.backdropColor}}c.push({label:y,font:E,textOffset:$,options:{rotation:p,color:tt,strokeColor:it,strokeWidth:w,textAlign:M,textBaseline:J,translation:[x,C],backdrop:D}})}return c}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-Qt(this.labelRotation))return t==="top"?"left":"right";let u="center";return e.align==="start"?u="left":e.align==="end"?u="right":e.align==="inner"&&(u="inner"),u}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:s,mirror:u,padding:g}}=this.options,v=this._getLabelSizes(),o=t+g,n=v.widest.width;let h,f;return e==="left"?u?(f=this.right+g,s==="near"?h="left":s==="center"?(h="center",f+=n/2):(h="right",f+=n)):(f=this.right-o,s==="near"?h="right":s==="center"?(h="center",f-=n/2):(h="left",f=this.left)):e==="right"?u?(f=this.left+g,s==="near"?h="right":s==="center"?(h="center",f-=n/2):(h="left",f-=n)):(f=this.left+o,s==="near"?h="left":s==="center"?(h="center",f+=n/2):(h="right",f=this.right)):h="right",{textAlign:h,x:f}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:s,top:u,width:g,height:v}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(s,u,g,v),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const u=this.ticks.findIndex(g=>g.value===t);return u>=0?e.setContext(this.getContext(u)).lineWidth:0}drawGrid(t){const e=this.options.grid,s=this.ctx,u=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let g,v;const o=(n,h,f)=>{!f.width||!f.color||(s.save(),s.lineWidth=f.width,s.strokeStyle=f.color,s.setLineDash(f.borderDash||[]),s.lineDashOffset=f.borderDashOffset,s.beginPath(),s.moveTo(n.x,n.y),s.lineTo(h.x,h.y),s.stroke(),s.restore())};if(e.display)for(g=0,v=u.length;g<v;++g){const n=u[g];e.drawOnChartArea&&o({x:n.x1,y:n.y1},{x:n.x2,y:n.y2},n),e.drawTicks&&o({x:n.tx1,y:n.ty1},{x:n.tx2,y:n.ty2},{color:n.tickColor,width:n.tickWidth,borderDash:n.tickBorderDash,borderDashOffset:n.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:s,grid:u}}=this,g=s.setContext(this.getContext()),v=s.display?g.width:0;if(!v)return;const o=u.setContext(this.getContext(0)).lineWidth,n=this._borderValue;let h,f,r,l;this.isHorizontal()?(h=xe(t,this.left,v)-v/2,f=xe(t,this.right,o)+o/2,r=l=n):(r=xe(t,this.top,v)-v/2,l=xe(t,this.bottom,o)+o/2,h=f=n),e.save(),e.lineWidth=g.width,e.strokeStyle=g.color,e.beginPath(),e.moveTo(h,r),e.lineTo(f,l),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const s=this.ctx,u=this._computeLabelArea();u&&Ir(s,u);const g=this.getLabelItems(t);for(const v of g){const o=v.options,n=v.font,h=v.label,f=v.textOffset;ci(s,h,0,f,n,o)}u&&Br(s)}drawTitle(){const{ctx:t,options:{position:e,title:s,reverse:u}}=this;if(!s.display)return;const g=Et(s.font),v=Yt(s.padding),o=s.align;let n=g.lineHeight/2;e==="bottom"||e==="center"||gt(e)?(n+=v.bottom,Ct(s.text)&&(n+=g.lineHeight*(s.text.length-1))):n+=v.top;const{titleX:h,titleY:f,maxWidth:r,rotation:l}=Uh(this,n,e,o);ci(t,s.text,0,0,g,{color:s.color,maxWidth:r,rotation:l,textAlign:Hh(o,e,u),textBaseline:"middle",translation:[h,f]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,s=pt(t.grid&&t.grid.z,-1),u=pt(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Ae.prototype.draw?[{z:e,draw:g=>{this.draw(g)}}]:[{z:s,draw:g=>{this.drawBackground(),this.drawGrid(g),this.drawTitle()}},{z:u,draw:()=>{this.drawBorder()}},{z:e,draw:g=>{this.drawLabels(g)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",u=[];let g,v;for(g=0,v=e.length;g<v;++g){const o=e[g];o[s]===this.id&&(!t||o.type===t)&&u.push(o)}return u}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return Et(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Ti{constructor(t,e,s){this.type=t,this.scope=e,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let s;qh(e)&&(s=this.register(e));const u=this.items,g=t.id,v=this.scope+"."+g;if(!g)throw new Error("class does not have id: "+t);return g in u||(u[g]=t,Gh(t,v,s),this.override&&Tt.override(t.id,t.overrides)),v}get(t){return this.items[t]}unregister(t){const e=this.items,s=t.id,u=this.scope;s in e&&delete e[s],u&&s in Tt[u]&&(delete Tt[u][s],this.override&&delete Me[s])}}function Gh(i,t,e){const s=ai(Object.create(null),[e?Tt.get(e):{},Tt.get(t),i.defaults]);Tt.set(t,s),i.defaultRoutes&&$h(t,i.defaultRoutes),i.descriptors&&Tt.describe(t,i.descriptors)}function $h(i,t){Object.keys(t).forEach(e=>{const s=e.split("."),u=s.pop(),g=[i].concat(s).join("."),v=t[e].split("."),o=v.pop(),n=v.join(".");Tt.route(g,u,n,o)})}function qh(i){return"id"in i&&"defaults"in i}class Kh{constructor(){this.controllers=new Ti(pe,"datasets",!0),this.elements=new Ti(De,"elements"),this.plugins=new Ti(Object,"plugins"),this.scales=new Ti(Ae,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,s){[...e].forEach(u=>{const g=s||this._getRegistryForType(u);s||g.isForType(u)||g===this.plugins&&u.id?this._exec(t,g,u):vt(u,v=>{const o=s||this._getRegistryForType(v);this._exec(t,o,v)})})}_exec(t,e,s){const u=Wn(t);wt(s["before"+u],[],s),e[t](s),wt(s["after"+u],[],s)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const s=this._typedRegistries[e];if(s.isForType(t))return s}return this.plugins}_get(t,e,s){const u=e.get(t);if(u===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return u}}var ie=new Kh;class Jh{constructor(){this._init=[]}notify(t,e,s,u){e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const g=u?this._descriptors(t).filter(u):this._descriptors(t),v=this._notify(g,t,e,s);return e==="afterDestroy"&&(this._notify(g,t,"stop"),this._notify(this._init,t,"uninstall")),v}_notify(t,e,s,u){u=u||{};for(const g of t){const v=g.plugin,o=v[s],n=[e,u,g.options];if(wt(o,n,v)===!1&&u.cancelable)return!1}return!0}invalidate(){_t(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const s=t&&t.config,u=pt(s.options&&s.options.plugins,{}),g=Qh(s);return u===!1&&!e?[]:tc(t,g,u,e)}_notifyStateChanges(t){const e=this._oldCache||[],s=this._cache,u=(g,v)=>g.filter(o=>!v.some(n=>o.plugin.id===n.plugin.id));this._notify(u(e,s),t,"stop"),this._notify(u(s,e),t,"start")}}function Qh(i){const t={},e=[],s=Object.keys(ie.plugins.items);for(let g=0;g<s.length;g++)e.push(ie.getPlugin(s[g]));const u=i.plugins||[];for(let g=0;g<u.length;g++){const v=u[g];e.indexOf(v)===-1&&(e.push(v),t[v.id]=!0)}return{plugins:e,localIds:t}}function Zh(i,t){return!t&&i===!1?null:i===!0?{}:i}function tc(i,{plugins:t,localIds:e},s,u){const g=[],v=i.getContext();for(const o of t){const n=o.id,h=Zh(s[n],u);h!==null&&g.push({plugin:o,options:ec(i.config,{plugin:o,local:e[n]},h,v)})}return g}function ec(i,{plugin:t,local:e},s,u){const g=i.pluginScopeKeys(t),v=i.getOptionScopes(s,g);return e&&t.defaults&&v.push(t.defaults),i.createResolver(v,u,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function kn(i,t){const e=Tt.datasets[i]||{};return((t.datasets||{})[i]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function ic(i,t){let e=i;return i==="_index_"?e=t:i==="_value_"&&(e=t==="x"?"y":"x"),e}function nc(i,t){return i===t?"_index_":"_value_"}function Vs(i){if(i==="x"||i==="y"||i==="r")return i}function sc(i){if(i==="top"||i==="bottom")return"x";if(i==="left"||i==="right")return"y"}function Pn(i,...t){if(Vs(i))return i;for(const e of t){const s=e.axis||sc(e.position)||i.length>1&&Vs(i[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${i}' axis. Please provide 'axis' or 'position' option.`)}function Ys(i,t,e){if(e[t+"AxisID"]===i)return{axis:t}}function rc(i,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(s=>s.xAxisID===i||s.yAxisID===i);if(e.length)return Ys(i,"x",e[0])||Ys(i,"y",e[0])}return{}}function oc(i,t){const e=Me[i.type]||{scales:{}},s=t.scales||{},u=kn(i.type,t),g=Object.create(null);return Object.keys(s).forEach(v=>{const o=s[v];if(!gt(o))return console.error(`Invalid scale configuration for scale: ${v}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${v}`);const n=Pn(v,o,rc(v,i),Tt.scales[o.type]),h=nc(n,u),f=e.scales||{};g[v]=ti(Object.create(null),[{axis:n},o,f[n],f[h]])}),i.data.datasets.forEach(v=>{const o=v.type||i.type,n=v.indexAxis||kn(o,t),f=(Me[o]||{}).scales||{};Object.keys(f).forEach(r=>{const l=ic(r,n),a=v[l+"AxisID"]||l;g[a]=g[a]||Object.create(null),ti(g[a],[{axis:l},s[a],f[r]])})}),Object.keys(g).forEach(v=>{const o=g[v];ti(o,[Tt.scales[o.type],Tt.scale])}),g}function eo(i){const t=i.options||(i.options={});t.plugins=pt(t.plugins,{}),t.scales=oc(i,t)}function io(i){return i=i||{},i.datasets=i.datasets||[],i.labels=i.labels||[],i}function ac(i){return i=i||{},i.data=io(i.data),eo(i),i}const Xs=new Map,no=new Set;function Oi(i,t){let e=Xs.get(i);return e||(e=t(),Xs.set(i,e),no.add(e)),e}const Ge=(i,t,e)=>{const s=me(t,e);s!==void 0&&i.add(s)};class lc{constructor(t){this._config=ac(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=io(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),eo(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Oi(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return Oi(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return Oi(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,s=this.type;return Oi(`${s}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const s=this._scopeCache;let u=s.get(t);return(!u||e)&&(u=new Map,s.set(t,u)),u}getOptionScopes(t,e,s){const{options:u,type:g}=this,v=this._cachedScopes(t,s),o=v.get(e);if(o)return o;const n=new Set;e.forEach(f=>{t&&(n.add(t),f.forEach(r=>Ge(n,t,r))),f.forEach(r=>Ge(n,u,r)),f.forEach(r=>Ge(n,Me[g]||{},r)),f.forEach(r=>Ge(n,Tt,r)),f.forEach(r=>Ge(n,Tn,r))});const h=Array.from(n);return h.length===0&&h.push(Object.create(null)),no.has(e)&&v.set(e,h),h}chartOptionScopes(){const{options:t,type:e}=this;return[t,Me[e]||{},Tt.datasets[e]||{},{type:e},Tt,Tn]}resolveNamedOptions(t,e,s,u=[""]){const g={$shared:!0},{resolver:v,subPrefixes:o}=Hs(this._resolverCache,t,u);let n=v;if(cc(v,e)){g.$shared=!1,s=ve(s)?s():s;const h=this.createResolver(t,s,o);n=ze(v,s,h)}for(const h of e)g[h]=n[h];return g}createResolver(t,e,s=[""],u){const{resolver:g}=Hs(this._resolverCache,t,s);return gt(e)?ze(g,e,void 0,u):g}}function Hs(i,t,e){let s=i.get(t);s||(s=new Map,i.set(t,s));const u=e.join();let g=s.get(u);return g||(g={resolver:Xn(t,e),subPrefixes:e.filter(o=>!o.toLowerCase().includes("hover"))},s.set(u,g)),g}const hc=i=>gt(i)&&Object.getOwnPropertyNames(i).reduce((t,e)=>t||ve(i[e]),!1);function cc(i,t){const{isScriptable:e,isIndexable:s}=Wr(i);for(const u of t){const g=e(u),v=s(u),o=(v||g)&&i[u];if(g&&(ve(o)||hc(o))||v&&Ct(o))return!0}return!1}var uc="4.4.0";const fc=["top","bottom","left","right","chartArea"];function Us(i,t){return i==="top"||i==="bottom"||fc.indexOf(i)===-1&&t==="x"}function Gs(i,t){return function(e,s){return e[i]===s[i]?e[t]-s[t]:e[i]-s[i]}}function $s(i){const t=i.chart,e=t.options.animation;t.notifyPlugins("afterRender"),wt(e&&e.onComplete,[i],t)}function dc(i){const t=i.chart,e=t.options.animation;wt(e&&e.onProgress,[i],t)}function so(i){return Hr()&&typeof i=="string"?i=document.getElementById(i):i&&i.length&&(i=i[0]),i&&i.canvas&&(i=i.canvas),i}const ji={},qs=i=>{const t=so(i);return Object.values(ji).filter(e=>e.canvas===t).pop()};function gc(i,t,e){const s=Object.keys(i);for(const u of s){const g=+u;if(g>=t){const v=i[u];delete i[u],(e>0||g>t)&&(i[g+e]=v)}}}function pc(i,t,e,s){return!e||i.type==="mouseout"?null:s?t:i}function ki(i,t,e){return i.options.clip?i[e]:t[e]}function mc(i,t){const{xScale:e,yScale:s}=i;return e&&s?{left:ki(e,t,"left"),right:ki(e,t,"right"),top:ki(s,t,"top"),bottom:ki(s,t,"bottom")}:t}class Lt{static register(...t){ie.add(...t),Ks()}static unregister(...t){ie.remove(...t),Ks()}constructor(t,e){const s=this.config=new lc(e),u=so(t),g=qs(u);if(g)throw new Error("Canvas is already in use. Chart with ID '"+g.id+"' must be destroyed before the canvas with ID '"+g.canvas.id+"' can be reused.");const v=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||Fh(u)),this.platform.updateConfig(s);const o=this.platform.acquireContext(u,v.aspectRatio),n=o&&o.canvas,h=n&&n.height,f=n&&n.width;if(this.id=ua(),this.ctx=o,this.canvas=n,this.width=f,this.height=h,this._options=v,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Jh,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Pa(r=>this.update(r),v.resizeDelay||0),this._dataChanges=[],ji[this.id]=this,!o||!n){console.error("Failed to create chart: can't acquire context from the given item");return}oe.listen(this,"complete",$s),oe.listen(this,"progress",dc),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:s,height:u,_aspectRatio:g}=this;return _t(t)?e&&g?g:u?s/u:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return ie}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():vs(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return gs(this.canvas,this.ctx),this}stop(){return oe.stop(this),this}resize(t,e){oe.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const s=this.options,u=this.canvas,g=s.maintainAspectRatio&&this.aspectRatio,v=this.platform.getMaximumSize(u,t,e,g),o=s.devicePixelRatio||this.platform.getDevicePixelRatio(),n=this.width?"resize":"attach";this.width=v.width,this.height=v.height,this._aspectRatio=this.aspectRatio,vs(this,o,!0)&&(this.notifyPlugins("resize",{size:v}),wt(s.onResize,[this,v],this),this.attached&&this._doResize(n)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};vt(e,(s,u)=>{s.id=u})}buildOrUpdateScales(){const t=this.options,e=t.scales,s=this.scales,u=Object.keys(s).reduce((v,o)=>(v[o]=!1,v),{});let g=[];e&&(g=g.concat(Object.keys(e).map(v=>{const o=e[v],n=Pn(v,o),h=n==="r",f=n==="x";return{options:o,dposition:h?"chartArea":f?"bottom":"left",dtype:h?"radialLinear":f?"category":"linear"}}))),vt(g,v=>{const o=v.options,n=o.id,h=Pn(n,o),f=pt(o.type,v.dtype);(o.position===void 0||Us(o.position,h)!==Us(v.dposition))&&(o.position=v.dposition),u[n]=!0;let r=null;if(n in s&&s[n].type===f)r=s[n];else{const l=ie.getScale(f);r=new l({id:n,type:f,ctx:this.ctx,chart:this}),s[r.id]=r}r.init(o,t)}),vt(u,(v,o)=>{v||delete s[o]}),vt(s,v=>{$t.configure(this,v,v.options),$t.addBox(this,v)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,s=t.length;if(t.sort((u,g)=>u.index-g.index),s>e){for(let u=e;u<s;++u)this._destroyDatasetMeta(u);t.splice(e,s-e)}this._sortedMetasets=t.slice(0).sort(Gs("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((s,u)=>{e.filter(g=>g===s._dataset).length===0&&this._destroyDatasetMeta(u)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let s,u;for(this._removeUnreferencedMetasets(),s=0,u=e.length;s<u;s++){const g=e[s];let v=this.getDatasetMeta(s);const o=g.type||this.config.type;if(v.type&&v.type!==o&&(this._destroyDatasetMeta(s),v=this.getDatasetMeta(s)),v.type=o,v.indexAxis=g.indexAxis||kn(o,this.options),v.order=g.order||0,v.index=s,v.label=""+g.label,v.visible=this.isDatasetVisible(s),v.controller)v.controller.updateIndex(s),v.controller.linkScales();else{const n=ie.getController(o),{datasetElementType:h,dataElementType:f}=Tt.datasets[o];Object.assign(n,{dataElementType:ie.getElement(f),datasetElementType:h&&ie.getElement(h)}),v.controller=new n(this,s),t.push(v.controller)}}return this._updateMetasets(),t}_resetElements(){vt(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const s=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),u=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const g=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let v=0;for(let h=0,f=this.data.datasets.length;h<f;h++){const{controller:r}=this.getDatasetMeta(h),l=!u&&g.indexOf(r)===-1;r.buildOrUpdateElements(l),v=Math.max(+r.getMaxOverflow(),v)}v=this._minPadding=s.layout.autoPadding?v:0,this._updateLayout(v),u||vt(g,h=>{h.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Gs("z","_idx"));const{_active:o,_lastEvent:n}=this;n?this._eventHandler(n,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){vt(this.scales,t=>{$t.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!rs(e,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:s,start:u,count:g}of e){const v=s==="_removeElements"?-g:g;gc(t,u,v)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,s=g=>new Set(t.filter(v=>v[0]===g).map((v,o)=>o+","+v.splice(1).join(","))),u=s(0);for(let g=1;g<e;g++)if(!rs(u,s(g)))return;return Array.from(u).map(g=>g.split(",")).map(g=>({method:g[1],start:+g[2],count:+g[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;$t.update(this,this.width,this.height,t);const e=this.chartArea,s=e.width<=0||e.height<=0;this._layers=[],vt(this.boxes,u=>{s&&u.position==="chartArea"||(u.configure&&u.configure(),this._layers.push(...u._layers()))},this),this._layers.forEach((u,g)=>{u._idx=g}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,s=this.data.datasets.length;e<s;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,s=this.data.datasets.length;e<s;++e)this._updateDataset(e,ve(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const s=this.getDatasetMeta(t),u={meta:s,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",u)!==!1&&(s.controller._update(e),u.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",u))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(oe.has(this)?this.attached&&!oe.running(this)&&oe.start(this):(this.draw(),$s({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:s,height:u}=this._resizeBeforeDraw;this._resize(s,u),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,s=[];let u,g;for(u=0,g=e.length;u<g;++u){const v=e[u];(!t||v.visible)&&s.push(v)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,s=t._clip,u=!s.disabled,g=mc(t,this.chartArea),v={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",v)!==!1&&(u&&Ir(e,{left:s.left===!1?0:g.left-s.left,right:s.right===!1?this.width:g.right+s.right,top:s.top===!1?0:g.top-s.top,bottom:s.bottom===!1?this.height:g.bottom+s.bottom}),t.controller.draw(),u&&Br(e),v.cancelable=!1,this.notifyPlugins("afterDatasetDraw",v))}isPointInArea(t){return he(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,s,u){const g=fh.modes[e];return typeof g=="function"?g(this,t,s,u):[]}getDatasetMeta(t){const e=this.data.datasets[t],s=this._metasets;let u=s.filter(g=>g&&g._dataset===e).pop();return u||(u={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},s.push(u)),u}getContext(){return this.$context||(this.$context=_e(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!e.hidden}setDatasetVisibility(t,e){const s=this.getDatasetMeta(t);s.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,s){const u=s?"show":"hide",g=this.getDatasetMeta(t),v=g.controller._resolveAnimations(void 0,u);li(e)?(g.data[e].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),v.update(g,{visible:s}),this.update(o=>o.datasetIndex===t?u:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),oe.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),gs(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete ji[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,s=(g,v)=>{e.addEventListener(this,g,v),t[g]=v},u=(g,v,o)=>{g.offsetX=v,g.offsetY=o,this._eventHandler(g)};vt(this.options.events,g=>s(g,u))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,s=(n,h)=>{e.addEventListener(this,n,h),t[n]=h},u=(n,h)=>{t[n]&&(e.removeEventListener(this,n,h),delete t[n])},g=(n,h)=>{this.canvas&&this.resize(n,h)};let v;const o=()=>{u("attach",o),this.attached=!0,this.resize(),s("resize",g),s("detach",v)};v=()=>{this.attached=!1,u("resize",g),this._stop(),this._resize(0,0),s("attach",o)},e.isAttached(this.canvas)?o():v()}unbindEvents(){vt(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},vt(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,s){const u=s?"set":"remove";let g,v,o,n;for(e==="dataset"&&(g=this.getDatasetMeta(t[0].datasetIndex),g.controller["_"+u+"DatasetHoverStyle"]()),o=0,n=t.length;o<n;++o){v=t[o];const h=v&&this.getDatasetMeta(v.datasetIndex).controller;h&&h[u+"HoverStyle"](v.element,v.datasetIndex,v.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],s=t.map(({datasetIndex:g,index:v})=>{const o=this.getDatasetMeta(g);if(!o)throw new Error("No dataset found at index "+g);return{datasetIndex:g,element:o.data[v],index:v}});!Hi(s,e)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,e))}notifyPlugins(t,e,s){return this._plugins.notify(this,t,e,s)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,s){const u=this.options.hover,g=(n,h)=>n.filter(f=>!h.some(r=>f.datasetIndex===r.datasetIndex&&f.index===r.index)),v=g(e,t),o=s?t:g(t,e);v.length&&this.updateHoverStyle(v,u.mode,!1),o.length&&u.mode&&this.updateHoverStyle(o,u.mode,!0)}_eventHandler(t,e){const s={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},u=v=>(v.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,u)===!1)return;const g=this._handleEvent(t,e,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,u),(g||s.changed)&&this.render(),this}_handleEvent(t,e,s){const{_active:u=[],options:g}=this,v=e,o=this._getActiveElements(t,u,s,v),n=va(t),h=pc(t,this._lastEvent,s,n);s&&(this._lastEvent=null,wt(g.onHover,[t,o,this],this),n&&wt(g.onClick,[t,o,this],this));const f=!Hi(o,u);return(f||e)&&(this._active=o,this._updateHoverStyles(o,u,e)),this._lastEvent=h,f}_getActiveElements(t,e,s,u){if(t.type==="mouseout")return[];if(!s)return e;const g=this.options.hover;return this.getElementsAtEventForMode(t,g.mode,g,u)}}nt(Lt,"defaults",Tt),nt(Lt,"instances",ji),nt(Lt,"overrides",Me),nt(Lt,"registry",ie),nt(Lt,"version",uc),nt(Lt,"getChart",qs);function Ks(){return vt(Lt.instances,i=>i._plugins.invalidate())}function ro(i,t,e=t){i.lineCap=pt(e.borderCapStyle,t.borderCapStyle),i.setLineDash(pt(e.borderDash,t.borderDash)),i.lineDashOffset=pt(e.borderDashOffset,t.borderDashOffset),i.lineJoin=pt(e.borderJoinStyle,t.borderJoinStyle),i.lineWidth=pt(e.borderWidth,t.borderWidth),i.strokeStyle=pt(e.borderColor,t.borderColor)}function vc(i,t,e){i.lineTo(e.x,e.y)}function _c(i){return i.stepped?Va:i.tension||i.cubicInterpolationMode==="monotone"?Ya:vc}function oo(i,t,e={}){const s=i.length,{start:u=0,end:g=s-1}=e,{start:v,end:o}=t,n=Math.max(u,v),h=Math.min(g,o),f=u<v&&g<v||u>o&&g>o;return{count:s,start:n,loop:t.loop,ilen:h<n&&!f?s+h-n:h-n}}function bc(i,t,e,s){const{points:u,options:g}=t,{count:v,start:o,loop:n,ilen:h}=oo(u,e,s),f=_c(g);let{move:r=!0,reverse:l}=s||{},a,d,p;for(a=0;a<=h;++a)d=u[(o+(l?h-a:a))%v],!d.skip&&(r?(i.moveTo(d.x,d.y),r=!1):f(i,p,d,l,g.stepped),p=d);return n&&(d=u[(o+(l?h:0))%v],f(i,p,d,l,g.stepped)),!!n}function yc(i,t,e,s){const u=t.points,{count:g,start:v,ilen:o}=oo(u,e,s),{move:n=!0,reverse:h}=s||{};let f=0,r=0,l,a,d,p,c,m;const _=y=>(v+(h?o-y:y))%g,b=()=>{p!==c&&(i.lineTo(f,c),i.lineTo(f,p),i.lineTo(f,m))};for(n&&(a=u[_(0)],i.moveTo(a.x,a.y)),l=0;l<=o;++l){if(a=u[_(l)],a.skip)continue;const y=a.x,x=a.y,C=y|0;C===d?(x<p?p=x:x>c&&(c=x),f=(r*f+y)/++r):(b(),i.lineTo(y,x),d=C,r=0,p=c=x),m=x}b()}function Mn(i){const t=i.options,e=t.borderDash&&t.borderDash.length;return!i._decimated&&!i._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?yc:bc}function xc(i){return i.stepped?Cl:i.tension||i.cubicInterpolationMode==="monotone"?Sl:Te}function Cc(i,t,e,s){let u=t._path;u||(u=t._path=new Path2D,t.path(u,e,s)&&u.closePath()),ro(i,t.options),i.stroke(u)}function Sc(i,t,e,s){const{segments:u,options:g}=t,v=Mn(t);for(const o of u)ro(i,g,o.style),i.beginPath(),v(i,t,o,{start:e,end:e+s-1})&&i.closePath(),i.stroke()}const wc=typeof Path2D=="function";function Tc(i,t,e,s){wc&&!t.options.segment?Cc(i,t,e,s):Sc(i,t,e,s)}class Je extends De{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const u=s.spanGaps?this._loop:this._fullLoop;gl(this._points,s,t,u,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Fl(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,s=t.length;return s&&e[t[s-1].end]}interpolate(t,e){const s=this.options,u=t[e],g=this.points,v=Dl(this,{property:e,start:u,end:u});if(!v.length)return;const o=[],n=xc(s);let h,f;for(h=0,f=v.length;h<f;++h){const{start:r,end:l}=v[h],a=g[r],d=g[l];if(a===d){o.push(a);continue}const p=Math.abs((u-a[e])/(d[e]-a[e])),c=n(a,d,p,s.stepped);c[e]=t[e],o.push(c)}return o.length===1?o[0]:o}pathSegment(t,e,s){return Mn(this)(t,this,e,s)}path(t,e,s){const u=this.segments,g=Mn(this);let v=this._loop;e=e||0,s=s||this.points.length-e;for(const o of u)v&=g(t,this,o,{start:e,end:e+s-1});return!!v}draw(t,e,s,u){const g=this.options||{};(this.points||[]).length&&g.borderWidth&&(t.save(),Tc(t,this,s,u),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}nt(Je,"id","line"),nt(Je,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),nt(Je,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),nt(Je,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function Js(i,t,e,s){const u=i.options,{[e]:g}=i.getProps([e],s);return Math.abs(t-g)<u.radius+u.hitRadius}class zi extends De{constructor(e){super();nt(this,"parsed");nt(this,"skip");nt(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,s,u){const g=this.options,{x:v,y:o}=this.getProps(["x","y"],u);return Math.pow(e-v,2)+Math.pow(s-o,2)<Math.pow(g.hitRadius+g.radius,2)}inXRange(e,s){return Js(this,e,"x",s)}inYRange(e,s){return Js(this,e,"y",s)}getCenterPoint(e){const{x:s,y:u}=this.getProps(["x","y"],e);return{x:s,y:u}}size(e){e=e||this.options||{};let s=e.radius||0;s=Math.max(s,s&&e.hoverRadius||0);const u=s&&e.borderWidth||0;return(s+u)*2}draw(e,s){const u=this.options;this.skip||u.radius<.1||!he(this,s,this.size(u)/2)||(e.strokeStyle=u.borderColor,e.lineWidth=u.borderWidth,e.fillStyle=u.backgroundColor,On(e,u,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}nt(zi,"id","point"),nt(zi,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),nt(zi,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function ao(i,t){const{x:e,y:s,base:u,width:g,height:v}=i.getProps(["x","y","base","width","height"],t);let o,n,h,f,r;return i.horizontal?(r=v/2,o=Math.min(e,u),n=Math.max(e,u),h=s-r,f=s+r):(r=g/2,o=e-r,n=e+r,h=Math.min(s,u),f=Math.max(s,u)),{left:o,top:h,right:n,bottom:f}}function de(i,t,e,s){return i?0:Wt(t,e,s)}function Oc(i,t,e){const s=i.options.borderWidth,u=i.borderSkipped,g=zr(s);return{t:de(u.top,g.top,0,e),r:de(u.right,g.right,0,t),b:de(u.bottom,g.bottom,0,e),l:de(u.left,g.left,0,t)}}function kc(i,t,e){const{enableBorderRadius:s}=i.getProps(["enableBorderRadius"]),u=i.options.borderRadius,g=Be(u),v=Math.min(t,e),o=i.borderSkipped,n=s||gt(u);return{topLeft:de(!n||o.top||o.left,g.topLeft,0,v),topRight:de(!n||o.top||o.right,g.topRight,0,v),bottomLeft:de(!n||o.bottom||o.left,g.bottomLeft,0,v),bottomRight:de(!n||o.bottom||o.right,g.bottomRight,0,v)}}function Pc(i){const t=ao(i),e=t.right-t.left,s=t.bottom-t.top,u=Oc(i,e/2,s/2),g=kc(i,e/2,s/2);return{outer:{x:t.left,y:t.top,w:e,h:s,radius:g},inner:{x:t.left+u.l,y:t.top+u.t,w:e-u.l-u.r,h:s-u.t-u.b,radius:{topLeft:Math.max(0,g.topLeft-Math.max(u.t,u.l)),topRight:Math.max(0,g.topRight-Math.max(u.t,u.r)),bottomLeft:Math.max(0,g.bottomLeft-Math.max(u.b,u.l)),bottomRight:Math.max(0,g.bottomRight-Math.max(u.b,u.r))}}}}function vn(i,t,e,s){const u=t===null,g=e===null,o=i&&!(u&&g)&&ao(i,s);return o&&(u||wn(t,o.left,o.right))&&(g||wn(e,o.top,o.bottom))}function Mc(i){return i.topLeft||i.topRight||i.bottomLeft||i.bottomRight}function Dc(i,t){i.rect(t.x,t.y,t.w,t.h)}function _n(i,t,e={}){const s=i.x!==e.x?-t:0,u=i.y!==e.y?-t:0,g=(i.x+i.w!==e.x+e.w?t:0)-s,v=(i.y+i.h!==e.y+e.h?t:0)-u;return{x:i.x+s,y:i.y+u,w:i.w+g,h:i.h+v,radius:i.radius}}class Wi extends De{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:s,backgroundColor:u}}=this,{inner:g,outer:v}=Pc(this),o=Mc(v.radius)?Ki:Dc;t.save(),(v.w!==g.w||v.h!==g.h)&&(t.beginPath(),o(t,_n(v,e,g)),t.clip(),o(t,_n(g,-e,v)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),o(t,_n(g,e)),t.fillStyle=u,t.fill(),t.restore()}inRange(t,e,s){return vn(this,t,e,s)}inXRange(t,e){return vn(this,t,null,e)}inYRange(t,e){return vn(this,null,t,e)}getCenterPoint(t){const{x:e,y:s,base:u,horizontal:g}=this.getProps(["x","y","base","horizontal"],t);return{x:g?(e+u)/2:e,y:g?s:(s+u)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}nt(Wi,"id","bar"),nt(Wi,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),nt(Wi,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Dn=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Qs=Dn.map(i=>i.replace("rgb(","rgba(").replace(")",", 0.5)"));function lo(i){return Dn[i%Dn.length]}function ho(i){return Qs[i%Qs.length]}function Ac(i,t){return i.borderColor=lo(t),i.backgroundColor=ho(t),++t}function Ec(i,t){return i.backgroundColor=i.data.map(()=>lo(t++)),t}function Fc(i,t){return i.backgroundColor=i.data.map(()=>ho(t++)),t}function Lc(i){let t=0;return(e,s)=>{const u=i.getDatasetMeta(s).controller;u instanceof qe?t=Ec(e,t):u instanceof Ii?t=Fc(e,t):u&&(t=Ac(e,t))}}function Zs(i){let t;for(t in i)if(i[t].borderColor||i[t].backgroundColor)return!0;return!1}function Rc(i){return i&&(i.borderColor||i.backgroundColor)}var co={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(i,t,e){if(!e.enabled)return;const{data:{datasets:s},options:u}=i.config,{elements:g}=u;if(!e.forceOverride&&(Zs(s)||Rc(u)||g&&Zs(g)))return;const v=Lc(i);s.forEach(v)}};class qn extends De{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const u=Ct(s.text)?s.text.length:1;this._padding=Yt(s.padding);const g=u*Et(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=g:this.width=g}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:s,bottom:u,right:g,options:v}=this,o=v.align;let n=0,h,f,r;return this.isHorizontal()?(f=ii(o,s,g),r=e+t,h=g-s):(v.position==="left"?(f=s+t,r=ii(o,u,e),n=St*-.5):(f=g-t,r=ii(o,e,u),n=St*.5),h=u-e),{titleX:f,titleY:r,maxWidth:h,rotation:n}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const s=Et(e.font),g=s.lineHeight/2+this._padding.top,{titleX:v,titleY:o,maxWidth:n,rotation:h}=this._drawArgs(g);ci(t,e.text,0,0,s,{color:e.color,maxWidth:n,rotation:h,textAlign:Lr(e.align),textBaseline:"middle",translation:[v,o]})}}function Ic(i,t){const e=new qn({ctx:i.ctx,options:t,chart:i});$t.configure(i,e,t),$t.addBox(i,e),i.titleBlock=e}var Bc={id:"title",_element:qn,start(i,t,e){Ic(i,e)},stop(i){const t=i.titleBlock;$t.removeBox(i,t),delete i.titleBlock},beforeUpdate(i,t,e){const s=i.titleBlock;$t.configure(i,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Pi=new WeakMap;var jc={id:"subtitle",start(i,t,e){const s=new qn({ctx:i.ctx,options:e,chart:i});$t.configure(i,s,e),$t.addBox(i,s),Pi.set(i,s)},stop(i){$t.removeBox(i,Pi.get(i)),Pi.delete(i)},beforeUpdate(i,t,e){const s=Pi.get(i);$t.configure(i,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Qe={average(i){if(!i.length)return!1;let t,e,s=0,u=0,g=0;for(t=0,e=i.length;t<e;++t){const v=i[t].element;if(v&&v.hasValue()){const o=v.tooltipPosition();s+=o.x,u+=o.y,++g}}return{x:s/g,y:u/g}},nearest(i,t){if(!i.length)return!1;let e=t.x,s=t.y,u=Number.POSITIVE_INFINITY,g,v,o;for(g=0,v=i.length;g<v;++g){const n=i[g].element;if(n&&n.hasValue()){const h=n.getCenterPoint(),f=Sn(t,h);f<u&&(u=f,o=n)}}if(o){const n=o.tooltipPosition();e=n.x,s=n.y}return{x:e,y:s}}};function ee(i,t){return t&&(Ct(t)?Array.prototype.push.apply(i,t):i.push(t)),i}function ae(i){return(typeof i=="string"||i instanceof String)&&i.indexOf(`
`)>-1?i.split(`
`):i}function zc(i,t){const{element:e,datasetIndex:s,index:u}=t,g=i.getDatasetMeta(s).controller,{label:v,value:o}=g.getLabelAndValue(u);return{chart:i,label:v,parsed:g.getParsed(u),raw:i.data.datasets[s].data[u],formattedValue:o,dataset:g.getDataset(),dataIndex:u,datasetIndex:s,element:e}}function tr(i,t){const e=i.chart.ctx,{body:s,footer:u,title:g}=i,{boxWidth:v,boxHeight:o}=t,n=Et(t.bodyFont),h=Et(t.titleFont),f=Et(t.footerFont),r=g.length,l=u.length,a=s.length,d=Yt(t.padding);let p=d.height,c=0,m=s.reduce((y,x)=>y+x.before.length+x.lines.length+x.after.length,0);if(m+=i.beforeBody.length+i.afterBody.length,r&&(p+=r*h.lineHeight+(r-1)*t.titleSpacing+t.titleMarginBottom),m){const y=t.displayColors?Math.max(o,n.lineHeight):n.lineHeight;p+=a*y+(m-a)*n.lineHeight+(m-1)*t.bodySpacing}l&&(p+=t.footerMarginTop+l*f.lineHeight+(l-1)*t.footerSpacing);let _=0;const b=function(y){c=Math.max(c,e.measureText(y).width+_)};return e.save(),e.font=h.string,vt(i.title,b),e.font=n.string,vt(i.beforeBody.concat(i.afterBody),b),_=t.displayColors?v+2+t.boxPadding:0,vt(s,y=>{vt(y.before,b),vt(y.lines,b),vt(y.after,b)}),_=0,e.font=f.string,vt(i.footer,b),e.restore(),c+=d.width,{width:c,height:p}}function Wc(i,t){const{y:e,height:s}=t;return e<s/2?"top":e>i.height-s/2?"bottom":"center"}function Nc(i,t,e,s){const{x:u,width:g}=s,v=e.caretSize+e.caretPadding;if(i==="left"&&u+g+v>t.width||i==="right"&&u-g-v<0)return!0}function Vc(i,t,e,s){const{x:u,width:g}=e,{width:v,chartArea:{left:o,right:n}}=i;let h="center";return s==="center"?h=u<=(o+n)/2?"left":"right":u<=g/2?h="left":u>=v-g/2&&(h="right"),Nc(h,i,t,e)&&(h="center"),h}function er(i,t,e){const s=e.yAlign||t.yAlign||Wc(i,e);return{xAlign:e.xAlign||t.xAlign||Vc(i,t,e,s),yAlign:s}}function Yc(i,t){let{x:e,width:s}=i;return t==="right"?e-=s:t==="center"&&(e-=s/2),e}function Xc(i,t,e){let{y:s,height:u}=i;return t==="top"?s+=e:t==="bottom"?s-=u+e:s-=u/2,s}function ir(i,t,e,s){const{caretSize:u,caretPadding:g,cornerRadius:v}=i,{xAlign:o,yAlign:n}=e,h=u+g,{topLeft:f,topRight:r,bottomLeft:l,bottomRight:a}=Be(v);let d=Yc(t,o);const p=Xc(t,n,h);return n==="center"?o==="left"?d+=h:o==="right"&&(d-=h):o==="left"?d-=Math.max(f,l)+u:o==="right"&&(d+=Math.max(r,a)+u),{x:Wt(d,0,s.width-t.width),y:Wt(p,0,s.height-t.height)}}function Mi(i,t,e){const s=Yt(e.padding);return t==="center"?i.x+i.width/2:t==="right"?i.x+i.width-s.right:i.x+s.left}function nr(i){return ee([],ae(i))}function Hc(i,t,e){return _e(i,{tooltip:t,tooltipItems:e,type:"tooltip"})}function sr(i,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?i.override(e):i}const uo={beforeTitle:re,title(i){if(i.length>0){const t=i[0],e=t.chart.data.labels,s=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return e[t.dataIndex]}return""},afterTitle:re,beforeBody:re,beforeLabel:re,label(i){if(this&&this.options&&this.options.mode==="dataset")return i.label+": "+i.formattedValue||i.formattedValue;let t=i.dataset.label||"";t&&(t+=": ");const e=i.formattedValue;return _t(e)||(t+=e),t},labelColor(i){const e=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(i){const e=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:re,afterBody:re,beforeFooter:re,footer:re,afterFooter:re};function Ft(i,t,e,s){const u=i[t].call(e,s);return typeof u>"u"?uo[t].call(e,s):u}class An extends De{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,s=this.options.setContext(this.getContext()),u=s.enabled&&e.options.animation&&s.animations,g=new Gr(this.chart,u);return u._cacheable&&(this._cachedAnimations=Object.freeze(g)),g}getContext(){return this.$context||(this.$context=Hc(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:s}=e,u=Ft(s,"beforeTitle",this,t),g=Ft(s,"title",this,t),v=Ft(s,"afterTitle",this,t);let o=[];return o=ee(o,ae(u)),o=ee(o,ae(g)),o=ee(o,ae(v)),o}getBeforeBody(t,e){return nr(Ft(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:s}=e,u=[];return vt(t,g=>{const v={before:[],lines:[],after:[]},o=sr(s,g);ee(v.before,ae(Ft(o,"beforeLabel",this,g))),ee(v.lines,Ft(o,"label",this,g)),ee(v.after,ae(Ft(o,"afterLabel",this,g))),u.push(v)}),u}getAfterBody(t,e){return nr(Ft(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:s}=e,u=Ft(s,"beforeFooter",this,t),g=Ft(s,"footer",this,t),v=Ft(s,"afterFooter",this,t);let o=[];return o=ee(o,ae(u)),o=ee(o,ae(g)),o=ee(o,ae(v)),o}_createItems(t){const e=this._active,s=this.chart.data,u=[],g=[],v=[];let o=[],n,h;for(n=0,h=e.length;n<h;++n)o.push(zc(this.chart,e[n]));return t.filter&&(o=o.filter((f,r,l)=>t.filter(f,r,l,s))),t.itemSort&&(o=o.sort((f,r)=>t.itemSort(f,r,s))),vt(o,f=>{const r=sr(t.callbacks,f);u.push(Ft(r,"labelColor",this,f)),g.push(Ft(r,"labelPointStyle",this,f)),v.push(Ft(r,"labelTextColor",this,f))}),this.labelColors=u,this.labelPointStyles=g,this.labelTextColors=v,this.dataPoints=o,o}update(t,e){const s=this.options.setContext(this.getContext()),u=this._active;let g,v=[];if(!u.length)this.opacity!==0&&(g={opacity:0});else{const o=Qe[s.position].call(this,u,this._eventPosition);v=this._createItems(s),this.title=this.getTitle(v,s),this.beforeBody=this.getBeforeBody(v,s),this.body=this.getBody(v,s),this.afterBody=this.getAfterBody(v,s),this.footer=this.getFooter(v,s);const n=this._size=tr(this,s),h=Object.assign({},o,n),f=er(this.chart,s,h),r=ir(s,h,f,this.chart);this.xAlign=f.xAlign,this.yAlign=f.yAlign,g={opacity:1,x:r.x,y:r.y,width:n.width,height:n.height,caretX:o.x,caretY:o.y}}this._tooltipItems=v,this.$context=void 0,g&&this._resolveAnimations().update(this,g),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,s,u){const g=this.getCaretPosition(t,s,u);e.lineTo(g.x1,g.y1),e.lineTo(g.x2,g.y2),e.lineTo(g.x3,g.y3)}getCaretPosition(t,e,s){const{xAlign:u,yAlign:g}=this,{caretSize:v,cornerRadius:o}=s,{topLeft:n,topRight:h,bottomLeft:f,bottomRight:r}=Be(o),{x:l,y:a}=t,{width:d,height:p}=e;let c,m,_,b,y,x;return g==="center"?(y=a+p/2,u==="left"?(c=l,m=c-v,b=y+v,x=y-v):(c=l+d,m=c+v,b=y-v,x=y+v),_=c):(u==="left"?m=l+Math.max(n,f)+v:u==="right"?m=l+d-Math.max(h,r)-v:m=this.caretX,g==="top"?(b=a,y=b-v,c=m-v,_=m+v):(b=a+p,y=b+v,c=m+v,_=m-v),x=b),{x1:c,x2:m,x3:_,y1:b,y2:y,y3:x}}drawTitle(t,e,s){const u=this.title,g=u.length;let v,o,n;if(g){const h=cn(s.rtl,this.x,this.width);for(t.x=Mi(this,s.titleAlign,s),e.textAlign=h.textAlign(s.titleAlign),e.textBaseline="middle",v=Et(s.titleFont),o=s.titleSpacing,e.fillStyle=s.titleColor,e.font=v.string,n=0;n<g;++n)e.fillText(u[n],h.x(t.x),t.y+v.lineHeight/2),t.y+=v.lineHeight+o,n+1===g&&(t.y+=s.titleMarginBottom-o)}}_drawColorBox(t,e,s,u,g){const v=this.labelColors[s],o=this.labelPointStyles[s],{boxHeight:n,boxWidth:h}=g,f=Et(g.bodyFont),r=Mi(this,"left",g),l=u.x(r),a=n<f.lineHeight?(f.lineHeight-n)/2:0,d=e.y+a;if(g.usePointStyle){const p={radius:Math.min(h,n)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},c=u.leftForLtr(l,h)+h/2,m=d+n/2;t.strokeStyle=g.multiKeyBackground,t.fillStyle=g.multiKeyBackground,On(t,p,c,m),t.strokeStyle=v.borderColor,t.fillStyle=v.backgroundColor,On(t,p,c,m)}else{t.lineWidth=gt(v.borderWidth)?Math.max(...Object.values(v.borderWidth)):v.borderWidth||1,t.strokeStyle=v.borderColor,t.setLineDash(v.borderDash||[]),t.lineDashOffset=v.borderDashOffset||0;const p=u.leftForLtr(l,h),c=u.leftForLtr(u.xPlus(l,1),h-2),m=Be(v.borderRadius);Object.values(m).some(_=>_!==0)?(t.beginPath(),t.fillStyle=g.multiKeyBackground,Ki(t,{x:p,y:d,w:h,h:n,radius:m}),t.fill(),t.stroke(),t.fillStyle=v.backgroundColor,t.beginPath(),Ki(t,{x:c,y:d+1,w:h-2,h:n-2,radius:m}),t.fill()):(t.fillStyle=g.multiKeyBackground,t.fillRect(p,d,h,n),t.strokeRect(p,d,h,n),t.fillStyle=v.backgroundColor,t.fillRect(c,d+1,h-2,n-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,e,s){const{body:u}=this,{bodySpacing:g,bodyAlign:v,displayColors:o,boxHeight:n,boxWidth:h,boxPadding:f}=s,r=Et(s.bodyFont);let l=r.lineHeight,a=0;const d=cn(s.rtl,this.x,this.width),p=function(k){e.fillText(k,d.x(t.x+a),t.y+l/2),t.y+=l+g},c=d.textAlign(v);let m,_,b,y,x,C,T;for(e.textAlign=v,e.textBaseline="middle",e.font=r.string,t.x=Mi(this,c,s),e.fillStyle=s.bodyColor,vt(this.beforeBody,p),a=o&&c!=="right"?v==="center"?h/2+f:h+2+f:0,y=0,C=u.length;y<C;++y){for(m=u[y],_=this.labelTextColors[y],e.fillStyle=_,vt(m.before,p),b=m.lines,o&&b.length&&(this._drawColorBox(e,t,y,d,s),l=Math.max(r.lineHeight,n)),x=0,T=b.length;x<T;++x)p(b[x]),l=r.lineHeight;vt(m.after,p)}a=0,l=r.lineHeight,vt(this.afterBody,p),t.y-=g}drawFooter(t,e,s){const u=this.footer,g=u.length;let v,o;if(g){const n=cn(s.rtl,this.x,this.width);for(t.x=Mi(this,s.footerAlign,s),t.y+=s.footerMarginTop,e.textAlign=n.textAlign(s.footerAlign),e.textBaseline="middle",v=Et(s.footerFont),e.fillStyle=s.footerColor,e.font=v.string,o=0;o<g;++o)e.fillText(u[o],n.x(t.x),t.y+v.lineHeight/2),t.y+=v.lineHeight+s.footerSpacing}}drawBackground(t,e,s,u){const{xAlign:g,yAlign:v}=this,{x:o,y:n}=t,{width:h,height:f}=s,{topLeft:r,topRight:l,bottomLeft:a,bottomRight:d}=Be(u.cornerRadius);e.fillStyle=u.backgroundColor,e.strokeStyle=u.borderColor,e.lineWidth=u.borderWidth,e.beginPath(),e.moveTo(o+r,n),v==="top"&&this.drawCaret(t,e,s,u),e.lineTo(o+h-l,n),e.quadraticCurveTo(o+h,n,o+h,n+l),v==="center"&&g==="right"&&this.drawCaret(t,e,s,u),e.lineTo(o+h,n+f-d),e.quadraticCurveTo(o+h,n+f,o+h-d,n+f),v==="bottom"&&this.drawCaret(t,e,s,u),e.lineTo(o+a,n+f),e.quadraticCurveTo(o,n+f,o,n+f-a),v==="center"&&g==="left"&&this.drawCaret(t,e,s,u),e.lineTo(o,n+r),e.quadraticCurveTo(o,n,o+r,n),e.closePath(),e.fill(),u.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,s=this.$animations,u=s&&s.x,g=s&&s.y;if(u||g){const v=Qe[t.position].call(this,this._active,this._eventPosition);if(!v)return;const o=this._size=tr(this,t),n=Object.assign({},v,this._size),h=er(e,t,n),f=ir(t,n,h,e);(u._to!==f.x||g._to!==f.y)&&(this.xAlign=h.xAlign,this.yAlign=h.yAlign,this.width=o.width,this.height=o.height,this.caretX=v.x,this.caretY=v.y,this._resolveAnimations().update(this,f))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(e);const u={width:this.width,height:this.height},g={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const v=Yt(e.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&o&&(t.save(),t.globalAlpha=s,this.drawBackground(g,t,u,e),Ol(t,e.textDirection),g.y+=v.top,this.drawTitle(g,t,e),this.drawBody(g,t,e),this.drawFooter(g,t,e),kl(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const s=this._active,u=t.map(({datasetIndex:o,index:n})=>{const h=this.chart.getDatasetMeta(o);if(!h)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:h.data[n],index:n}}),g=!Hi(s,u),v=this._positionChanged(u,e);(g||v)&&(this._active=u,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,s=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const u=this.options,g=this._active||[],v=this._getActiveElements(t,g,e,s),o=this._positionChanged(v,t),n=e||!Hi(v,g)||o;return n&&(this._active=v,(u.enabled||u.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),n}_getActiveElements(t,e,s,u){const g=this.options;if(t.type==="mouseout")return[];if(!u)return e;const v=this.chart.getElementsAtEventForMode(t,g.mode,g,s);return g.reverse&&v.reverse(),v}_positionChanged(t,e){const{caretX:s,caretY:u,options:g}=this,v=Qe[g.position].call(this,t,e);return v!==!1&&(s!==v.x||u!==v.y)}}nt(An,"positioners",Qe);var fo={id:"tooltip",_element:An,positioners:Qe,afterInit(i,t,e){e&&(i.tooltip=new An({chart:i,options:e}))},beforeUpdate(i,t,e){i.tooltip&&i.tooltip.initialize(e)},reset(i,t,e){i.tooltip&&i.tooltip.initialize(e)},afterDraw(i){const t=i.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(i.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(i.ctx),i.notifyPlugins("afterTooltipDraw",e)}},afterEvent(i,t){if(i.tooltip){const e=t.replay;i.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(i,t)=>t.bodyFont.size,boxWidth:(i,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:uo},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:i=>i!=="filter"&&i!=="itemSort"&&i!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Uc=(i,t,e,s)=>(typeof t=="string"?(e=i.push(t)-1,s.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function Gc(i,t,e,s){const u=i.indexOf(t);if(u===-1)return Uc(i,t,e,s);const g=i.lastIndexOf(t);return u!==g?e:u}const $c=(i,t)=>i===null?null:Wt(Math.round(i),0,t);function rr(i){const t=this.getLabels();return i>=0&&i<t.length?t[i]:i}class En extends Ae{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const s=this.getLabels();for(const{index:u,label:g}of e)s[u]===g&&s.splice(u,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(_t(t))return null;const s=this.getLabels();return e=isFinite(e)&&s[e]===t?e:Gc(s,t,pt(e,t),this._addedLabels),$c(e,s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:s,max:u}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),e||(u=this.getLabels().length-1)),this.min=s,this.max=u}buildTicks(){const t=this.min,e=this.max,s=this.options.offset,u=[];let g=this.getLabels();g=t===0&&e===g.length-1?g:g.slice(t,e+1),this._valueRange=Math.max(g.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let v=t;v<=e;v++)u.push({value:v});return u}getLabelForValue(t){return rr.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}nt(En,"id","category"),nt(En,"defaults",{ticks:{callback:rr}});function qc(i,t){const e=[],{bounds:u,step:g,min:v,max:o,precision:n,count:h,maxTicks:f,maxDigits:r,includeBounds:l}=i,a=g||1,d=f-1,{min:p,max:c}=t,m=!_t(v),_=!_t(o),b=!_t(h),y=(c-p)/(r+1);let x=as((c-p)/d/a)*a,C,T,k,E;if(x<1e-14&&!m&&!_)return[{value:p},{value:c}];E=Math.ceil(c/x)-Math.floor(p/x),E>d&&(x=as(E*x/d/a)*a),_t(n)||(C=Math.pow(10,n),x=Math.ceil(x*C)/C),u==="ticks"?(T=Math.floor(p/x)*x,k=Math.ceil(c/x)*x):(T=p,k=c),m&&_&&g&&xa((o-v)/g,x/1e3)?(E=Math.round(Math.min((o-v)/x,f)),x=(o-v)/E,T=v,k=o):b?(T=m?v:T,k=_?o:k,E=h-1,x=(k-T)/E):(E=(k-T)/x,ei(E,Math.round(E),x/1e3)?E=Math.round(E):E=Math.ceil(E));const z=Math.max(ls(x),ls(T));C=Math.pow(10,_t(n)?z:n),T=Math.round(T*C)/C,k=Math.round(k*C)/C;let N=0;for(m&&(l&&T!==v?(e.push({value:v}),T<v&&N++,ei(Math.round((T+N*x)*C)/C,v,or(v,y,i))&&N++):T<v&&N++);N<E;++N){const $=Math.round((T+N*x)*C)/C;if(_&&$>o)break;e.push({value:$})}return _&&l&&k!==o?e.length&&ei(e[e.length-1].value,o,or(o,y,i))?e[e.length-1].value=o:e.push({value:o}):(!_||k===o)&&e.push({value:k}),e}function or(i,t,{horizontal:e,minRotation:s}){const u=Qt(s),g=(e?Math.sin(u):Math.cos(u))||.001,v=.75*t*(""+i).length;return Math.min(t/g,v)}class Zi extends Ae{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return _t(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:s}=this.getUserBounds();let{min:u,max:g}=this;const v=n=>u=e?u:n,o=n=>g=s?g:n;if(t){const n=ne(u),h=ne(g);n<0&&h<0?o(0):n>0&&h>0&&v(0)}if(u===g){let n=g===0?1:Math.abs(g*.05);o(g+n),t||v(u-n)}this.min=u,this.max=g}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:s}=t,u;return s?(u=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,u>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${u} ticks. Limiting to 1000.`),u=1e3)):(u=this.computeTickLimit(),e=e||11),e&&(u=Math.min(e,u)),u}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const u={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},g=this._range||this,v=qc(u,g);return t.bounds==="ticks"&&Mr(v,this,"value"),t.reverse?(v.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),v}configure(){const t=this.ticks;let e=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){const u=(s-e)/Math.max(t.length-1,1)/2;e-=u,s+=u}this._startValue=e,this._endValue=s,this._valueRange=s-e}getLabelForValue(t){return gi(t,this.chart.options.locale,this.options.ticks.format)}}class Fn extends Zi{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=kt(t)?t:0,this.max=kt(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,s=Qt(this.options.ticks.minRotation),u=(t?Math.sin(s):Math.cos(s))||.001,g=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,g.lineHeight/u))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}nt(Fn,"id","linear"),nt(Fn,"defaults",{ticks:{callback:nn.formatters.numeric}});const fi=i=>Math.floor(fe(i)),Se=(i,t)=>Math.pow(10,fi(i)+t);function ar(i){return i/Math.pow(10,fi(i))===1}function lr(i,t,e){const s=Math.pow(10,e),u=Math.floor(i/s);return Math.ceil(t/s)-u}function Kc(i,t){const e=t-i;let s=fi(e);for(;lr(i,t,s)>10;)s++;for(;lr(i,t,s)<10;)s--;return Math.min(s,fi(i))}function Jc(i,{min:t,max:e}){t=Bt(i.min,t);const s=[],u=fi(t);let g=Kc(t,e),v=g<0?Math.pow(10,Math.abs(g)):1;const o=Math.pow(10,g),n=u>g?Math.pow(10,u):0,h=Math.round((t-n)*v)/v,f=Math.floor((t-n)/o/10)*o*10;let r=Math.floor((h-f)/Math.pow(10,g)),l=Bt(i.min,Math.round((n+f+r*Math.pow(10,g))*v)/v);for(;l<e;)s.push({value:l,major:ar(l),significand:r}),r>=10?r=r<15?15:20:r++,r>=20&&(g++,r=2,v=g>=0?1:v),l=Math.round((n+f+r*Math.pow(10,g))*v)/v;const a=Bt(i.max,l);return s.push({value:a,major:ar(a),significand:r}),s}class hr extends Ae{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const s=Zi.prototype.parse.apply(this,[t,e]);if(s===0){this._zero=!0;return}return kt(s)&&s>0?s:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=kt(t)?Math.max(0,t):null,this.max=kt(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!kt(this._userMin)&&(this.min=t===Se(this.min,0)?Se(this.min,-1):Se(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let s=this.min,u=this.max;const g=o=>s=t?s:o,v=o=>u=e?u:o;s===u&&(s<=0?(g(1),v(10)):(g(Se(s,-1)),v(Se(u,1)))),s<=0&&g(Se(u,-1)),u<=0&&v(Se(s,1)),this.min=s,this.max=u}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},s=Jc(e,this);return t.bounds==="ticks"&&Mr(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(t){return t===void 0?"0":gi(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=fe(t),this._valueRange=fe(this.max)-fe(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(fe(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}nt(hr,"id","logarithmic"),nt(hr,"defaults",{ticks:{callback:nn.formatters.logarithmic,major:{enabled:!0}}});function Ln(i){const t=i.ticks;if(t.display&&i.display){const e=Yt(t.backdropPadding);return pt(t.font&&t.font.size,Tt.font.size)+e.height}return 0}function Qc(i,t,e){return e=Ct(e)?e:[e],{w:Wa(i,t.string,e),h:e.length*t.lineHeight}}function cr(i,t,e,s,u){return i===s||i===u?{start:t-e/2,end:t+e/2}:i<s||i>u?{start:t-e,end:t}:{start:t,end:t+e}}function Zc(i){const t={l:i.left+i._padding.left,r:i.right-i._padding.right,t:i.top+i._padding.top,b:i.bottom-i._padding.bottom},e=Object.assign({},t),s=[],u=[],g=i._pointLabels.length,v=i.options.pointLabels,o=v.centerPointLabels?St/g:0;for(let n=0;n<g;n++){const h=v.setContext(i.getPointLabelContext(n));u[n]=h.padding;const f=i.getPointPosition(n,i.drawingArea+u[n],o),r=Et(h.font),l=Qc(i.ctx,r,i._pointLabels[n]);s[n]=l;const a=Kt(i.getIndexAngle(n)+o),d=Math.round(Nn(a)),p=cr(d,f.x,l.w,0,180),c=cr(d,f.y,l.h,90,270);tu(e,t,a,p,c)}i.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),i._pointLabelItems=nu(i,s,u)}function tu(i,t,e,s,u){const g=Math.abs(Math.sin(e)),v=Math.abs(Math.cos(e));let o=0,n=0;s.start<t.l?(o=(t.l-s.start)/g,i.l=Math.min(i.l,t.l-o)):s.end>t.r&&(o=(s.end-t.r)/g,i.r=Math.max(i.r,t.r+o)),u.start<t.t?(n=(t.t-u.start)/v,i.t=Math.min(i.t,t.t-n)):u.end>t.b&&(n=(u.end-t.b)/v,i.b=Math.max(i.b,t.b+n))}function eu(i,t,e){const s=i.drawingArea,{extra:u,additionalAngle:g,padding:v,size:o}=e,n=i.getPointPosition(t,s+u+v,g),h=Math.round(Nn(Kt(n.angle+At))),f=ou(n.y,o.h,h),r=su(h),l=ru(n.x,o.w,r);return{visible:!0,x:n.x,y:f,textAlign:r,left:l,top:f,right:l+o.w,bottom:f+o.h}}function iu(i,t){if(!t)return!0;const{left:e,top:s,right:u,bottom:g}=i;return!(he({x:e,y:s},t)||he({x:e,y:g},t)||he({x:u,y:s},t)||he({x:u,y:g},t))}function nu(i,t,e){const s=[],u=i._pointLabels.length,g=i.options,{centerPointLabels:v,display:o}=g.pointLabels,n={extra:Ln(g)/2,additionalAngle:v?St/u:0};let h;for(let f=0;f<u;f++){n.padding=e[f],n.size=t[f];const r=eu(i,f,n);s.push(r),o==="auto"&&(r.visible=iu(r,h),r.visible&&(h=r))}return s}function su(i){return i===0||i===180?"center":i<180?"left":"right"}function ru(i,t,e){return e==="right"?i-=t:e==="center"&&(i-=t/2),i}function ou(i,t,e){return e===90||e===270?i-=t/2:(e>270||e<90)&&(i-=t),i}function au(i,t,e){const{left:s,top:u,right:g,bottom:v}=e,{backdropColor:o}=t;if(!_t(o)){const n=Be(t.borderRadius),h=Yt(t.backdropPadding);i.fillStyle=o;const f=s-h.left,r=u-h.top,l=g-s+h.width,a=v-u+h.height;Object.values(n).some(d=>d!==0)?(i.beginPath(),Ki(i,{x:f,y:r,w:l,h:a,radius:n}),i.fill()):i.fillRect(f,r,l,a)}}function lu(i,t){const{ctx:e,options:{pointLabels:s}}=i;for(let u=t-1;u>=0;u--){const g=i._pointLabelItems[u];if(!g.visible)continue;const v=s.setContext(i.getPointLabelContext(u));au(e,v,g);const o=Et(v.font),{x:n,y:h,textAlign:f}=g;ci(e,i._pointLabels[u],n,h+o.lineHeight/2,o,{color:v.color,textAlign:f,textBaseline:"middle"})}}function go(i,t,e,s){const{ctx:u}=i;if(e)u.arc(i.xCenter,i.yCenter,t,0,Pt);else{let g=i.getPointPosition(0,t);u.moveTo(g.x,g.y);for(let v=1;v<s;v++)g=i.getPointPosition(v,t),u.lineTo(g.x,g.y)}}function hu(i,t,e,s,u){const g=i.ctx,v=t.circular,{color:o,lineWidth:n}=t;!v&&!s||!o||!n||e<0||(g.save(),g.strokeStyle=o,g.lineWidth=n,g.setLineDash(u.dash),g.lineDashOffset=u.dashOffset,g.beginPath(),go(i,e,v,s),g.closePath(),g.stroke(),g.restore())}function cu(i,t,e){return _e(i,{label:e,index:t,type:"pointLabel"})}class Di extends Zi{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=Yt(Ln(this.options)/2),e=this.width=this.maxWidth-t.width,s=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+s/2+t.top),this.drawingArea=Math.floor(Math.min(e,s)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=kt(t)&&!isNaN(t)?t:0,this.max=kt(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Ln(this.options))}generateTickLabels(t){Zi.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,s)=>{const u=wt(this.options.pointLabels.callback,[e,s],this);return u||u===0?u:""}).filter((e,s)=>this.chart.getDataVisibility(s))}fit(){const t=this.options;t.display&&t.pointLabels.display?Zc(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,s,u){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((s-u)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,s,u))}getIndexAngle(t){const e=Pt/(this._pointLabels.length||1),s=this.options.startAngle||0;return Kt(t*e+Qt(s))}getDistanceFromCenterForValue(t){if(_t(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(_t(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const s=e[t];return cu(this.getContext(),t,s)}}getPointPosition(t,e,s=0){const u=this.getIndexAngle(t)-At+s;return{x:Math.cos(u)*e+this.xCenter,y:Math.sin(u)*e+this.yCenter,angle:u}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:s,right:u,bottom:g}=this._pointLabelItems[t];return{left:e,top:s,right:u,bottom:g}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const s=this.ctx;s.save(),s.beginPath(),go(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),s.closePath(),s.fillStyle=t,s.fill(),s.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:s,grid:u,border:g}=e,v=this._pointLabels.length;let o,n,h;if(e.pointLabels.display&&lu(this,v),u.display&&this.ticks.forEach((f,r)=>{if(r!==0){n=this.getDistanceFromCenterForValue(f.value);const l=this.getContext(r),a=u.setContext(l),d=g.setContext(l);hu(this,a,n,v,d)}}),s.display){for(t.save(),o=v-1;o>=0;o--){const f=s.setContext(this.getPointLabelContext(o)),{color:r,lineWidth:l}=f;!l||!r||(t.lineWidth=l,t.strokeStyle=r,t.setLineDash(f.borderDash),t.lineDashOffset=f.borderDashOffset,n=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),h=this.getPointPosition(o,n),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(h.x,h.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,s=e.ticks;if(!s.display)return;const u=this.getIndexAngle(0);let g,v;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(u),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((o,n)=>{if(n===0&&!e.reverse)return;const h=s.setContext(this.getContext(n)),f=Et(h.font);if(g=this.getDistanceFromCenterForValue(this.ticks[n].value),h.showLabelBackdrop){t.font=f.string,v=t.measureText(o.label).width,t.fillStyle=h.backdropColor;const r=Yt(h.backdropPadding);t.fillRect(-v/2-r.left,-g-f.size/2-r.top,v+r.width,f.size+r.height)}ci(t,o.label,0,-g,f,{color:h.color,strokeColor:h.textStrokeColor,strokeWidth:h.textStrokeWidth})}),t.restore()}drawTitle(){}}nt(Di,"id","radialLinear"),nt(Di,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:nn.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),nt(Di,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),nt(Di,"descriptors",{angleLines:{_fallback:"grid"}});const rn={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},It=Object.keys(rn);function ur(i,t){return i-t}function fr(i,t){if(_t(t))return null;const e=i._adapter,{parser:s,round:u,isoWeekday:g}=i._parseOpts;let v=t;return typeof s=="function"&&(v=s(v)),kt(v)||(v=typeof s=="string"?e.parse(v,s):e.parse(v)),v===null?null:(u&&(v=u==="week"&&(hi(g)||g===!0)?e.startOf(v,"isoWeek",g):e.startOf(v,u)),+v)}function dr(i,t,e,s){const u=It.length;for(let g=It.indexOf(i);g<u-1;++g){const v=rn[It[g]],o=v.steps?v.steps:Number.MAX_SAFE_INTEGER;if(v.common&&Math.ceil((e-t)/(o*v.size))<=s)return It[g]}return It[u-1]}function uu(i,t,e,s,u){for(let g=It.length-1;g>=It.indexOf(e);g--){const v=It[g];if(rn[v].common&&i._adapter.diff(u,s,v)>=t-1)return v}return It[e?It.indexOf(e):0]}function fu(i){for(let t=It.indexOf(i)+1,e=It.length;t<e;++t)if(rn[It[t]].common)return It[t]}function gr(i,t,e){if(!e)i[t]=!0;else if(e.length){const{lo:s,hi:u}=Vn(e,t),g=e[s]>=t?e[s]:e[u];i[g]=!0}}function du(i,t,e,s){const u=i._adapter,g=+u.startOf(t[0].value,s),v=t[t.length-1].value;let o,n;for(o=g;o<=v;o=+u.add(o,1,s))n=e[o],n>=0&&(t[n].major=!0);return t}function pr(i,t,e){const s=[],u={},g=t.length;let v,o;for(v=0;v<g;++v)o=t[v],u[o]=v,s.push({value:o,major:!1});return g===0||!e?s:du(i,s,u,e)}class tn extends Ae{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const s=t.time||(t.time={}),u=this._adapter=new ah._date(t.adapters.date);u.init(e),ti(s.displayFormats,u.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:fr(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,s=t.time.unit||"day";let{min:u,max:g,minDefined:v,maxDefined:o}=this.getUserBounds();function n(h){!v&&!isNaN(h.min)&&(u=Math.min(u,h.min)),!o&&!isNaN(h.max)&&(g=Math.max(g,h.max))}(!v||!o)&&(n(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&n(this.getMinMax(!1))),u=kt(u)&&!isNaN(u)?u:+e.startOf(Date.now(),s),g=kt(g)&&!isNaN(g)?g:+e.endOf(Date.now(),s)+1,this.min=Math.min(u,g-1),this.max=Math.max(u+1,g)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],s=t[t.length-1]),{min:e,max:s}}buildTicks(){const t=this.options,e=t.time,s=t.ticks,u=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&u.length&&(this.min=this._userMin||u[0],this.max=this._userMax||u[u.length-1]);const g=this.min,v=this.max,o=Oa(u,g,v);return this._unit=e.unit||(s.autoSkip?dr(e.minUnit,this.min,this.max,this._getLabelCapacity(g)):uu(this,o.length,e.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:fu(this._unit),this.initOffsets(u),t.reverse&&o.reverse(),pr(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,s=0,u,g;this.options.offset&&t.length&&(u=this.getDecimalForValue(t[0]),t.length===1?e=1-u:e=(this.getDecimalForValue(t[1])-u)/2,g=this.getDecimalForValue(t[t.length-1]),t.length===1?s=g:s=(g-this.getDecimalForValue(t[t.length-2]))/2);const v=t.length<3?.5:.25;e=Wt(e,0,v),s=Wt(s,0,v),this._offsets={start:e,end:s,factor:1/(e+1+s)}}_generate(){const t=this._adapter,e=this.min,s=this.max,u=this.options,g=u.time,v=g.unit||dr(g.minUnit,e,s,this._getLabelCapacity(e)),o=pt(u.ticks.stepSize,1),n=v==="week"?g.isoWeekday:!1,h=hi(n)||n===!0,f={};let r=e,l,a;if(h&&(r=+t.startOf(r,"isoWeek",n)),r=+t.startOf(r,h?"day":v),t.diff(s,e,v)>1e5*o)throw new Error(e+" and "+s+" are too far apart with stepSize of "+o+" "+v);const d=u.ticks.source==="data"&&this.getDataTimestamps();for(l=r,a=0;l<s;l=+t.add(l,o,v),a++)gr(f,l,d);return(l===s||u.bounds==="ticks"||a===1)&&gr(f,l,d),Object.keys(f).sort(ur).map(p=>+p)}getLabelForValue(t){const e=this._adapter,s=this.options.time;return s.tooltipFormat?e.format(t,s.tooltipFormat):e.format(t,s.displayFormats.datetime)}format(t,e){const u=this.options.time.displayFormats,g=this._unit,v=e||u[g];return this._adapter.format(t,v)}_tickFormatFunction(t,e,s,u){const g=this.options,v=g.ticks.callback;if(v)return wt(v,[t,e,s],this);const o=g.time.displayFormats,n=this._unit,h=this._majorUnit,f=n&&o[n],r=h&&o[h],l=s[e],a=h&&r&&l&&l.major;return this._adapter.format(t,u||(a?r:f))}generateTickLabels(t){let e,s,u;for(e=0,s=t.length;e<s;++e)u=t[e],u.label=this._tickFormatFunction(u.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+s)*e.factor)}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,s=this.ctx.measureText(t).width,u=Qt(this.isHorizontal()?e.maxRotation:e.minRotation),g=Math.cos(u),v=Math.sin(u),o=this._resolveTickFontOptions(0).size;return{w:s*g+o*v,h:s*v+o*g}}_getLabelCapacity(t){const e=this.options.time,s=e.displayFormats,u=s[e.unit]||s.millisecond,g=this._tickFormatFunction(t,0,pr(this,[t],this._majorUnit),u),v=this._getLabelSize(g),o=Math.floor(this.isHorizontal()?this.width/v.w:this.height/v.h)-1;return o>0?o:1}getDataTimestamps(){let t=this._cache.data||[],e,s;if(t.length)return t;const u=this.getMatchingVisibleMetas();if(this._normalized&&u.length)return this._cache.data=u[0].controller.getAllParsedValues(this);for(e=0,s=u.length;e<s;++e)t=t.concat(u[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,s;if(t.length)return t;const u=this.getLabels();for(e=0,s=u.length;e<s;++e)t.push(fr(this,u[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Ar(t.sort(ur))}}nt(tn,"id","time"),nt(tn,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Ai(i,t,e){let s=0,u=i.length-1,g,v,o,n;e?(t>=i[s].pos&&t<=i[u].pos&&({lo:s,hi:u}=ke(i,"pos",t)),{pos:g,time:o}=i[s],{pos:v,time:n}=i[u]):(t>=i[s].time&&t<=i[u].time&&({lo:s,hi:u}=ke(i,"time",t)),{time:g,pos:o}=i[s],{time:v,pos:n}=i[u]);const h=v-g;return h?o+(n-o)*(t-g)/h:o}class mr extends tn{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Ai(e,this.min),this._tableRange=Ai(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:s}=this,u=[],g=[];let v,o,n,h,f;for(v=0,o=t.length;v<o;++v)h=t[v],h>=e&&h<=s&&u.push(h);if(u.length<2)return[{time:e,pos:0},{time:s,pos:1}];for(v=0,o=u.length;v<o;++v)f=u[v+1],n=u[v-1],h=u[v],Math.round((f+n)/2)!==h&&g.push({time:h,pos:v/(o-1)});return g}_generate(){const t=this.min,e=this.max;let s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(e)||s.length===1)&&s.push(e),s.sort((u,g)=>u-g)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),s=this.getLabelTimestamps();return e.length&&s.length?t=this.normalize(e.concat(s)):t=e.length?e:s,t=this._cache.all=t,t}getDecimalForValue(t){return(Ai(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return Ai(this._table,s*this._tableRange+this._minPos,!0)}}nt(mr,"id","timeseries"),nt(mr,"defaults",tn.defaults);function gu(i){let t;return{c(){t=ot("canvas")},m(e,s){ft(e,t,s),i[3](t)},p:yt,i:yt,o:yt,d(e){e&&ut(t),i[3](null)}}}function pu(i,t,e){Lt.register(Ri,Fn,Je,zi,co,fo,Bc,jc);let s,u,{data:g}=t;en(()=>{e(2,u=new Lt(s,{type:"line",data:{datasets:[{label:"Training Dataset",data:g}]},options:{responsive:!0,parsing:!1,scales:{x:{type:"linear",min:1,suggestedMax:10,title:{display:!0,text:"# of Iteration"}},y:{type:"linear",min:0,max:1,title:{display:!0,text:"Error Rate"}}},plugins:{title:{text:"Training Progress",display:!0},subtitle:{text:"Iteration: 0, Error Rate: 100%",display:!0}}}}))});function v(o){Zt[o?"unshift":"push"](()=>{s=o,e(0,s)})}return i.$$set=o=>{"data"in o&&e(1,g=o.data)},i.$$.update=()=>{var o,n,h;if(i.$$.dirty&6&&g&&u&&(o=u.data.datasets.at(0))!=null&&o.data){if(u.data.datasets.at(0).data=g,(h=(n=u.options.plugins)==null?void 0:n.subtitle)!=null&&h.text&&g.at(-1)){const{x:f,y:r}=g.at(-1),l=Math.trunc(r*100);e(2,u.options.plugins.subtitle.text=`Iteration: ${f}, Error Rate: ${l}%`,u)}u.update()}},[s,g,u,v]}class mu extends Ut{constructor(t){super(),Ht(this,t,pu,gu,Xt,{data:1})}}function vu(i){let t,e,s,u,g,v,o,n,h,f,r,l,a,d,p;return{c(){t=ot("div"),e=ot("button"),e.textContent="Start",u=bt(),g=ot("div"),v=ot("button"),v.textContent="Pause",n=bt(),h=ot("div"),f=ot("button"),f.textContent="Continue",r=bt(),l=ot("button"),l.textContent="Reset",ht(e,"class","primary"),ht(t,"style",s=Le(i[0]===i[1].None)),ht(v,"class","contrast"),ht(g,"style",o=Le(i[0]===i[1].Training)),ht(f,"class","primary"),ht(l,"class","secondary"),ht(h,"style",a=Le(i[0]===i[1].Stopped)),ht(h,"class","grid")},m(c,m){ft(c,t,m),rt(t,e),ft(c,u,m),ft(c,g,m),rt(g,v),ft(c,n,m),ft(c,h,m),rt(h,f),rt(h,r),rt(h,l),d||(p=[jt(e,"click",i[2]),jt(v,"click",i[3]),jt(f,"click",i[4]),jt(l,"click",i[5])],d=!0)},p(c,[m]){m&1&&s!==(s=Le(c[0]===c[1].None))&&ht(t,"style",s),m&1&&o!==(o=Le(c[0]===c[1].Training))&&ht(g,"style",o),m&1&&a!==(a=Le(c[0]===c[1].Stopped))&&ht(h,"style",a)},i:yt,o:yt,d(c){c&&(ut(t),ut(u),ut(g),ut(n),ut(h)),d=!1,ce(p)}}}function Le(i){return i?"":"display: none;"}function _u(i,t,e){const s=xr();var u=(f=>(f.None="none",f.Training="training",f.Stopped="stopped",f))(u||{});let g="none";function v(){e(0,g="training"),s("start",null)}function o(){e(0,g="stopped"),s("stop",null)}function n(){e(0,g="training"),s("continue",null)}function h(){e(0,g="none"),s("reset",null)}return[g,u,v,o,n,h]}class bu extends Ut{constructor(t){super(),Ht(this,t,_u,vu,Xt,{})}}function yu(i){if(i.__esModule)return i;var t=i.default;if(typeof t=="function"){var e=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(i).forEach(function(s){var u=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(e,s,u.get?u:{enumerable:!0,get:function(){return i[s]}})}),e}var po={};const xu={},Cu=Object.freeze(Object.defineProperty({__proto__:null,default:xu},Symbol.toStringTag,{value:"Module"})),bn=yu(Cu);(function(i){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"5.3.0"};if(i.fabric=t,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var e=bn,s=new e.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=s.document,t.jsdomImplForWrapper=bn.implForWrapper,t.nodeCanvas=bn.Canvas,t.window=s,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=t),function(){function o(a,d){if(this.__eventListeners[a]){var p=this.__eventListeners[a];d?p[p.indexOf(d)]=!1:t.util.array.fill(p,!1)}}function n(a,d){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var p in a)this.on(p,a[p]);else this.__eventListeners[a]||(this.__eventListeners[a]=[]),this.__eventListeners[a].push(d);return this}function h(a,d){var p=(function(){d.apply(this,arguments),this.off(a,p)}).bind(this);this.on(a,p)}function f(a,d){if(arguments.length===1)for(var p in a)h.call(this,p,a[p]);else h.call(this,a,d);return this}function r(a,d){if(!this.__eventListeners)return this;if(arguments.length===0)for(a in this.__eventListeners)o.call(this,a);else if(arguments.length===1&&typeof arguments[0]=="object")for(var p in a)o.call(this,p,a[p]);else o.call(this,a,d);return this}function l(a,d){if(!this.__eventListeners)return this;var p=this.__eventListeners[a];if(!p)return this;for(var c=0,m=p.length;c<m;c++)p[c]&&p[c].call(this,d||{});return this.__eventListeners[a]=p.filter(function(_){return _!==!1}),this}t.Observable={fire:l,on:n,once:f,off:r}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var o=0,n=arguments.length;o<n;o++)this._onObjectAdded(arguments[o]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(o,n,h){var f=this._objects;return h?f[n]=o:f.splice(n,0,o),this._onObjectAdded&&this._onObjectAdded(o),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var o=this._objects,n,h=!1,f=0,r=arguments.length;f<r;f++)n=o.indexOf(arguments[f]),n!==-1&&(h=!0,o.splice(n,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[f]));return this.renderOnAddRemove&&h&&this.requestRenderAll(),this},forEachObject:function(o,n){for(var h=this.getObjects(),f=0,r=h.length;f<r;f++)o.call(n,h[f],f,h);return this},getObjects:function(o){return typeof o>"u"?this._objects.concat():this._objects.filter(function(n){return n.type===o})},item:function(o){return this._objects[o]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(o,n){return this._objects.indexOf(o)>-1?!0:n?this._objects.some(function(h){return typeof h.contains=="function"&&h.contains(o,!0)}):!1},complexity:function(){return this._objects.reduce(function(o,n){return o+=n.complexity?n.complexity():0,o},0)}},t.CommonMethods={_setOptions:function(o){for(var n in o)this.set(n,o[n])},_initGradient:function(o,n){o&&o.colorStops&&!(o instanceof t.Gradient)&&this.set(n,new t.Gradient(o))},_initPattern:function(o,n,h){o&&o.source&&!(o instanceof t.Pattern)?this.set(n,new t.Pattern(o,h)):h&&h()},_setObject:function(o){for(var n in o)this._set(n,o[n])},set:function(o,n){return typeof o=="object"?this._setObject(o):this._set(o,n),this},_set:function(o,n){this[o]=n},toggle:function(o){var n=this.get(o);return typeof n=="boolean"&&this.set(o,!n),this},get:function(o){return this[o]}},function(o){var n=Math.sqrt,h=Math.atan2,f=Math.pow,r=Math.PI/180,l=Math.PI/2;t.util={cos:function(a){if(a===0)return 1;a<0&&(a=-a);var d=a/l;switch(d){case 1:case 3:return 0;case 2:return-1}return Math.cos(a)},sin:function(a){if(a===0)return 0;var d=a/l,p=1;switch(a<0&&(p=-1),d){case 1:return p;case 2:return 0;case 3:return-p}return Math.sin(a)},removeFromArray:function(a,d){var p=a.indexOf(d);return p!==-1&&a.splice(p,1),a},getRandomInt:function(a,d){return Math.floor(Math.random()*(d-a+1))+a},degreesToRadians:function(a){return a*r},radiansToDegrees:function(a){return a/r},rotatePoint:function(a,d,p){var c=new t.Point(a.x-d.x,a.y-d.y),m=t.util.rotateVector(c,p);return new t.Point(m.x,m.y).addEquals(d)},rotateVector:function(a,d){var p=t.util.sin(d),c=t.util.cos(d),m=a.x*c-a.y*p,_=a.x*p+a.y*c;return{x:m,y:_}},createVector:function(a,d){return new t.Point(d.x-a.x,d.y-a.y)},calcAngleBetweenVectors:function(a,d){return Math.acos((a.x*d.x+a.y*d.y)/(Math.hypot(a.x,a.y)*Math.hypot(d.x,d.y)))},getHatVector:function(a){return new t.Point(a.x,a.y).multiply(1/Math.hypot(a.x,a.y))},getBisector:function(a,d,p){var c=t.util.createVector(a,d),m=t.util.createVector(a,p),_=t.util.calcAngleBetweenVectors(c,m),b=t.util.calcAngleBetweenVectors(t.util.rotateVector(c,_),m),y=_*(b===0?1:-1)/2;return{vector:t.util.getHatVector(t.util.rotateVector(c,y)),angle:_}},projectStrokeOnPoints:function(a,d,p){var c=[],m=d.strokeWidth/2,_=d.strokeUniform?new t.Point(1/d.scaleX,1/d.scaleY):new t.Point(1,1),b=function(y){var x=m/Math.hypot(y.x,y.y);return new t.Point(y.x*x*_.x,y.y*x*_.y)};return a.length<=1||a.forEach(function(y,x){var C=new t.Point(y.x,y.y),T,k;x===0?(k=a[x+1],T=p?b(t.util.createVector(k,C)).addEquals(C):a[a.length-1]):x===a.length-1?(T=a[x-1],k=p?b(t.util.createVector(T,C)).addEquals(C):a[0]):(T=a[x-1],k=a[x+1]);var E=t.util.getBisector(C,T,k),z=E.vector,N=E.angle,$,J;if(d.strokeLineJoin==="miter"&&($=-m/Math.sin(N/2),J=new t.Point(z.x*$*_.x,z.y*$*_.y),Math.hypot(J.x,J.y)/m<=d.strokeMiterLimit)){c.push(C.add(J)),c.push(C.subtract(J));return}$=-m*Math.SQRT2,J=new t.Point(z.x*$*_.x,z.y*$*_.y),c.push(C.add(J)),c.push(C.subtract(J))}),c},transformPoint:function(a,d,p){return p?new t.Point(d[0]*a.x+d[2]*a.y,d[1]*a.x+d[3]*a.y):new t.Point(d[0]*a.x+d[2]*a.y+d[4],d[1]*a.x+d[3]*a.y+d[5])},makeBoundingBoxFromPoints:function(a,d){if(d)for(var p=0;p<a.length;p++)a[p]=t.util.transformPoint(a[p],d);var c=[a[0].x,a[1].x,a[2].x,a[3].x],m=t.util.array.min(c),_=t.util.array.max(c),b=_-m,y=[a[0].y,a[1].y,a[2].y,a[3].y],x=t.util.array.min(y),C=t.util.array.max(y),T=C-x;return{left:m,top:x,width:b,height:T}},invertTransform:function(a){var d=1/(a[0]*a[3]-a[1]*a[2]),p=[d*a[3],-d*a[1],-d*a[2],d*a[0]],c=t.util.transformPoint({x:a[4],y:a[5]},p,!0);return p[4]=-c.x,p[5]=-c.y,p},toFixed:function(a,d){return parseFloat(Number(a).toFixed(d))},parseUnit:function(a,d){var p=/\D{0,2}$/.exec(a),c=parseFloat(a);switch(d||(d=t.Text.DEFAULT_SVG_FONT_SIZE),p[0]){case"mm":return c*t.DPI/25.4;case"cm":return c*t.DPI/2.54;case"in":return c*t.DPI;case"pt":return c*t.DPI/72;case"pc":return c*t.DPI/72*12;case"em":return c*d;default:return c}},falseFunction:function(){return!1},getKlass:function(a,d){return a=t.util.string.camelize(a.charAt(0).toUpperCase()+a.slice(1)),t.util.resolveNamespace(d)[a]},getSvgAttributes:function(a){var d=["instantiated_by_use","style","id","class"];switch(a){case"linearGradient":d=d.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":d=d.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":d=d.concat(["offset","stop-color","stop-opacity"]);break}return d},resolveNamespace:function(a){if(!a)return t;var d=a.split("."),p=d.length,c,m=o||t.window;for(c=0;c<p;++c)m=m[d[c]];return m},loadImage:function(a,d,p,c){if(!a){d&&d.call(p,a);return}var m=t.util.createImage(),_=function(){d&&d.call(p,m,!1),m=m.onload=m.onerror=null};m.onload=_,m.onerror=function(){t.log("Error loading "+m.src),d&&d.call(p,null,!0),m=m.onload=m.onerror=null},a.indexOf("data")!==0&&c!==void 0&&c!==null&&(m.crossOrigin=c),a.substring(0,14)==="data:image/svg"&&(m.onload=null,t.util.loadImageInDom(m,_)),m.src=a},loadImageInDom:function(a,d){var p=t.document.createElement("div");p.style.width=p.style.height="1px",p.style.left=p.style.top="-100%",p.style.position="absolute",p.appendChild(a),t.document.querySelector("body").appendChild(p),a.onload=function(){d(),p.parentNode.removeChild(p),p=null}},enlivenObjects:function(a,d,p,c){a=a||[];var m=[],_=0,b=a.length;function y(){++_===b&&d&&d(m.filter(function(x){return x}))}if(!b){d&&d(m);return}a.forEach(function(x,C){if(!x||!x.type){y();return}var T=t.util.getKlass(x.type,p);T.fromObject(x,function(k,E){E||(m[C]=k),c&&c(x,k,E),y()})})},enlivenObjectEnlivables:function(a,d,p){var c=t.Object.ENLIVEN_PROPS.filter(function(m){return!!a[m]});t.util.enlivenObjects(c.map(function(m){return a[m]}),function(m){var _={};c.forEach(function(b,y){_[b]=m[y],d&&(d[b]=m[y])}),p&&p(_)})},enlivenPatterns:function(a,d){a=a||[];function p(){++m===_&&d&&d(c)}var c=[],m=0,_=a.length;if(!_){d&&d(c);return}a.forEach(function(b,y){b&&b.source?new t.Pattern(b,function(x){c[y]=x,p()}):(c[y]=b,p())})},groupSVGElements:function(a,d,p){var c;return a&&a.length===1?(typeof p<"u"&&(a[0].sourcePath=p),a[0]):(d&&(d.width&&d.height?d.centerPoint={x:d.width/2,y:d.height/2}:(delete d.width,delete d.height)),c=new t.Group(a,d),typeof p<"u"&&(c.sourcePath=p),c)},populateWithProperties:function(a,d,p){if(p&&Array.isArray(p))for(var c=0,m=p.length;c<m;c++)p[c]in a&&(d[p[c]]=a[p[c]])},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(a){var d=t.util.createCanvasElement();return d.width=a.width,d.height=a.height,d.getContext("2d").drawImage(a,0,0),d},toDataURL:function(a,d,p){return a.toDataURL("image/"+d,p)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(a,d,p){return[a[0]*d[0]+a[2]*d[1],a[1]*d[0]+a[3]*d[1],a[0]*d[2]+a[2]*d[3],a[1]*d[2]+a[3]*d[3],p?0:a[0]*d[4]+a[2]*d[5]+a[4],p?0:a[1]*d[4]+a[3]*d[5]+a[5]]},qrDecompose:function(a){var d=h(a[1],a[0]),p=f(a[0],2)+f(a[1],2),c=n(p),m=(a[0]*a[3]-a[2]*a[1])/c,_=h(a[0]*a[2]+a[1]*a[3],p);return{angle:d/r,scaleX:c,scaleY:m,skewX:_/r,skewY:0,translateX:a[4],translateY:a[5]}},calcRotateMatrix:function(a){if(!a.angle)return t.iMatrix.concat();var d=t.util.degreesToRadians(a.angle),p=t.util.cos(d),c=t.util.sin(d);return[p,c,-c,p,0,0]},calcDimensionsMatrix:function(a){var d=typeof a.scaleX>"u"?1:a.scaleX,p=typeof a.scaleY>"u"?1:a.scaleY,c=[a.flipX?-d:d,0,0,a.flipY?-p:p,0,0],m=t.util.multiplyTransformMatrices,_=t.util.degreesToRadians;return a.skewX&&(c=m(c,[1,0,Math.tan(_(a.skewX)),1],!0)),a.skewY&&(c=m(c,[1,Math.tan(_(a.skewY)),0,1],!0)),c},composeMatrix:function(a){var d=[1,0,0,1,a.translateX||0,a.translateY||0],p=t.util.multiplyTransformMatrices;return a.angle&&(d=p(d,t.util.calcRotateMatrix(a))),(a.scaleX!==1||a.scaleY!==1||a.skewX||a.skewY||a.flipX||a.flipY)&&(d=p(d,t.util.calcDimensionsMatrix(a))),d},resetObjectTransform:function(a){a.scaleX=1,a.scaleY=1,a.skewX=0,a.skewY=0,a.flipX=!1,a.flipY=!1,a.rotate(0)},saveObjectTransform:function(a){return{scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,angle:a.angle,left:a.left,flipX:a.flipX,flipY:a.flipY,top:a.top}},isTransparent:function(a,d,p,c){c>0&&(d>c?d-=c:d=0,p>c?p-=c:p=0);var m=!0,_,b,y=a.getImageData(d,p,c*2||1,c*2||1),x=y.data.length;for(_=3;_<x&&(b=y.data[_],m=b<=0,m!==!1);_+=4);return y=null,m},parsePreserveAspectRatioAttribute:function(a){var d="meet",p="Mid",c="Mid",m=a.split(" "),_;return m&&m.length&&(d=m.pop(),d!=="meet"&&d!=="slice"?(_=d,d="meet"):m.length&&(_=m.pop())),p=_!=="none"?_.slice(1,4):"none",c=_!=="none"?_.slice(5,8):"none",{meetOrSlice:d,alignX:p,alignY:c}},clearFabricFontCache:function(a){a=(a||"").toLowerCase(),a?t.charWidthsCache[a]&&delete t.charWidthsCache[a]:t.charWidthsCache={}},limitDimsByArea:function(a,d){var p=Math.sqrt(d*a),c=Math.floor(d/p);return{x:Math.floor(p),y:c}},capValue:function(a,d,p){return Math.max(a,Math.min(d,p))},findScaleToFit:function(a,d){return Math.min(d.width/a.width,d.height/a.height)},findScaleToCover:function(a,d){return Math.max(d.width/a.width,d.height/a.height)},matrixToSVG:function(a){return"matrix("+a.map(function(d){return t.util.toFixed(d,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(a,d){var p=t.util.invertTransform(d),c=t.util.multiplyTransformMatrices(p,a.calcOwnMatrix());t.util.applyTransformToObject(a,c)},addTransformToObject:function(a,d){t.util.applyTransformToObject(a,t.util.multiplyTransformMatrices(d,a.calcOwnMatrix()))},applyTransformToObject:function(a,d){var p=t.util.qrDecompose(d),c=new t.Point(p.translateX,p.translateY);a.flipX=!1,a.flipY=!1,a.set("scaleX",p.scaleX),a.set("scaleY",p.scaleY),a.skewX=p.skewX,a.skewY=p.skewY,a.angle=p.angle,a.setPositionByOrigin(c,"center","center")},sizeAfterTransform:function(a,d,p){var c=a/2,m=d/2,_=[{x:-c,y:-m},{x:c,y:-m},{x:-c,y:m},{x:c,y:m}],b=t.util.calcDimensionsMatrix(p),y=t.util.makeBoundingBoxFromPoints(_,b);return{x:y.width,y:y.height}},mergeClipPaths:function(a,d){var p=a,c=d;p.inverted&&!c.inverted&&(p=d,c=a),t.util.applyTransformToObject(c,t.util.multiplyTransformMatrices(t.util.invertTransform(p.calcTransformMatrix()),c.calcTransformMatrix()));var m=p.inverted&&c.inverted;return m&&(p.inverted=c.inverted=!1),new t.Group([p],{clipPath:c,inverted:m})},hasStyleChanged:function(a,d,p){return p=p||!1,a.fill!==d.fill||a.stroke!==d.stroke||a.strokeWidth!==d.strokeWidth||a.fontSize!==d.fontSize||a.fontFamily!==d.fontFamily||a.fontWeight!==d.fontWeight||a.fontStyle!==d.fontStyle||a.textBackgroundColor!==d.textBackgroundColor||a.deltaY!==d.deltaY||p&&(a.overline!==d.overline||a.underline!==d.underline||a.linethrough!==d.linethrough)},stylesToArray:function(p,d){for(var p=t.util.object.clone(p,!0),c=d.split(`
`),m=-1,_={},b=[],y=0;y<c.length;y++){if(!p[y]){m+=c[y].length;continue}for(var x=0;x<c[y].length;x++){m++;var C=p[y][x];if(C&&Object.keys(C).length>0){var T=t.util.hasStyleChanged(_,C,!0);T?b.push({start:m,end:m+1,style:C}):b[b.length-1].end++}_=C||{}}}return b},stylesFromArray:function(a,d){if(!Array.isArray(a))return a;for(var p=d.split(`
`),c=-1,m=0,_={},b=0;b<p.length;b++)for(var y=0;y<p[b].length;y++)c++,a[m]&&a[m].start<=c&&c<a[m].end&&(_[b]=_[b]||{},_[b][y]=Object.assign({},a[m].style),c===a[m].end-1&&m++);return _}}}(i),function(){var o=Array.prototype.join,n={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},h={m:"l",M:"L"};function f(w,M,D,P,R,O,S,A,L,W,I){var H=t.util.cos(w),q=t.util.sin(w),Z=t.util.cos(M),B=t.util.sin(M),F=D*R*Z-P*O*B+S,Y=P*R*Z+D*O*B+A,X=W+L*(-D*R*q-P*O*H),j=I+L*(-P*R*q+D*O*H),U=F+L*(D*R*B+P*O*Z),et=Y+L*(P*R*B-D*O*Z);return["C",X,j,U,et,F,Y]}function r(w,M,D,P,R,O,S){var A=Math.PI,L=S*A/180,W=t.util.sin(L),I=t.util.cos(L),H=0,q=0;D=Math.abs(D),P=Math.abs(P);var Z=-I*w*.5-W*M*.5,B=-I*M*.5+W*w*.5,F=D*D,Y=P*P,X=B*B,j=Z*Z,U=F*Y-F*X-Y*j,et=0;if(U<0){var lt=Math.sqrt(1-U/(F*Y));D*=lt,P*=lt}else et=(R===O?-1:1)*Math.sqrt(U/(F*X+Y*j));var st=et*D*B/P,V=-et*P*Z/D,at=I*st-W*V+w*.5,ct=W*st+I*V+M*.5,dt=l(1,0,(Z-st)/D,(B-V)/P),xt=l((Z-st)/D,(B-V)/P,(-Z-st)/D,(-B-V)/P);O===0&&xt>0?xt-=2*A:O===1&&xt<0&&(xt+=2*A);for(var mt=Math.ceil(Math.abs(xt/A*2)),Mt=[],Ot=xt/mt,be=8/3*Math.sin(Ot/4)*Math.sin(Ot/4)/Math.sin(Ot/2),Ne=dt+Ot,te=0;te<mt;te++)Mt[te]=f(dt,Ne,I,W,D,P,at,ct,be,H,q),H=Mt[te][5],q=Mt[te][6],dt=Ne,Ne+=Ot;return Mt}function l(w,M,D,P){var R=Math.atan2(M,w),O=Math.atan2(P,D);return O>=R?O-R:2*Math.PI-(R-O)}function a(w,M,D,P,R,O,S,A){var L;if(t.cachesBoundsOfCurve&&(L=o.call(arguments),t.boundsOfCurveCache[L]))return t.boundsOfCurveCache[L];var W=Math.sqrt,I=Math.min,H=Math.max,q=Math.abs,Z=[],B=[[],[]],F,Y,X,j,U,et,lt,st;Y=6*w-12*D+6*R,F=-3*w+9*D-9*R+3*S,X=3*D-3*w;for(var V=0;V<2;++V){if(V>0&&(Y=6*M-12*P+6*O,F=-3*M+9*P-9*O+3*A,X=3*P-3*M),q(F)<1e-12){if(q(Y)<1e-12)continue;j=-X/Y,0<j&&j<1&&Z.push(j);continue}lt=Y*Y-4*X*F,!(lt<0)&&(st=W(lt),U=(-Y+st)/(2*F),0<U&&U<1&&Z.push(U),et=(-Y-st)/(2*F),0<et&&et<1&&Z.push(et))}for(var at,ct,dt=Z.length,xt=dt,mt;dt--;)j=Z[dt],mt=1-j,at=mt*mt*mt*w+3*mt*mt*j*D+3*mt*j*j*R+j*j*j*S,B[0][dt]=at,ct=mt*mt*mt*M+3*mt*mt*j*P+3*mt*j*j*O+j*j*j*A,B[1][dt]=ct;B[0][xt]=w,B[1][xt]=M,B[0][xt+1]=S,B[1][xt+1]=A;var Mt=[{x:I.apply(null,B[0]),y:I.apply(null,B[1])},{x:H.apply(null,B[0]),y:H.apply(null,B[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[L]=Mt),Mt}function d(w,M,D){for(var P=D[1],R=D[2],O=D[3],S=D[4],A=D[5],L=D[6],W=D[7],I=r(L-w,W-M,P,R,S,A,O),H=0,q=I.length;H<q;H++)I[H][1]+=w,I[H][2]+=M,I[H][3]+=w,I[H][4]+=M,I[H][5]+=w,I[H][6]+=M;return I}function p(w){var M=0,D=0,P=w.length,R=0,O=0,S,A,L,W=[],I,H,q;for(A=0;A<P;++A){switch(L=!1,S=w[A].slice(0),S[0]){case"l":S[0]="L",S[1]+=M,S[2]+=D;case"L":M=S[1],D=S[2];break;case"h":S[1]+=M;case"H":S[0]="L",S[2]=D,M=S[1];break;case"v":S[1]+=D;case"V":S[0]="L",D=S[1],S[1]=M,S[2]=D;break;case"m":S[0]="M",S[1]+=M,S[2]+=D;case"M":M=S[1],D=S[2],R=S[1],O=S[2];break;case"c":S[0]="C",S[1]+=M,S[2]+=D,S[3]+=M,S[4]+=D,S[5]+=M,S[6]+=D;case"C":H=S[3],q=S[4],M=S[5],D=S[6];break;case"s":S[0]="S",S[1]+=M,S[2]+=D,S[3]+=M,S[4]+=D;case"S":I==="C"?(H=2*M-H,q=2*D-q):(H=M,q=D),M=S[3],D=S[4],S[0]="C",S[5]=S[3],S[6]=S[4],S[3]=S[1],S[4]=S[2],S[1]=H,S[2]=q,H=S[3],q=S[4];break;case"q":S[0]="Q",S[1]+=M,S[2]+=D,S[3]+=M,S[4]+=D;case"Q":H=S[1],q=S[2],M=S[3],D=S[4];break;case"t":S[0]="T",S[1]+=M,S[2]+=D;case"T":I==="Q"?(H=2*M-H,q=2*D-q):(H=M,q=D),S[0]="Q",M=S[1],D=S[2],S[1]=H,S[2]=q,S[3]=M,S[4]=D;break;case"a":S[0]="A",S[6]+=M,S[7]+=D;case"A":L=!0,W=W.concat(d(M,D,S)),M=S[6],D=S[7];break;case"z":case"Z":M=R,D=O;break}L||W.push(S),I=S[0]}return W}function c(w,M,D,P){return Math.sqrt((D-w)*(D-w)+(P-M)*(P-M))}function m(w){return w*w*w}function _(w){return 3*w*w*(1-w)}function b(w){return 3*w*(1-w)*(1-w)}function y(w){return(1-w)*(1-w)*(1-w)}function x(w,M,D,P,R,O,S,A){return function(L){var W=m(L),I=_(L),H=b(L),q=y(L);return{x:S*W+R*I+D*H+w*q,y:A*W+O*I+P*H+M*q}}}function C(w,M,D,P,R,O,S,A){return function(L){var W=1-L,I=3*W*W*(D-w)+6*W*L*(R-D)+3*L*L*(S-R),H=3*W*W*(P-M)+6*W*L*(O-P)+3*L*L*(A-O);return Math.atan2(H,I)}}function T(w){return w*w}function k(w){return 2*w*(1-w)}function E(w){return(1-w)*(1-w)}function z(w,M,D,P,R,O){return function(S){var A=T(S),L=k(S),W=E(S);return{x:R*A+D*L+w*W,y:O*A+P*L+M*W}}}function N(w,M,D,P,R,O){return function(S){var A=1-S,L=2*A*(D-w)+2*S*(R-D),W=2*A*(P-M)+2*S*(O-P);return Math.atan2(W,L)}}function $(w,M,D){var P={x:M,y:D},R,O=0,S;for(S=1;S<=100;S+=1)R=w(S/100),O+=c(P.x,P.y,R.x,R.y),P=R;return O}function J(w,M){for(var D=0,P=0,R=w.iterator,O={x:w.x,y:w.y},S,A,L=.01,W=w.angleFinder,I;P<M&&L>1e-4;)S=R(D),I=D,A=c(O.x,O.y,S.x,S.y),A+P>M?(D-=L,L/=2):(O=S,D+=L,P+=A);return S.angle=W(I),S}function K(w){for(var M=0,D=w.length,P,R=0,O=0,S=0,A=0,L=[],W,I,H,q=0;q<D;q++){switch(P=w[q],I={x:R,y:O,command:P[0]},P[0]){case"M":I.length=0,S=R=P[1],A=O=P[2];break;case"L":I.length=c(R,O,P[1],P[2]),R=P[1],O=P[2];break;case"C":W=x(R,O,P[1],P[2],P[3],P[4],P[5],P[6]),H=C(R,O,P[1],P[2],P[3],P[4],P[5],P[6]),I.iterator=W,I.angleFinder=H,I.length=$(W,R,O),R=P[5],O=P[6];break;case"Q":W=z(R,O,P[1],P[2],P[3],P[4]),H=N(R,O,P[1],P[2],P[3],P[4]),I.iterator=W,I.angleFinder=H,I.length=$(W,R,O),R=P[3],O=P[4];break;case"Z":case"z":I.destX=S,I.destY=A,I.length=c(R,O,S,A),R=S,O=A;break}M+=I.length,L.push(I)}return L.push({length:M,x:R,y:O}),L}function G(w,M,D){D||(D=K(w));for(var P=0;M-D[P].length>0&&P<D.length-2;)M-=D[P].length,P++;var R=D[P],O=M/R.length,S=R.command,A=w[P],L;switch(S){case"M":return{x:R.x,y:R.y,angle:0};case"Z":case"z":return L=new t.Point(R.x,R.y).lerp(new t.Point(R.destX,R.destY),O),L.angle=Math.atan2(R.destY-R.y,R.destX-R.x),L;case"L":return L=new t.Point(R.x,R.y).lerp(new t.Point(A[1],A[2]),O),L.angle=Math.atan2(A[2]-R.y,A[1]-R.x),L;case"C":return J(R,M);case"Q":return J(R,M)}}function Q(w){var M=[],D=[],P,R,O=t.rePathCommand,S="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",A="("+S+")"+t.commaWsp,L="([01])"+t.commaWsp+"?",W=A+"?"+A+"?"+A+L+L+A+"?("+S+")",I=new RegExp(W,"g"),H,q,Z;if(!w||!w.match)return M;Z=w.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var B=0,F,Y=Z.length;B<Y;B++){P=Z[B],q=P.slice(1).trim(),D.length=0;var X=P.charAt(0);if(F=[X],X.toLowerCase()==="a")for(var j;j=I.exec(q);)for(var U=1;U<j.length;U++)D.push(j[U]);else for(;H=O.exec(q);)D.push(H[0]);for(var U=0,et=D.length;U<et;U++)R=parseFloat(D[U]),isNaN(R)||F.push(R);var lt=n[X.toLowerCase()],st=h[X]||X;if(F.length-1>lt)for(var V=1,at=F.length;V<at;V+=lt)M.push([X].concat(F.slice(V,V+lt))),X=st;else M.push(F)}return M}function tt(w,M){var D=[],P,R=new t.Point(w[0].x,w[0].y),O=new t.Point(w[1].x,w[1].y),S=w.length,A=1,L=0,W=S>2;for(M=M||0,W&&(A=w[2].x<O.x?-1:w[2].x===O.x?0:1,L=w[2].y<O.y?-1:w[2].y===O.y?0:1),D.push(["M",R.x-A*M,R.y-L*M]),P=1;P<S;P++){if(!R.eq(O)){var I=R.midPointFrom(O);D.push(["Q",R.x,R.y,I.x,I.y])}R=w[P],P+1<w.length&&(O=w[P+1])}return W&&(A=R.x>w[P-2].x?1:R.x===w[P-2].x?0:-1,L=R.y>w[P-2].y?1:R.y===w[P-2].y?0:-1),D.push(["L",R.x+A*M,R.y+L*M]),D}function it(w,M,D){return D&&(M=t.util.multiplyTransformMatrices(M,[1,0,0,1,-D.x,-D.y])),w.map(function(P){for(var R=P.slice(0),O={},S=1;S<P.length-1;S+=2)O.x=P[S],O.y=P[S+1],O=t.util.transformPoint(O,M),R[S]=O.x,R[S+1]=O.y;return R})}t.util.joinPath=function(w){return w.map(function(M){return M.join(" ")}).join(" ")},t.util.parsePath=Q,t.util.makePathSimpler=p,t.util.getSmoothPathFromPoints=tt,t.util.getPathSegmentsInfo=K,t.util.getBoundsOfCurve=a,t.util.getPointOnPath=G,t.util.transformPath=it}(),function(){var o=Array.prototype.slice;function n(a,d){for(var p=o.call(arguments,2),c=[],m=0,_=a.length;m<_;m++)c[m]=p.length?a[m][d].apply(a[m],p):a[m][d].call(a[m]);return c}function h(a,d){return l(a,d,function(p,c){return p>=c})}function f(a,d){return l(a,d,function(p,c){return p<c})}function r(a,d){for(var p=a.length;p--;)a[p]=d;return a}function l(a,d,p){if(!(!a||a.length===0)){var c=a.length-1,m=d?a[c][d]:a[c];if(d)for(;c--;)p(a[c][d],m)&&(m=a[c][d]);else for(;c--;)p(a[c],m)&&(m=a[c]);return m}}t.util.array={fill:r,invoke:n,min:f,max:h}}(),function(){function o(h,f,r){if(r)if(!t.isLikelyNode&&f instanceof Element)h=f;else if(f instanceof Array){h=[];for(var l=0,a=f.length;l<a;l++)h[l]=o({},f[l],r)}else if(f&&typeof f=="object")for(var d in f)d==="canvas"||d==="group"?h[d]=null:f.hasOwnProperty(d)&&(h[d]=o({},f[d],r));else h=f;else for(var d in f)h[d]=f[d];return h}function n(h,f){return o({},h,f)}t.util.object={extend:o,clone:n},t.util.object.extend(t.util,t.Observable)}(),function(){function o(l){return l.replace(/-+(.)?/g,function(a,d){return d?d.toUpperCase():""})}function n(l,a){return l.charAt(0).toUpperCase()+(a?l.slice(1):l.slice(1).toLowerCase())}function h(l){return l.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function f(l){var a=0,d,p=[];for(a=0,d;a<l.length;a++)(d=r(l,a))!==!1&&p.push(d);return p}function r(l,a){var d=l.charCodeAt(a);if(isNaN(d))return"";if(d<55296||d>57343)return l.charAt(a);if(55296<=d&&d<=56319){if(l.length<=a+1)throw"High surrogate without following low surrogate";var p=l.charCodeAt(a+1);if(56320>p||p>57343)throw"High surrogate without following low surrogate";return l.charAt(a)+l.charAt(a+1)}if(a===0)throw"Low surrogate without preceding high surrogate";var c=l.charCodeAt(a-1);if(55296>c||c>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:o,capitalize:n,escapeXml:h,graphemeSplit:f}}(),function(){var o=Array.prototype.slice,n=function(){},h=function(){for(var d in{toString:1})if(d==="toString")return!1;return!0}(),f=function(d,p,c){for(var m in p)m in d.prototype&&typeof d.prototype[m]=="function"&&(p[m]+"").indexOf("callSuper")>-1?d.prototype[m]=function(_){return function(){var b=this.constructor.superclass;this.constructor.superclass=c;var y=p[_].apply(this,arguments);if(this.constructor.superclass=b,_!=="initialize")return y}}(m):d.prototype[m]=p[m],h&&(p.toString!==Object.prototype.toString&&(d.prototype.toString=p.toString),p.valueOf!==Object.prototype.valueOf&&(d.prototype.valueOf=p.valueOf))};function r(){}function l(d){for(var p=null,c=this;c.constructor.superclass;){var m=c.constructor.superclass.prototype[d];if(c[d]!==m){p=m;break}c=c.constructor.superclass.prototype}return p?arguments.length>1?p.apply(this,o.call(arguments,1)):p.call(this):console.log("tried to callSuper "+d+", method not found in prototype chain",this)}function a(){var d=null,p=o.call(arguments,0);typeof p[0]=="function"&&(d=p.shift());function c(){this.initialize.apply(this,arguments)}c.superclass=d,c.subclasses=[],d&&(r.prototype=d.prototype,c.prototype=new r,d.subclasses.push(c));for(var m=0,_=p.length;m<_;m++)f(c,p[m],d);return c.prototype.initialize||(c.prototype.initialize=n),c.prototype.constructor=c,c.prototype.callSuper=l,c}t.util.createClass=a}(),function(){var o=!!t.document.createElement("div").attachEvent,n=["touchstart","touchmove","touchend"];t.util.addListener=function(f,r,l,a){f&&f.addEventListener(r,l,o?!1:a)},t.util.removeListener=function(f,r,l,a){f&&f.removeEventListener(r,l,o?!1:a)};function h(f){var r=f.changedTouches;return r&&r[0]?r[0]:f}t.util.getPointer=function(f){var r=f.target,l=t.util.getScrollLeftTop(r),a=h(f);return{x:a.clientX+l.left,y:a.clientY+l.top}},t.util.isTouchEvent=function(f){return n.indexOf(f.type)>-1||f.pointerType==="touch"}}(),function(){function o(a,d){var p=a.style;if(!p)return a;if(typeof d=="string")return a.style.cssText+=";"+d,d.indexOf("opacity")>-1?l(a,d.match(/opacity:\s*(\d?\.?\d*)/)[1]):a;for(var c in d)if(c==="opacity")l(a,d[c]);else{var m=c==="float"||c==="cssFloat"?typeof p.styleFloat>"u"?"cssFloat":"styleFloat":c;p.setProperty(m,d[c])}return a}var n=t.document.createElement("div"),h=typeof n.style.opacity=="string",f=typeof n.style.filter=="string",r=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,l=function(a){return a};h?l=function(a,d){return a.style.opacity=d,a}:f&&(l=function(a,d){var p=a.style;return a.currentStyle&&!a.currentStyle.hasLayout&&(p.zoom=1),r.test(p.filter)?(d=d>=.9999?"":"alpha(opacity="+d*100+")",p.filter=p.filter.replace(r,d)):p.filter+=" alpha(opacity="+d*100+")",a}),t.util.setStyle=o}(),function(){var o=Array.prototype.slice;function n(y){return typeof y=="string"?t.document.getElementById(y):y}var h,f=function(y){return o.call(y,0)};try{h=f(t.document.childNodes)instanceof Array}catch{}h||(f=function(y){for(var x=new Array(y.length),C=y.length;C--;)x[C]=y[C];return x});function r(y,x){var C=t.document.createElement(y);for(var T in x)T==="class"?C.className=x[T]:T==="for"?C.htmlFor=x[T]:C.setAttribute(T,x[T]);return C}function l(y,x){y&&(" "+y.className+" ").indexOf(" "+x+" ")===-1&&(y.className+=(y.className?" ":"")+x)}function a(y,x,C){return typeof x=="string"&&(x=r(x,C)),y.parentNode&&y.parentNode.replaceChild(x,y),x.appendChild(y),x}function d(y){for(var x=0,C=0,T=t.document.documentElement,k=t.document.body||{scrollLeft:0,scrollTop:0};y&&(y.parentNode||y.host)&&(y=y.parentNode||y.host,y===t.document?(x=k.scrollLeft||T.scrollLeft||0,C=k.scrollTop||T.scrollTop||0):(x+=y.scrollLeft||0,C+=y.scrollTop||0),!(y.nodeType===1&&y.style.position==="fixed")););return{left:x,top:C}}function p(y){var x,C=y&&y.ownerDocument,T={left:0,top:0},k={left:0,top:0},E,z={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!C)return k;for(var N in z)k[z[N]]+=parseInt(c(y,N),10)||0;return x=C.documentElement,typeof y.getBoundingClientRect<"u"&&(T=y.getBoundingClientRect()),E=d(y),{left:T.left+E.left-(x.clientLeft||0)+k.left,top:T.top+E.top-(x.clientTop||0)+k.top}}var c;t.document.defaultView&&t.document.defaultView.getComputedStyle?c=function(y,x){var C=t.document.defaultView.getComputedStyle(y,null);return C?C[x]:void 0}:c=function(y,x){var C=y.style[x];return!C&&y.currentStyle&&(C=y.currentStyle[x]),C},function(){var y=t.document.documentElement.style,x="userSelect"in y?"userSelect":"MozUserSelect"in y?"MozUserSelect":"WebkitUserSelect"in y?"WebkitUserSelect":"KhtmlUserSelect"in y?"KhtmlUserSelect":"";function C(k){return typeof k.onselectstart<"u"&&(k.onselectstart=t.util.falseFunction),x?k.style[x]="none":typeof k.unselectable=="string"&&(k.unselectable="on"),k}function T(k){return typeof k.onselectstart<"u"&&(k.onselectstart=null),x?k.style[x]="":typeof k.unselectable=="string"&&(k.unselectable=""),k}t.util.makeElementUnselectable=C,t.util.makeElementSelectable=T}();function m(y){var x=t.jsdomImplForWrapper(y);return x._canvas||x._image}function _(y){if(t.isLikelyNode){var x=t.jsdomImplForWrapper(y);x&&(x._image=null,x._canvas=null,x._currentSrc=null,x._attributes=null,x._classList=null)}}function b(y,x){y.imageSmoothingEnabled=y.imageSmoothingEnabled||y.webkitImageSmoothingEnabled||y.mozImageSmoothingEnabled||y.msImageSmoothingEnabled||y.oImageSmoothingEnabled,y.imageSmoothingEnabled=x}t.util.setImageSmoothing=b,t.util.getById=n,t.util.toArray=f,t.util.addClass=l,t.util.makeElement=r,t.util.wrapElement=a,t.util.getScrollLeftTop=d,t.util.getElementOffset=p,t.util.getNodeCanvas=m,t.util.cleanUpJsdomNode=_}(),function(){function o(f,r){return f+(/\?/.test(f)?"&":"?")+r}function n(){}function h(f,r){r||(r={});var l=r.method?r.method.toUpperCase():"GET",a=r.onComplete||function(){},d=new t.window.XMLHttpRequest,p=r.body||r.parameters;return d.onreadystatechange=function(){d.readyState===4&&(a(d),d.onreadystatechange=n)},l==="GET"&&(p=null,typeof r.parameters=="string"&&(f=o(f,r.parameters))),d.open(l,f,!0),(l==="POST"||l==="PUT")&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.send(p),d}t.util.request=h}(),t.log=console.log,t.warn=console.warn,function(){var o=t.util.object.extend,n=t.util.object.clone,h=[];t.util.object.extend(h,{cancelAll:function(){var m=this.splice(0);return m.forEach(function(_){_.cancel()}),m},cancelByCanvas:function(m){if(!m)return[];var _=this.filter(function(b){return typeof b.target=="object"&&b.target.canvas===m});return _.forEach(function(b){b.cancel()}),_},cancelByTarget:function(m){var _=this.findAnimationsByTarget(m);return _.forEach(function(b){b.cancel()}),_},findAnimationIndex:function(m){return this.indexOf(this.findAnimation(m))},findAnimation:function(m){return this.find(function(_){return _.cancel===m})},findAnimationsByTarget:function(m){return m?this.filter(function(_){return _.target===m}):[]}});function f(){return!1}function r(m,_,b,y){return-b*Math.cos(m/y*(Math.PI/2))+b+_}function l(m){m||(m={});var _=!1,b,y=function(){var x=t.runningAnimations.indexOf(b);return x>-1&&t.runningAnimations.splice(x,1)[0]};return b=o(n(m),{cancel:function(){return _=!0,y()},currentValue:"startValue"in m?m.startValue:0,completionRate:0,durationRate:0}),t.runningAnimations.push(b),p(function(x){var C=x||+new Date,T=m.duration||500,k=C+T,E,z=m.onChange||f,N=m.abort||f,$=m.onComplete||f,J=m.easing||r,K="startValue"in m?m.startValue.length>0:!1,G="startValue"in m?m.startValue:0,Q="endValue"in m?m.endValue:100,tt=m.byValue||(K?G.map(function(it,w){return Q[w]-G[w]}):Q-G);m.onStart&&m.onStart(),function it(w){E=w||+new Date;var M=E>k?T:E-C,D=M/T,P=K?G.map(function(O,S){return J(M,G[S],tt[S],T)}):J(M,G,tt,T),R=Math.abs(K?(P[0]-G[0])/tt[0]:(P-G)/tt);if(b.currentValue=K?P.slice():P,b.completionRate=R,b.durationRate=D,!_){if(N(P,R,D)){y();return}if(E>k){b.currentValue=K?Q.slice():Q,b.completionRate=1,b.durationRate=1,z(K?Q.slice():Q,1,1),$(Q,1,1),y();return}else z(P,R,D),p(it)}}(C)}),b.cancel}var a=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(m){return t.window.setTimeout(m,1e3/60)},d=t.window.cancelAnimationFrame||t.window.clearTimeout;function p(){return a.apply(t.window,arguments)}function c(){return d.apply(t.window,arguments)}t.util.animate=l,t.util.requestAnimFrame=p,t.util.cancelAnimFrame=c,t.runningAnimations=h}(),function(){function o(h,f,r){var l="rgba("+parseInt(h[0]+r*(f[0]-h[0]),10)+","+parseInt(h[1]+r*(f[1]-h[1]),10)+","+parseInt(h[2]+r*(f[2]-h[2]),10);return l+=","+(h&&f?parseFloat(h[3]+r*(f[3]-h[3])):1),l+=")",l}function n(h,f,r,l){var a=new t.Color(h).getSource(),d=new t.Color(f).getSource(),p=l.onComplete,c=l.onChange;return l=l||{},t.util.animate(t.util.object.extend(l,{duration:r||500,startValue:a,endValue:d,byValue:d,easing:function(m,_,b,y){var x=l.colorEasing?l.colorEasing(m,y):1-Math.cos(m/y*(Math.PI/2));return o(_,b,x)},onComplete:function(m,_,b){if(p)return p(o(d,d,0),_,b)},onChange:function(m,_,b){if(c){if(Array.isArray(m))return c(o(m,m,0),_,b);c(m,_,b)}}}))}t.util.animateColor=n}(),function(){function o(w,M,D,P){return w<Math.abs(M)?(w=M,P=D/4):M===0&&w===0?P=D/(2*Math.PI)*Math.asin(1):P=D/(2*Math.PI)*Math.asin(M/w),{a:w,c:M,p:D,s:P}}function n(w,M,D){return w.a*Math.pow(2,10*(M-=1))*Math.sin((M*D-w.s)*(2*Math.PI)/w.p)}function h(w,M,D,P){return D*((w=w/P-1)*w*w+1)+M}function f(w,M,D,P){return w/=P/2,w<1?D/2*w*w*w+M:D/2*((w-=2)*w*w+2)+M}function r(w,M,D,P){return D*(w/=P)*w*w*w+M}function l(w,M,D,P){return-D*((w=w/P-1)*w*w*w-1)+M}function a(w,M,D,P){return w/=P/2,w<1?D/2*w*w*w*w+M:-D/2*((w-=2)*w*w*w-2)+M}function d(w,M,D,P){return D*(w/=P)*w*w*w*w+M}function p(w,M,D,P){return D*((w=w/P-1)*w*w*w*w+1)+M}function c(w,M,D,P){return w/=P/2,w<1?D/2*w*w*w*w*w+M:D/2*((w-=2)*w*w*w*w+2)+M}function m(w,M,D,P){return-D*Math.cos(w/P*(Math.PI/2))+D+M}function _(w,M,D,P){return D*Math.sin(w/P*(Math.PI/2))+M}function b(w,M,D,P){return-D/2*(Math.cos(Math.PI*w/P)-1)+M}function y(w,M,D,P){return w===0?M:D*Math.pow(2,10*(w/P-1))+M}function x(w,M,D,P){return w===P?M+D:D*(-Math.pow(2,-10*w/P)+1)+M}function C(w,M,D,P){return w===0?M:w===P?M+D:(w/=P/2,w<1?D/2*Math.pow(2,10*(w-1))+M:D/2*(-Math.pow(2,-10*--w)+2)+M)}function T(w,M,D,P){return-D*(Math.sqrt(1-(w/=P)*w)-1)+M}function k(w,M,D,P){return D*Math.sqrt(1-(w=w/P-1)*w)+M}function E(w,M,D,P){return w/=P/2,w<1?-D/2*(Math.sqrt(1-w*w)-1)+M:D/2*(Math.sqrt(1-(w-=2)*w)+1)+M}function z(w,M,D,P){var R=1.70158,O=0,S=D;if(w===0)return M;if(w/=P,w===1)return M+D;O||(O=P*.3);var A=o(S,D,O,R);return-n(A,w,P)+M}function N(w,M,D,P){var R=1.70158,O=0,S=D;if(w===0)return M;if(w/=P,w===1)return M+D;O||(O=P*.3);var A=o(S,D,O,R);return A.a*Math.pow(2,-10*w)*Math.sin((w*P-A.s)*(2*Math.PI)/A.p)+A.c+M}function $(w,M,D,P){var R=1.70158,O=0,S=D;if(w===0)return M;if(w/=P/2,w===2)return M+D;O||(O=P*(.3*1.5));var A=o(S,D,O,R);return w<1?-.5*n(A,w,P)+M:A.a*Math.pow(2,-10*(w-=1))*Math.sin((w*P-A.s)*(2*Math.PI)/A.p)*.5+A.c+M}function J(w,M,D,P,R){return R===void 0&&(R=1.70158),D*(w/=P)*w*((R+1)*w-R)+M}function K(w,M,D,P,R){return R===void 0&&(R=1.70158),D*((w=w/P-1)*w*((R+1)*w+R)+1)+M}function G(w,M,D,P,R){return R===void 0&&(R=1.70158),w/=P/2,w<1?D/2*(w*w*(((R*=1.525)+1)*w-R))+M:D/2*((w-=2)*w*(((R*=1.525)+1)*w+R)+2)+M}function Q(w,M,D,P){return D-tt(P-w,0,D,P)+M}function tt(w,M,D,P){return(w/=P)<1/2.75?D*(7.5625*w*w)+M:w<2/2.75?D*(7.5625*(w-=1.5/2.75)*w+.75)+M:w<2.5/2.75?D*(7.5625*(w-=2.25/2.75)*w+.9375)+M:D*(7.5625*(w-=2.625/2.75)*w+.984375)+M}function it(w,M,D,P){return w<P/2?Q(w*2,0,D,P)*.5+M:tt(w*2-P,0,D,P)*.5+D*.5+M}t.util.ease={easeInQuad:function(w,M,D,P){return D*(w/=P)*w+M},easeOutQuad:function(w,M,D,P){return-D*(w/=P)*(w-2)+M},easeInOutQuad:function(w,M,D,P){return w/=P/2,w<1?D/2*w*w+M:-D/2*(--w*(w-2)-1)+M},easeInCubic:function(w,M,D,P){return D*(w/=P)*w*w+M},easeOutCubic:h,easeInOutCubic:f,easeInQuart:r,easeOutQuart:l,easeInOutQuart:a,easeInQuint:d,easeOutQuint:p,easeInOutQuint:c,easeInSine:m,easeOutSine:_,easeInOutSine:b,easeInExpo:y,easeOutExpo:x,easeInOutExpo:C,easeInCirc:T,easeOutCirc:k,easeInOutCirc:E,easeInElastic:z,easeOutElastic:N,easeInOutElastic:$,easeInBack:J,easeOutBack:K,easeInOutBack:G,easeInBounce:Q,easeOutBounce:tt,easeInOutBounce:it}}(),function(o){var n=o.fabric||(o.fabric={}),h=n.util.object.extend,f=n.util.object.clone,r=n.util.toFixed,l=n.util.parseUnit,a=n.util.multiplyTransformMatrices,d=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],p=["symbol","image","marker","pattern","view","svg"],c=["pattern","defs","symbol","metadata","clipPath","mask","desc"],m=["symbol","g","a","svg","clipPath","defs"],_={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},b={stroke:"strokeOpacity",fill:"fillOpacity"},y="font-size",x="clip-path";n.svgValidTagNamesRegEx=k(d),n.svgViewBoxElementsRegEx=k(p),n.svgInvalidAncestorsRegEx=k(c),n.svgValidParentsRegEx=k(m),n.cssRules={},n.gradientDefs={},n.clipPaths={};function C(O){return O in _?_[O]:O}function T(O,S,A,L){var W=Array.isArray(S),I;if((O==="fill"||O==="stroke")&&S==="none")S="";else{if(O==="strokeUniform")return S==="non-scaling-stroke";if(O==="strokeDashArray")S==="none"?S=null:S=S.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(O==="transformMatrix")A&&A.transformMatrix?S=a(A.transformMatrix,n.parseTransformAttribute(S)):S=n.parseTransformAttribute(S);else if(O==="visible")S=S!=="none"&&S!=="hidden",A&&A.visible===!1&&(S=!1);else if(O==="opacity")S=parseFloat(S),A&&typeof A.opacity<"u"&&(S*=A.opacity);else if(O==="textAnchor")S=S==="start"?"left":S==="end"?"right":"center";else if(O==="charSpacing")I=l(S,L)/L*1e3;else if(O==="paintFirst"){var H=S.indexOf("fill"),q=S.indexOf("stroke"),S="fill";(H>-1&&q>-1&&q<H||H===-1&&q>-1)&&(S="stroke")}else{if(O==="href"||O==="xlink:href"||O==="font")return S;if(O==="imageSmoothing")return S==="optimizeQuality";I=W?S.map(l):l(S,L)}}return!W&&isNaN(I)?S:I}function k(O){return new RegExp("^("+O.join("|")+")\\b","i")}function E(O){for(var S in b)if(!(typeof O[b[S]]>"u"||O[S]==="")){if(typeof O[S]>"u"){if(!n.Object.prototype[S])continue;O[S]=n.Object.prototype[S]}if(O[S].indexOf("url(")!==0){var A=new n.Color(O[S]);O[S]=A.setAlpha(r(A.getAlpha()*O[b[S]],2)).toRgba()}}return O}function z(O,S){var A,L=[],W,I,H;for(I=0,H=S.length;I<H;I++)A=S[I],W=O.getElementsByTagName(A),L=L.concat(Array.prototype.slice.call(W));return L}n.parseTransformAttribute=function(){function O(V,at){var ct=n.util.cos(at[0]),dt=n.util.sin(at[0]),xt=0,mt=0;at.length===3&&(xt=at[1],mt=at[2]),V[0]=ct,V[1]=dt,V[2]=-dt,V[3]=ct,V[4]=xt-(ct*xt-dt*mt),V[5]=mt-(dt*xt+ct*mt)}function S(V,at){var ct=at[0],dt=at.length===2?at[1]:at[0];V[0]=ct,V[3]=dt}function A(V,at,ct){V[ct]=Math.tan(n.util.degreesToRadians(at[0]))}function L(V,at){V[4]=at[0],at.length===2&&(V[5]=at[1])}var W=n.iMatrix,I=n.reNum,H=n.commaWsp,q="(?:(skewX)\\s*\\(\\s*("+I+")\\s*\\))",Z="(?:(skewY)\\s*\\(\\s*("+I+")\\s*\\))",B="(?:(rotate)\\s*\\(\\s*("+I+")(?:"+H+"("+I+")"+H+"("+I+"))?\\s*\\))",F="(?:(scale)\\s*\\(\\s*("+I+")(?:"+H+"("+I+"))?\\s*\\))",Y="(?:(translate)\\s*\\(\\s*("+I+")(?:"+H+"("+I+"))?\\s*\\))",X="(?:(matrix)\\s*\\(\\s*("+I+")"+H+"("+I+")"+H+"("+I+")"+H+"("+I+")"+H+"("+I+")"+H+"("+I+")\\s*\\))",j="(?:"+X+"|"+Y+"|"+F+"|"+B+"|"+q+"|"+Z+")",U="(?:"+j+"(?:"+H+"*"+j+")*)",et="^\\s*(?:"+U+"?)\\s*$",lt=new RegExp(et),st=new RegExp(j,"g");return function(V){var at=W.concat(),ct=[];if(!V||V&&!lt.test(V))return at;V.replace(st,function(xt){var mt=new RegExp(j).exec(xt).filter(function(be){return!!be}),Mt=mt[1],Ot=mt.slice(2).map(parseFloat);switch(Mt){case"translate":L(at,Ot);break;case"rotate":Ot[0]=n.util.degreesToRadians(Ot[0]),O(at,Ot);break;case"scale":S(at,Ot);break;case"skewX":A(at,Ot,2);break;case"skewY":A(at,Ot,1);break;case"matrix":at=Ot;break}ct.push(at.concat()),at=W.concat()});for(var dt=ct[0];ct.length>1;)ct.shift(),dt=n.util.multiplyTransformMatrices(dt,ct[0]);return dt}}();function N(O,S){var A,L;O.replace(/;\s*$/,"").split(";").forEach(function(W){var I=W.split(":");A=I[0].trim().toLowerCase(),L=I[1].trim(),S[A]=L})}function $(O,S){var A,L;for(var W in O)typeof O[W]>"u"||(A=W.toLowerCase(),L=O[W],S[A]=L)}function J(O,S){var A={};for(var L in n.cssRules[S])if(K(O,L.split(" ")))for(var W in n.cssRules[S][L])A[W]=n.cssRules[S][L][W];return A}function K(O,S){var A,L=!0;return A=Q(O,S.pop()),A&&S.length&&(L=G(O,S)),A&&L&&S.length===0}function G(O,S){for(var A,L=!0;O.parentNode&&O.parentNode.nodeType===1&&S.length;)L&&(A=S.pop()),O=O.parentNode,L=Q(O,A);return S.length===0}function Q(O,S){var A=O.nodeName,L=O.getAttribute("class"),W=O.getAttribute("id"),I,H;if(I=new RegExp("^"+A,"i"),S=S.replace(I,""),W&&S.length&&(I=new RegExp("#"+W+"(?![a-zA-Z\\-]+)","i"),S=S.replace(I,"")),L&&S.length)for(L=L.split(" "),H=L.length;H--;)I=new RegExp("\\."+L[H]+"(?![a-zA-Z\\-]+)","i"),S=S.replace(I,"");return S.length===0}function tt(O,S){var A;if(O.getElementById&&(A=O.getElementById(S)),A)return A;var L,W,I,H=O.getElementsByTagName("*");for(W=0,I=H.length;W<I;W++)if(L=H[W],S===L.getAttribute("id"))return L}function it(O){for(var S=z(O,["use","svg:use"]),A=0;S.length&&A<S.length;){var L=S[A],W=L.getAttribute("xlink:href")||L.getAttribute("href");if(W===null)return;var I=W.slice(1),H=L.getAttribute("x")||0,q=L.getAttribute("y")||0,Z=tt(O,I).cloneNode(!0),B=(Z.getAttribute("transform")||"")+" translate("+H+", "+q+")",F,Y=S.length,X,j,U,et,lt=n.svgNS;if(M(Z),/^svg$/i.test(Z.nodeName)){var st=Z.ownerDocument.createElementNS(lt,"g");for(j=0,U=Z.attributes,et=U.length;j<et;j++)X=U.item(j),st.setAttributeNS(lt,X.nodeName,X.nodeValue);for(;Z.firstChild;)st.appendChild(Z.firstChild);Z=st}for(j=0,U=L.attributes,et=U.length;j<et;j++)X=U.item(j),!(X.nodeName==="x"||X.nodeName==="y"||X.nodeName==="xlink:href"||X.nodeName==="href")&&(X.nodeName==="transform"?B=X.nodeValue+" "+B:Z.setAttribute(X.nodeName,X.nodeValue));Z.setAttribute("transform",B),Z.setAttribute("instantiated_by_use","1"),Z.removeAttribute("id"),F=L.parentNode,F.replaceChild(Z,L),S.length===Y&&A++}}var w=new RegExp("^\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*$");function M(O){if(!n.svgViewBoxElementsRegEx.test(O.nodeName))return{};var S=O.getAttribute("viewBox"),A=1,L=1,W=0,I=0,H,q,Z,B,F=O.getAttribute("width"),Y=O.getAttribute("height"),X=O.getAttribute("x")||0,j=O.getAttribute("y")||0,U=O.getAttribute("preserveAspectRatio")||"",et=!S||!(S=S.match(w)),lt=!F||!Y||F==="100%"||Y==="100%",st=et&&lt,V={},at="",ct=0,dt=0;if(V.width=0,V.height=0,V.toBeParsed=st,et&&(X||j)&&O.parentNode&&O.parentNode.nodeName!=="#document"&&(at=" translate("+l(X)+" "+l(j)+") ",Z=(O.getAttribute("transform")||"")+at,O.setAttribute("transform",Z),O.removeAttribute("x"),O.removeAttribute("y")),st)return V;if(et)return V.width=l(F),V.height=l(Y),V;if(W=-parseFloat(S[1]),I=-parseFloat(S[2]),H=parseFloat(S[3]),q=parseFloat(S[4]),V.minX=W,V.minY=I,V.viewBoxWidth=H,V.viewBoxHeight=q,lt?(V.width=H,V.height=q):(V.width=l(F),V.height=l(Y),A=V.width/H,L=V.height/q),U=n.util.parsePreserveAspectRatioAttribute(U),U.alignX!=="none"&&(U.meetOrSlice==="meet"&&(L=A=A>L?L:A),U.meetOrSlice==="slice"&&(L=A=A>L?A:L),ct=V.width-H*A,dt=V.height-q*A,U.alignX==="Mid"&&(ct/=2),U.alignY==="Mid"&&(dt/=2),U.alignX==="Min"&&(ct=0),U.alignY==="Min"&&(dt=0)),A===1&&L===1&&W===0&&I===0&&X===0&&j===0)return V;if((X||j)&&O.parentNode.nodeName!=="#document"&&(at=" translate("+l(X)+" "+l(j)+") "),Z=at+" matrix("+A+" 0 0 "+L+" "+(W*A+ct)+" "+(I*L+dt)+") ",O.nodeName==="svg"){for(B=O.ownerDocument.createElementNS(n.svgNS,"g");O.firstChild;)B.appendChild(O.firstChild);O.appendChild(B)}else B=O,B.removeAttribute("x"),B.removeAttribute("y"),Z=B.getAttribute("transform")+Z;return B.setAttribute("transform",Z),V}function D(O,S){for(;O&&(O=O.parentNode);)if(O.nodeName&&S.test(O.nodeName.replace("svg:",""))&&!O.getAttribute("instantiated_by_use"))return!0;return!1}n.parseSVGDocument=function(O,S,A,L){if(O){it(O);var W=n.Object.__uid++,I,H,q=M(O),Z=n.util.toArray(O.getElementsByTagName("*"));if(q.crossOrigin=L&&L.crossOrigin,q.svgUid=W,Z.length===0&&n.isLikelyNode){Z=O.selectNodes('//*[name(.)!="svg"]');var B=[];for(I=0,H=Z.length;I<H;I++)B[I]=Z[I];Z=B}var F=Z.filter(function(X){return M(X),n.svgValidTagNamesRegEx.test(X.nodeName.replace("svg:",""))&&!D(X,n.svgInvalidAncestorsRegEx)});if(!F||F&&!F.length){S&&S([],{});return}var Y={};Z.filter(function(X){return X.nodeName.replace("svg:","")==="clipPath"}).forEach(function(X){var j=X.getAttribute("id");Y[j]=n.util.toArray(X.getElementsByTagName("*")).filter(function(U){return n.svgValidTagNamesRegEx.test(U.nodeName.replace("svg:",""))})}),n.gradientDefs[W]=n.getGradientDefs(O),n.cssRules[W]=n.getCSSRules(O),n.clipPaths[W]=Y,n.parseElements(F,function(X,j){S&&(S(X,q,j,Z),delete n.gradientDefs[W],delete n.cssRules[W],delete n.clipPaths[W])},f(q),A,L)}};function P(O,S){var A=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],L="xlink:href",W=S.getAttribute(L).slice(1),I=tt(O,W);if(I&&I.getAttribute(L)&&P(O,I),A.forEach(function(q){I&&!S.hasAttribute(q)&&I.hasAttribute(q)&&S.setAttribute(q,I.getAttribute(q))}),!S.children.length)for(var H=I.cloneNode(!0);H.firstChild;)S.appendChild(H.firstChild);S.removeAttribute(L)}var R=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+n.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+n.reNum+"))?\\s+(.*)");h(n,{parseFontDeclaration:function(O,S){var A=O.match(R);if(A){var L=A[1],W=A[3],I=A[4],H=A[5],q=A[6];L&&(S.fontStyle=L),W&&(S.fontWeight=isNaN(parseFloat(W))?W:parseFloat(W)),I&&(S.fontSize=l(I)),q&&(S.fontFamily=q),H&&(S.lineHeight=H==="normal"?1:H)}},getGradientDefs:function(O){var S=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],A=z(O,S),L,W=0,I={};for(W=A.length;W--;)L=A[W],L.getAttribute("xlink:href")&&P(O,L),I[L.getAttribute("id")]=L;return I},parseAttributes:function(O,S,A){if(O){var L,W={},I,H;typeof A>"u"&&(A=O.getAttribute("svgUid")),O.parentNode&&n.svgValidParentsRegEx.test(O.parentNode.nodeName)&&(W=n.parseAttributes(O.parentNode,S,A));var q=S.reduce(function(U,et){return L=O.getAttribute(et),L&&(U[et]=L),U},{}),Z=h(J(O,A),n.parseStyleAttribute(O));q=h(q,Z),Z[x]&&O.setAttribute(x,Z[x]),I=H=W.fontSize||n.Text.DEFAULT_SVG_FONT_SIZE,q[y]&&(q[y]=I=l(q[y],H));var B,F,Y={};for(var X in q)B=C(X),F=T(B,q[X],W,I),Y[B]=F;Y&&Y.font&&n.parseFontDeclaration(Y.font,Y);var j=h(W,Y);return n.svgValidParentsRegEx.test(O.nodeName)?j:E(j)}},parseElements:function(O,S,A,L,W){new n.ElementsParser(O,S,A,L,W).parse()},parseStyleAttribute:function(O){var S={},A=O.getAttribute("style");return A&&(typeof A=="string"?N(A,S):$(A,S)),S},parsePointsAttribute:function(O){if(!O)return null;O=O.replace(/,/g," ").trim(),O=O.split(/\s+/);var S=[],A,L;for(A=0,L=O.length;A<L;A+=2)S.push({x:parseFloat(O[A]),y:parseFloat(O[A+1])});return S},getCSSRules:function(O){var S=O.getElementsByTagName("style"),A,L,W={},I;for(A=0,L=S.length;A<L;A++){var H=S[A].textContent;H=H.replace(/\/\*[\s\S]*?\*\//g,""),H.trim()!==""&&(I=H.split("}"),I=I.filter(function(q){return q.trim()}),I.forEach(function(q){var Z=q.split("{"),B={},F=Z[1].trim(),Y=F.split(";").filter(function(et){return et.trim()});for(A=0,L=Y.length;A<L;A++){var X=Y[A].split(":"),j=X[0].trim(),U=X[1].trim();B[j]=U}q=Z[0].trim(),q.split(",").forEach(function(et){et=et.replace(/^svg/i,"").trim(),et!==""&&(W[et]?n.util.object.extend(W[et],B):W[et]=n.util.object.clone(B))})}))}return W},loadSVGFromURL:function(O,S,A,L){O=O.replace(/^\n\s*/,"").trim(),new n.util.request(O,{method:"get",onComplete:W});function W(I){var H=I.responseXML;if(!H||!H.documentElement)return S&&S(null),!1;n.parseSVGDocument(H.documentElement,function(q,Z,B,F){S&&S(q,Z,B,F)},A,L)}},loadSVGFromString:function(O,S,A,L){var W=new n.window.DOMParser,I=W.parseFromString(O.trim(),"text/xml");n.parseSVGDocument(I.documentElement,function(H,q,Z,B){S(H,q,Z,B)},A,L)}})}(i),t.ElementsParser=function(o,n,h,f,r,l){this.elements=o,this.callback=n,this.options=h,this.reviver=f,this.svgUid=h&&h.svgUid||0,this.parsingOptions=r,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=l},function(o){o.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},o.createObjects=function(){var n=this;this.elements.forEach(function(h,f){h.setAttribute("svgUid",n.svgUid),n.createObject(h,f)})},o.findTag=function(n){return t[t.util.string.capitalize(n.tagName.replace("svg:",""))]},o.createObject=function(n,h){var f=this.findTag(n);if(f&&f.fromElement)try{f.fromElement(n,this.createCallback(h,n),this.options)}catch(r){t.log(r)}else this.checkIfDone()},o.createCallback=function(n,h){var f=this;return function(r){var l;f.resolveGradient(r,h,"fill"),f.resolveGradient(r,h,"stroke"),r instanceof t.Image&&r._originalElement&&(l=r.parsePreserveAspectRatioAttribute(h)),r._removeTransformMatrix(l),f.resolveClipPath(r,h),f.reviver&&f.reviver(h,r),f.instances[n]=r,f.checkIfDone()}},o.extractPropertyDefinition=function(n,h,f){var r=n[h],l=this.regexUrl;if(l.test(r)){l.lastIndex=0;var a=l.exec(r)[1];return l.lastIndex=0,t[f][this.svgUid][a]}},o.resolveGradient=function(n,h,f){var r=this.extractPropertyDefinition(n,f,"gradientDefs");if(r){var l=h.getAttribute(f+"-opacity"),a=t.Gradient.fromElement(r,n,l,this.options);n.set(f,a)}},o.createClipPathCallback=function(n,h){return function(f){f._removeTransformMatrix(),f.fillRule=f.clipRule,h.push(f)}},o.resolveClipPath=function(n,h){var f=this.extractPropertyDefinition(n,"clipPath","clipPaths"),r,l,a,d,p,c;if(f){d=[],a=t.util.invertTransform(n.calcTransformMatrix());for(var m=f[0].parentNode,_=h;_.parentNode&&_.getAttribute("clip-path")!==n.clipPath;)_=_.parentNode;_.parentNode.appendChild(m);for(var b=0;b<f.length;b++)r=f[b],l=this.findTag(r),l.fromElement(r,this.createClipPathCallback(n,d),this.options);d.length===1?f=d[0]:f=new t.Group(d),p=t.util.multiplyTransformMatrices(a,f.calcTransformMatrix()),f.clipPath&&this.resolveClipPath(f,_);var c=t.util.qrDecompose(p);f.flipX=!1,f.flipY=!1,f.set("scaleX",c.scaleX),f.set("scaleY",c.scaleY),f.angle=c.angle,f.skewX=c.skewX,f.skewY=0,f.setPositionByOrigin({x:c.translateX,y:c.translateY},"center","center"),n.clipPath=f}else delete n.clipPath},o.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(n){return n!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(o){var n=o.fabric||(o.fabric={});if(n.Point){n.warn("fabric.Point is already defined");return}n.Point=h;function h(f,r){this.x=f,this.y=r}h.prototype={type:"point",constructor:h,add:function(f){return new h(this.x+f.x,this.y+f.y)},addEquals:function(f){return this.x+=f.x,this.y+=f.y,this},scalarAdd:function(f){return new h(this.x+f,this.y+f)},scalarAddEquals:function(f){return this.x+=f,this.y+=f,this},subtract:function(f){return new h(this.x-f.x,this.y-f.y)},subtractEquals:function(f){return this.x-=f.x,this.y-=f.y,this},scalarSubtract:function(f){return new h(this.x-f,this.y-f)},scalarSubtractEquals:function(f){return this.x-=f,this.y-=f,this},multiply:function(f){return new h(this.x*f,this.y*f)},multiplyEquals:function(f){return this.x*=f,this.y*=f,this},divide:function(f){return new h(this.x/f,this.y/f)},divideEquals:function(f){return this.x/=f,this.y/=f,this},eq:function(f){return this.x===f.x&&this.y===f.y},lt:function(f){return this.x<f.x&&this.y<f.y},lte:function(f){return this.x<=f.x&&this.y<=f.y},gt:function(f){return this.x>f.x&&this.y>f.y},gte:function(f){return this.x>=f.x&&this.y>=f.y},lerp:function(f,r){return typeof r>"u"&&(r=.5),r=Math.max(Math.min(1,r),0),new h(this.x+(f.x-this.x)*r,this.y+(f.y-this.y)*r)},distanceFrom:function(f){var r=this.x-f.x,l=this.y-f.y;return Math.sqrt(r*r+l*l)},midPointFrom:function(f){return this.lerp(f)},min:function(f){return new h(Math.min(this.x,f.x),Math.min(this.y,f.y))},max:function(f){return new h(Math.max(this.x,f.x),Math.max(this.y,f.y))},toString:function(){return this.x+","+this.y},setXY:function(f,r){return this.x=f,this.y=r,this},setX:function(f){return this.x=f,this},setY:function(f){return this.y=f,this},setFromPoint:function(f){return this.x=f.x,this.y=f.y,this},swap:function(f){var r=this.x,l=this.y;this.x=f.x,this.y=f.y,f.x=r,f.y=l},clone:function(){return new h(this.x,this.y)}}}(i),function(o){var n=o.fabric||(o.fabric={});if(n.Intersection){n.warn("fabric.Intersection is already defined");return}function h(f){this.status=f,this.points=[]}n.Intersection=h,n.Intersection.prototype={constructor:h,appendPoint:function(f){return this.points.push(f),this},appendPoints:function(f){return this.points=this.points.concat(f),this}},n.Intersection.intersectLineLine=function(f,r,l,a){var d,p=(a.x-l.x)*(f.y-l.y)-(a.y-l.y)*(f.x-l.x),c=(r.x-f.x)*(f.y-l.y)-(r.y-f.y)*(f.x-l.x),m=(a.y-l.y)*(r.x-f.x)-(a.x-l.x)*(r.y-f.y);if(m!==0){var _=p/m,b=c/m;0<=_&&_<=1&&0<=b&&b<=1?(d=new h("Intersection"),d.appendPoint(new n.Point(f.x+_*(r.x-f.x),f.y+_*(r.y-f.y)))):d=new h}else p===0||c===0?d=new h("Coincident"):d=new h("Parallel");return d},n.Intersection.intersectLinePolygon=function(f,r,l){var a=new h,d=l.length,p,c,m,_;for(_=0;_<d;_++)p=l[_],c=l[(_+1)%d],m=h.intersectLineLine(f,r,p,c),a.appendPoints(m.points);return a.points.length>0&&(a.status="Intersection"),a},n.Intersection.intersectPolygonPolygon=function(f,r){var l=new h,a=f.length,d;for(d=0;d<a;d++){var p=f[d],c=f[(d+1)%a],m=h.intersectLinePolygon(p,c,r);l.appendPoints(m.points)}return l.points.length>0&&(l.status="Intersection"),l},n.Intersection.intersectPolygonRectangle=function(f,r,l){var a=r.min(l),d=r.max(l),p=new n.Point(d.x,a.y),c=new n.Point(a.x,d.y),m=h.intersectLinePolygon(a,p,f),_=h.intersectLinePolygon(p,d,f),b=h.intersectLinePolygon(d,c,f),y=h.intersectLinePolygon(c,a,f),x=new h;return x.appendPoints(m.points),x.appendPoints(_.points),x.appendPoints(b.points),x.appendPoints(y.points),x.points.length>0&&(x.status="Intersection"),x}}(i),function(o){var n=o.fabric||(o.fabric={});if(n.Color){n.warn("fabric.Color is already defined.");return}function h(r){r?this._tryParsingColor(r):this.setSource([0,0,0,1])}n.Color=h,n.Color.prototype={_tryParsingColor:function(r){var l;r in h.colorNameMap&&(r=h.colorNameMap[r]),r==="transparent"&&(l=[255,255,255,0]),l||(l=h.sourceFromHex(r)),l||(l=h.sourceFromRgb(r)),l||(l=h.sourceFromHsl(r)),l||(l=[0,0,0,1]),l&&this.setSource(l)},_rgbToHsl:function(r,l,a){r/=255,l/=255,a/=255;var d,p,c,m=n.util.array.max([r,l,a]),_=n.util.array.min([r,l,a]);if(c=(m+_)/2,m===_)d=p=0;else{var b=m-_;switch(p=c>.5?b/(2-m-_):b/(m+_),m){case r:d=(l-a)/b+(l<a?6:0);break;case l:d=(a-r)/b+2;break;case a:d=(r-l)/b+4;break}d/=6}return[Math.round(d*360),Math.round(p*100),Math.round(c*100)]},getSource:function(){return this._source},setSource:function(r){this._source=r},toRgb:function(){var r=this.getSource();return"rgb("+r[0]+","+r[1]+","+r[2]+")"},toRgba:function(){var r=this.getSource();return"rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+")"},toHsl:function(){var r=this.getSource(),l=this._rgbToHsl(r[0],r[1],r[2]);return"hsl("+l[0]+","+l[1]+"%,"+l[2]+"%)"},toHsla:function(){var r=this.getSource(),l=this._rgbToHsl(r[0],r[1],r[2]);return"hsla("+l[0]+","+l[1]+"%,"+l[2]+"%,"+r[3]+")"},toHex:function(){var r=this.getSource(),l,a,d;return l=r[0].toString(16),l=l.length===1?"0"+l:l,a=r[1].toString(16),a=a.length===1?"0"+a:a,d=r[2].toString(16),d=d.length===1?"0"+d:d,l.toUpperCase()+a.toUpperCase()+d.toUpperCase()},toHexa:function(){var r=this.getSource(),l;return l=Math.round(r[3]*255),l=l.toString(16),l=l.length===1?"0"+l:l,this.toHex()+l.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(r){var l=this.getSource();return l[3]=r,this.setSource(l),this},toGrayscale:function(){var r=this.getSource(),l=parseInt((r[0]*.3+r[1]*.59+r[2]*.11).toFixed(0),10),a=r[3];return this.setSource([l,l,l,a]),this},toBlackWhite:function(r){var l=this.getSource(),a=(l[0]*.3+l[1]*.59+l[2]*.11).toFixed(0),d=l[3];return r=r||127,a=Number(a)<Number(r)?0:255,this.setSource([a,a,a,d]),this},overlayWith:function(r){r instanceof h||(r=new h(r));var l=[],a=this.getAlpha(),d=.5,p=this.getSource(),c=r.getSource(),m;for(m=0;m<3;m++)l.push(Math.round(p[m]*(1-d)+c[m]*d));return l[3]=a,this.setSource(l),this}},n.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,n.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,n.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,n.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function f(r,l,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?r+(l-r)*6*a:a<1/2?l:a<2/3?r+(l-r)*(2/3-a)*6:r}n.Color.fromRgb=function(r){return h.fromSource(h.sourceFromRgb(r))},n.Color.sourceFromRgb=function(r){var l=r.match(h.reRGBa);if(l){var a=parseInt(l[1],10)/(/%$/.test(l[1])?100:1)*(/%$/.test(l[1])?255:1),d=parseInt(l[2],10)/(/%$/.test(l[2])?100:1)*(/%$/.test(l[2])?255:1),p=parseInt(l[3],10)/(/%$/.test(l[3])?100:1)*(/%$/.test(l[3])?255:1);return[parseInt(a,10),parseInt(d,10),parseInt(p,10),l[4]?parseFloat(l[4]):1]}},n.Color.fromRgba=h.fromRgb,n.Color.fromHsl=function(r){return h.fromSource(h.sourceFromHsl(r))},n.Color.sourceFromHsl=function(r){var l=r.match(h.reHSLa);if(l){var a=(parseFloat(l[1])%360+360)%360/360,d=parseFloat(l[2])/(/%$/.test(l[2])?100:1),p=parseFloat(l[3])/(/%$/.test(l[3])?100:1),c,m,_;if(d===0)c=m=_=p;else{var b=p<=.5?p*(d+1):p+d-p*d,y=p*2-b;c=f(y,b,a+1/3),m=f(y,b,a),_=f(y,b,a-1/3)}return[Math.round(c*255),Math.round(m*255),Math.round(_*255),l[4]?parseFloat(l[4]):1]}},n.Color.fromHsla=h.fromHsl,n.Color.fromHex=function(r){return h.fromSource(h.sourceFromHex(r))},n.Color.sourceFromHex=function(r){if(r.match(h.reHex)){var l=r.slice(r.indexOf("#")+1),a=l.length===3||l.length===4,d=l.length===8||l.length===4,p=a?l.charAt(0)+l.charAt(0):l.substring(0,2),c=a?l.charAt(1)+l.charAt(1):l.substring(2,4),m=a?l.charAt(2)+l.charAt(2):l.substring(4,6),_=d?a?l.charAt(3)+l.charAt(3):l.substring(6,8):"FF";return[parseInt(p,16),parseInt(c,16),parseInt(m,16),parseFloat((parseInt(_,16)/255).toFixed(2))]}},n.Color.fromSource=function(r){var l=new h;return l.setSource(r),l}}(i),function(o){var n=o.fabric||(o.fabric={}),h=["e","se","s","sw","w","nw","n","ne","e"],f=["ns","nesw","ew","nwse"],r={},l="left",a="top",d="right",p="bottom",c="center",m={top:p,bottom:a,left:d,right:l,center:c},_=n.util.radiansToDegrees,b=Math.sign||function(B){return(B>0)-(B<0)||+B};function y(B,F){var Y=B.angle+_(Math.atan2(F.y,F.x))+360;return Math.round(Y%360/45)}function x(B,F){var Y=F.transform.target,X=Y.canvas,j=n.util.object.clone(F);j.target=Y,X&&X.fire("object:"+B,j),Y.fire(B,F)}function C(B,F){var Y=F.canvas,X=Y.uniScaleKey,j=B[X];return Y.uniformScaling&&!j||!Y.uniformScaling&&j}function T(B){return B.originX===c&&B.originY===c}function k(B,F,Y){var X=B.lockScalingX,j=B.lockScalingY;return!!(X&&j||!F&&(X||j)&&Y||X&&F==="x"||j&&F==="y")}function E(B,F,Y){var X="not-allowed",j=C(B,Y),U="";if(F.x!==0&&F.y===0?U="x":F.x===0&&F.y!==0&&(U="y"),k(Y,U,j))return X;var et=y(Y,F);return h[et]+"-resize"}function z(B,F,Y){var X="not-allowed";if(F.x!==0&&Y.lockSkewingY||F.y!==0&&Y.lockSkewingX)return X;var j=y(Y,F)%4;return f[j]+"-resize"}function N(B,F,Y){return B[Y.canvas.altActionKey]?r.skewCursorStyleHandler(B,F,Y):r.scaleCursorStyleHandler(B,F,Y)}function $(B,F,Y){var X=B[Y.canvas.altActionKey];if(F.x===0)return X?"skewX":"scaleY";if(F.y===0)return X?"skewY":"scaleX"}function J(B,F,Y){return Y.lockRotation?"not-allowed":F.cursorStyle}function K(B,F,Y,X){return{e:B,transform:F,pointer:{x:Y,y:X}}}function G(B){return function(F,Y,X,j){var U=Y.target,et=U.getCenterPoint(),lt=U.translateToOriginPoint(et,Y.originX,Y.originY),st=B(F,Y,X,j);return U.setPositionByOrigin(lt,Y.originX,Y.originY),st}}function Q(B,F){return function(Y,X,j,U){var et=F(Y,X,j,U);return et&&x(B,K(Y,X,j,U)),et}}function tt(B,F,Y,X,j){var U=B.target,et=U.controls[B.corner],lt=U.canvas.getZoom(),st=U.padding/lt,V=U.toLocalPoint(new n.Point(X,j),F,Y);return V.x>=st&&(V.x-=st),V.x<=-st&&(V.x+=st),V.y>=st&&(V.y-=st),V.y<=st&&(V.y+=st),V.x-=et.offsetX,V.y-=et.offsetY,V}function it(B){return B.flipX!==B.flipY}function w(B,F,Y,X,j){if(B[F]!==0){var U=B._getTransformedDimensions()[X],et=j/U*B[Y];B.set(Y,et)}}function M(B,F,Y,X){var j=F.target,U=j._getTransformedDimensions(0,j.skewY),et=tt(F,F.originX,F.originY,Y,X),lt=Math.abs(et.x*2)-U.x,st=j.skewX,V;lt<2?V=0:(V=_(Math.atan2(lt/j.scaleX,U.y/j.scaleY)),F.originX===l&&F.originY===p&&(V=-V),F.originX===d&&F.originY===a&&(V=-V),it(j)&&(V=-V));var at=st!==V;if(at){var ct=j._getTransformedDimensions().y;j.set("skewX",V),w(j,"skewY","scaleY","y",ct)}return at}function D(B,F,Y,X){var j=F.target,U=j._getTransformedDimensions(j.skewX,0),et=tt(F,F.originX,F.originY,Y,X),lt=Math.abs(et.y*2)-U.y,st=j.skewY,V;lt<2?V=0:(V=_(Math.atan2(lt/j.scaleY,U.x/j.scaleX)),F.originX===l&&F.originY===p&&(V=-V),F.originX===d&&F.originY===a&&(V=-V),it(j)&&(V=-V));var at=st!==V;if(at){var ct=j._getTransformedDimensions().x;j.set("skewY",V),w(j,"skewX","scaleX","x",ct)}return at}function P(B,F,Y,X){var j=F.target,U=j.skewX,et,lt=F.originY;if(j.lockSkewingX)return!1;if(U===0){var st=tt(F,c,c,Y,X);st.x>0?et=l:et=d}else U>0&&(et=lt===a?l:d),U<0&&(et=lt===a?d:l),it(j)&&(et=et===l?d:l);F.originX=et;var V=Q("skewing",G(M));return V(B,F,Y,X)}function R(B,F,Y,X){var j=F.target,U=j.skewY,et,lt=F.originX;if(j.lockSkewingY)return!1;if(U===0){var st=tt(F,c,c,Y,X);st.y>0?et=a:et=p}else U>0&&(et=lt===l?a:p),U<0&&(et=lt===l?p:a),it(j)&&(et=et===a?p:a);F.originY=et;var V=Q("skewing",G(D));return V(B,F,Y,X)}function O(B,F,Y,X){var j=F,U=j.target,et=U.translateToOriginPoint(U.getCenterPoint(),j.originX,j.originY);if(U.lockRotation)return!1;var lt=Math.atan2(j.ey-et.y,j.ex-et.x),st=Math.atan2(X-et.y,Y-et.x),V=_(st-lt+j.theta),at=!0;if(U.snapAngle>0){var ct=U.snapAngle,dt=U.snapThreshold||ct,xt=Math.ceil(V/ct)*ct,mt=Math.floor(V/ct)*ct;Math.abs(V-mt)<dt?V=mt:Math.abs(V-xt)<dt&&(V=xt)}return V<0&&(V=360+V),V%=360,at=U.angle!==V,U.angle=V,at}function S(B,F,Y,X,j){j=j||{};var U=F.target,et=U.lockScalingX,lt=U.lockScalingY,st=j.by,V,at,ct,dt,xt=C(B,U),mt=k(U,st,xt),Mt,Ot,be=F.gestureScale;if(mt)return!1;if(be)at=F.scaleX*be,ct=F.scaleY*be;else{if(V=tt(F,F.originX,F.originY,Y,X),Mt=st!=="y"?b(V.x):1,Ot=st!=="x"?b(V.y):1,F.signX||(F.signX=Mt),F.signY||(F.signY=Ot),U.lockScalingFlip&&(F.signX!==Mt||F.signY!==Ot))return!1;if(dt=U._getTransformedDimensions(),xt&&!st){var Ne=Math.abs(V.x)+Math.abs(V.y),te=F.original,mo=Math.abs(dt.x*te.scaleX/U.scaleX)+Math.abs(dt.y*te.scaleY/U.scaleY),Kn=Ne/mo;at=te.scaleX*Kn,ct=te.scaleY*Kn}else at=Math.abs(V.x*U.scaleX/dt.x),ct=Math.abs(V.y*U.scaleY/dt.y);T(F)&&(at*=2,ct*=2),F.signX!==Mt&&st!=="y"&&(F.originX=m[F.originX],at*=-1,F.signX=Mt),F.signY!==Ot&&st!=="x"&&(F.originY=m[F.originY],ct*=-1,F.signY=Ot)}var vo=U.scaleX,_o=U.scaleY;return st?(st==="x"&&U.set("scaleX",at),st==="y"&&U.set("scaleY",ct)):(!et&&U.set("scaleX",at),!lt&&U.set("scaleY",ct)),vo!==U.scaleX||_o!==U.scaleY}function A(B,F,Y,X){return S(B,F,Y,X)}function L(B,F,Y,X){return S(B,F,Y,X,{by:"x"})}function W(B,F,Y,X){return S(B,F,Y,X,{by:"y"})}function I(B,F,Y,X){return B[F.target.canvas.altActionKey]?r.skewHandlerX(B,F,Y,X):r.scalingY(B,F,Y,X)}function H(B,F,Y,X){return B[F.target.canvas.altActionKey]?r.skewHandlerY(B,F,Y,X):r.scalingX(B,F,Y,X)}function q(B,F,Y,X){var j=F.target,U=tt(F,F.originX,F.originY,Y,X),et=j.strokeWidth/(j.strokeUniform?j.scaleX:1),lt=T(F)?2:1,st=j.width,V=Math.abs(U.x*lt/j.scaleX)-et;return j.set("width",Math.max(V,0)),st!==V}function Z(B,F,Y,X){var j=F.target,U=Y-F.offsetX,et=X-F.offsetY,lt=!j.get("lockMovementX")&&j.left!==U,st=!j.get("lockMovementY")&&j.top!==et;return lt&&j.set("left",U),st&&j.set("top",et),(lt||st)&&x("moving",K(B,F,Y,X)),lt||st}r.scaleCursorStyleHandler=E,r.skewCursorStyleHandler=z,r.scaleSkewCursorStyleHandler=N,r.rotationWithSnapping=Q("rotating",G(O)),r.scalingEqually=Q("scaling",G(A)),r.scalingX=Q("scaling",G(L)),r.scalingY=Q("scaling",G(W)),r.scalingYOrSkewingX=I,r.scalingXOrSkewingY=H,r.changeWidth=Q("resizing",G(q)),r.skewHandlerX=P,r.skewHandlerY=R,r.dragHandler=Z,r.scaleOrSkewActionName=$,r.rotationStyleHandler=J,r.fireEvent=x,r.wrapWithFixedAnchor=G,r.wrapWithFireEvent=Q,r.getLocalPoint=tt,n.controlsUtils=r}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.degreesToRadians,f=n.controlsUtils;function r(a,d,p,c,m){c=c||{};var _=this.sizeX||c.cornerSize||m.cornerSize,b=this.sizeY||c.cornerSize||m.cornerSize,y=typeof c.transparentCorners<"u"?c.transparentCorners:m.transparentCorners,x=y?"stroke":"fill",C=!y&&(c.cornerStrokeColor||m.cornerStrokeColor),T=d,k=p,E;a.save(),a.fillStyle=c.cornerColor||m.cornerColor,a.strokeStyle=c.cornerStrokeColor||m.cornerStrokeColor,_>b?(E=_,a.scale(1,b/_),k=p*_/b):b>_?(E=b,a.scale(_/b,1),T=d*b/_):E=_,a.lineWidth=1,a.beginPath(),a.arc(T,k,E/2,0,2*Math.PI,!1),a[x](),C&&a.stroke(),a.restore()}function l(a,d,p,c,m){c=c||{};var _=this.sizeX||c.cornerSize||m.cornerSize,b=this.sizeY||c.cornerSize||m.cornerSize,y=typeof c.transparentCorners<"u"?c.transparentCorners:m.transparentCorners,x=y?"stroke":"fill",C=!y&&(c.cornerStrokeColor||m.cornerStrokeColor),T=_/2,k=b/2;a.save(),a.fillStyle=c.cornerColor||m.cornerColor,a.strokeStyle=c.cornerStrokeColor||m.cornerStrokeColor,a.lineWidth=1,a.translate(d,p),a.rotate(h(m.angle)),a[x+"Rect"](-T,-k,_,b),C&&a.strokeRect(-T,-k,_,b),a.restore()}f.renderCircleControl=r,f.renderSquareControl=l}(i),function(o){var n=o.fabric||(o.fabric={});function h(f){for(var r in f)this[r]=f[r]}n.Control=h,n.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(f,r){return r.cursorStyle},getActionName:function(f,r){return r.actionName},getVisibility:function(f,r){var l=f._controlsVisibility;return l&&typeof l[r]<"u"?l[r]:this.visible},setVisibility:function(f){this.visible=f},positionHandler:function(f,r){var l=n.util.transformPoint({x:this.x*f.x+this.offsetX,y:this.y*f.y+this.offsetY},r);return l},calcCornerCoords:function(f,r,l,a,d){var p,c,m,_,b=d?this.touchSizeX:this.sizeX,y=d?this.touchSizeY:this.sizeY;if(b&&y&&b!==y){var x=Math.atan2(y,b),C=Math.sqrt(b*b+y*y)/2,T=x-n.util.degreesToRadians(f),k=Math.PI/2-x-n.util.degreesToRadians(f);p=C*n.util.cos(T),c=C*n.util.sin(T),m=C*n.util.cos(k),_=C*n.util.sin(k)}else{var E=b&&y?b:r;C=E*.7071067812;var T=n.util.degreesToRadians(45-f);p=m=C*n.util.cos(T),c=_=C*n.util.sin(T)}return{tl:{x:l-_,y:a-m},tr:{x:l+p,y:a-c},bl:{x:l-p,y:a+c},br:{x:l+_,y:a+m}}},render:function(f,r,l,a,d){switch(a=a||{},a.cornerStyle||d.cornerStyle){case"circle":n.controlsUtils.renderCircleControl.call(this,f,r,l,a,d);break;default:n.controlsUtils.renderSquareControl.call(this,f,r,l,a,d)}}}}(i),function(){function o(l,a){var d=l.getAttribute("style"),p=l.getAttribute("offset")||0,c,m,_,b;if(p=parseFloat(p)/(/%$/.test(p)?100:1),p=p<0?0:p>1?1:p,d){var y=d.split(/\s*;\s*/);for(y[y.length-1]===""&&y.pop(),b=y.length;b--;){var x=y[b].split(/\s*:\s*/),C=x[0].trim(),T=x[1].trim();C==="stop-color"?c=T:C==="stop-opacity"&&(_=T)}}return c||(c=l.getAttribute("stop-color")||"rgb(0,0,0)"),_||(_=l.getAttribute("stop-opacity")),c=new t.Color(c),m=c.getAlpha(),_=isNaN(parseFloat(_))?1:parseFloat(_),_*=m*a,{offset:p,color:c.toRgb(),opacity:_}}function n(l){return{x1:l.getAttribute("x1")||0,y1:l.getAttribute("y1")||0,x2:l.getAttribute("x2")||"100%",y2:l.getAttribute("y2")||0}}function h(l){return{x1:l.getAttribute("fx")||l.getAttribute("cx")||"50%",y1:l.getAttribute("fy")||l.getAttribute("cy")||"50%",r1:0,x2:l.getAttribute("cx")||"50%",y2:l.getAttribute("cy")||"50%",r2:l.getAttribute("r")||"50%"}}var f=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(l){l||(l={}),l.coords||(l.coords={});var a,d=this;Object.keys(l).forEach(function(p){d[p]=l[p]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,a={x1:l.coords.x1||0,y1:l.coords.y1||0,x2:l.coords.x2||0,y2:l.coords.y2||0},this.type==="radial"&&(a.r1=l.coords.r1||0,a.r2=l.coords.r2||0),this.coords=a,this.colorStops=l.colorStops.slice()},addColorStop:function(l){for(var a in l){var d=new t.Color(l[a]);this.colorStops.push({offset:parseFloat(a),color:d.toRgb(),opacity:d.getAlpha()})}return this},toObject:function(l){var a={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,a,l),a},toSVG:function(l,m){var d=f(this.coords,!0),p,c,m=m||{},_,b,y=f(this.colorStops,!0),x=d.r1>d.r2,C=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),T=-this.offsetX,k=-this.offsetY,E=!!m.additionalTransform,z=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(y.sort(function(G,Q){return G.offset-Q.offset}),z==="objectBoundingBox"?(T/=l.width,k/=l.height):(T+=l.width/2,k+=l.height/2),l.type==="path"&&this.gradientUnits!=="percentage"&&(T-=l.pathOffset.x,k-=l.pathOffset.y),C[4]-=T,C[5]-=k,b='id="SVGID_'+this.id+'" gradientUnits="'+z+'"',b+=' gradientTransform="'+(E?m.additionalTransform+" ":"")+t.util.matrixToSVG(C)+'" ',this.type==="linear"?_=["<linearGradient ",b,' x1="',d.x1,'" y1="',d.y1,'" x2="',d.x2,'" y2="',d.y2,`">
`]:this.type==="radial"&&(_=["<radialGradient ",b,' cx="',x?d.x1:d.x2,'" cy="',x?d.y1:d.y2,'" r="',x?d.r1:d.r2,'" fx="',x?d.x2:d.x1,'" fy="',x?d.y2:d.y1,`">
`]),this.type==="radial"){if(x)for(y=y.concat(),y.reverse(),p=0,c=y.length;p<c;p++)y[p].offset=1-y[p].offset;var N=Math.min(d.r1,d.r2);if(N>0){var $=Math.max(d.r1,d.r2),J=N/$;for(p=0,c=y.length;p<c;p++)y[p].offset+=J*(1-y[p].offset)}}for(p=0,c=y.length;p<c;p++){var K=y[p];_.push("<stop ",'offset="',K.offset*100+"%",'" style="stop-color:',K.color,typeof K.opacity<"u"?";stop-opacity: "+K.opacity:";",`"/>
`)}return _.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),_.join("")},toLive:function(l){var a,d=t.util.object.clone(this.coords),p,c;if(this.type){for(this.type==="linear"?a=l.createLinearGradient(d.x1,d.y1,d.x2,d.y2):this.type==="radial"&&(a=l.createRadialGradient(d.x1,d.y1,d.r1,d.x2,d.y2,d.r2)),p=0,c=this.colorStops.length;p<c;p++){var m=this.colorStops[p].color,_=this.colorStops[p].opacity,b=this.colorStops[p].offset;typeof _<"u"&&(m=new t.Color(m).setAlpha(_).toRgba()),a.addColorStop(b,m)}return a}}}),t.util.object.extend(t.Gradient,{fromElement:function(l,a,d,p){var c=parseFloat(d)/(/%$/.test(d)?100:1);c=c<0?0:c>1?1:c,isNaN(c)&&(c=1);var m=l.getElementsByTagName("stop"),_,b=l.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",y=l.getAttribute("gradientTransform")||"",x=[],C,T,k=0,E=0,z;for(l.nodeName==="linearGradient"||l.nodeName==="LINEARGRADIENT"?(_="linear",C=n(l)):(_="radial",C=h(l)),T=m.length;T--;)x.push(o(m[T],c));z=t.parseTransformAttribute(y),r(a,C,p,b),b==="pixels"&&(k=-a.left,E=-a.top);var N=new t.Gradient({id:l.getAttribute("id"),type:_,coords:C,colorStops:x,gradientUnits:b,gradientTransform:z,offsetX:k,offsetY:E});return N}});function r(l,a,d,p){var c,m;Object.keys(a).forEach(function(_){c=a[_],c==="Infinity"?m=1:c==="-Infinity"?m=0:(m=parseFloat(a[_],10),typeof c=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(c)&&(m*=.01,p==="pixels"&&((_==="x1"||_==="x2"||_==="r2")&&(m*=d.viewBoxWidth||d.width),(_==="y1"||_==="y2")&&(m*=d.viewBoxHeight||d.height)))),a[_]=m})}}(),function(){var o=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(n,h){if(n||(n={}),this.id=t.Object.__uid++,this.setOptions(n),!n.source||n.source&&typeof n.source!="string"){h&&h(this);return}else{var f=this;this.source=t.util.createImage(),t.util.loadImage(n.source,function(r,l){f.source=r,h&&h(f,l)},null,this.crossOrigin)}},toObject:function(n){var h=t.Object.NUM_FRACTION_DIGITS,f,r;return typeof this.source.src=="string"?f=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(f=this.source.toDataURL()),r={type:"pattern",source:f,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:o(this.offsetX,h),offsetY:o(this.offsetY,h),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,r,n),r},toSVG:function(n){var h=typeof this.source=="function"?this.source():this.source,f=h.width/n.width,r=h.height/n.height,l=this.offsetX/n.width,a=this.offsetY/n.height,d="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(r=1,a&&(r+=Math.abs(a))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(f=1,l&&(f+=Math.abs(l))),h.src?d=h.src:h.toDataURL&&(d=h.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+l+'" y="'+a+'" width="'+f+'" height="'+r+`">
<image x="0" y="0" width="`+h.width+'" height="'+h.height+'" xlink:href="'+d+`"></image>
</pattern>
`},setOptions:function(n){for(var h in n)this[h]=n[h]},toLive:function(n){var h=this.source;return!h||typeof h.src<"u"&&(!h.complete||h.naturalWidth===0||h.naturalHeight===0)?"":n.createPattern(h,this.repeat)}})}(),function(o){var n=o.fabric||(o.fabric={}),h=n.util.toFixed;if(n.Shadow){n.warn("fabric.Shadow is already defined.");return}n.Shadow=n.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(f){typeof f=="string"&&(f=this._parseShadow(f));for(var r in f)this[r]=f[r];this.id=n.Object.__uid++},_parseShadow:function(f){var r=f.trim(),l=n.Shadow.reOffsetsAndBlur.exec(r)||[],a=r.replace(n.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:a.trim(),offsetX:parseFloat(l[1],10)||0,offsetY:parseFloat(l[2],10)||0,blur:parseFloat(l[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(f){var r=40,l=40,a=n.Object.NUM_FRACTION_DIGITS,d=n.util.rotateVector({x:this.offsetX,y:this.offsetY},n.util.degreesToRadians(-f.angle)),p=20,c=new n.Color(this.color);return f.width&&f.height&&(r=h((Math.abs(d.x)+this.blur)/f.width,a)*100+p,l=h((Math.abs(d.y)+this.blur)/f.height,a)*100+p),f.flipX&&(d.x*=-1),f.flipY&&(d.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+l+'%" height="'+(100+2*l)+'%" x="-'+r+'%" width="'+(100+2*r)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+h(this.blur?this.blur/2:0,a)+`"></feGaussianBlur>
	<feOffset dx="`+h(d.x,a)+'" dy="'+h(d.y,a)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+c.toRgb()+'" flood-opacity="'+c.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var f={},r=n.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(l){this[l]!==r[l]&&(f[l]=this[l])},this),f}}),n.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(i),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var o=t.util.object.extend,n=t.util.getElementOffset,h=t.util.removeFromArray,f=t.util.toFixed,r=t.util.transformPoint,l=t.util.invertTransform,a=t.util.getNodeCanvas,d=t.util.createCanvasElement,p=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(c,m){m||(m={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(c,m)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(c,m){var _=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(c),this._initOptions(m),this.interactive||this._initRetinaScaling(),m.overlayImage&&this.setOverlayImage(m.overlayImage,_),m.backgroundImage&&this.setBackgroundImage(m.backgroundImage,_),m.backgroundColor&&this.setBackgroundColor(m.backgroundColor,_),m.overlayColor&&this.setOverlayColor(m.overlayColor,_),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,t.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var c=t.devicePixelRatio;this.__initRetinaScaling(c,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(c,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(c,m,_){m.setAttribute("width",this.width*c),m.setAttribute("height",this.height*c),_.scale(c,c)},calcOffset:function(){return this._offset=n(this.lowerCanvasEl),this},setOverlayImage:function(c,m,_){return this.__setBgOverlayImage("overlayImage",c,m,_)},setBackgroundImage:function(c,m,_){return this.__setBgOverlayImage("backgroundImage",c,m,_)},setOverlayColor:function(c,m){return this.__setBgOverlayColor("overlayColor",c,m)},setBackgroundColor:function(c,m){return this.__setBgOverlayColor("backgroundColor",c,m)},__setBgOverlayImage:function(c,m,_,b){return typeof m=="string"?t.util.loadImage(m,function(y,x){if(y){var C=new t.Image(y,b);this[c]=C,C.canvas=this}_&&_(y,x)},this,b&&b.crossOrigin):(b&&m.setOptions(b),this[c]=m,m&&(m.canvas=this),_&&_(m,!1)),this},__setBgOverlayColor:function(c,m,_){return this[c]=m,this._initGradient(m,c),this._initPattern(m,c,_),this},_createCanvasElement:function(){var c=d();if(!c||(c.style||(c.style={}),typeof c.getContext>"u"))throw p;return c},_initOptions:function(c){var m=this.lowerCanvasEl;this._setOptions(c),this.width=this.width||parseInt(m.width,10)||0,this.height=this.height||parseInt(m.height,10)||0,this.lowerCanvasEl.style&&(m.width=this.width,m.height=this.height,m.style.width=this.width+"px",m.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(c){c&&c.getContext?this.lowerCanvasEl=c:this.lowerCanvasEl=t.util.getById(c)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(c,m){return this.setDimensions({width:c},m)},setHeight:function(c,m){return this.setDimensions({height:c},m)},setDimensions:function(c,m){var _;m=m||{};for(var b in c)_=c[b],m.cssOnly||(this._setBackstoreDimension(b,c[b]),_+="px",this.hasLostContext=!0),m.backstoreOnly||this._setCssDimension(b,_);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),m.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(c,m){return this.lowerCanvasEl[c]=m,this.upperCanvasEl&&(this.upperCanvasEl[c]=m),this.cacheCanvasEl&&(this.cacheCanvasEl[c]=m),this[c]=m,this},_setCssDimension:function(c,m){return this.lowerCanvasEl.style[c]=m,this.upperCanvasEl&&(this.upperCanvasEl.style[c]=m),this.wrapperEl&&(this.wrapperEl.style[c]=m),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(c){var m=this._activeObject,_=this.backgroundImage,b=this.overlayImage,y,x,C;for(this.viewportTransform=c,x=0,C=this._objects.length;x<C;x++)y=this._objects[x],y.group||y.setCoords(!0);return m&&m.setCoords(),_&&_.setCoords(!0),b&&b.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(c,m){var _=c,b=this.viewportTransform.slice(0);c=r(c,l(this.viewportTransform)),b[0]=m,b[3]=m;var y=r(c,b);return b[4]+=_.x-y.x,b[5]+=_.y-y.y,this.setViewportTransform(b)},setZoom:function(c){return this.zoomToPoint(new t.Point(0,0),c),this},absolutePan:function(c){var m=this.viewportTransform.slice(0);return m[4]=-c.x,m[5]=-c.y,this.setViewportTransform(m)},relativePan:function(c){return this.absolutePan(new t.Point(-c.x-this.viewportTransform[4],-c.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(c){this.stateful&&c.setupState(),c._set("canvas",this),c.setCoords(),this.fire("object:added",{target:c}),c.fire("added")},_onObjectRemoved:function(c){this.fire("object:removed",{target:c}),c.fire("removed"),delete c.canvas},clearContext:function(c){return c.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var c=this.contextContainer;return this.renderCanvas(c,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var c={},m=this.width,_=this.height,b=l(this.viewportTransform);return c.tl=r({x:0,y:0},b),c.br=r({x:m,y:_},b),c.tr=new t.Point(c.br.x,c.tl.y),c.bl=new t.Point(c.tl.x,c.br.y),this.vptCoords=c,c},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(c,m){var _=this.viewportTransform,b=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(c),t.util.setImageSmoothing(c,this.imageSmoothingEnabled),this.fire("before:render",{ctx:c}),this._renderBackground(c),c.save(),c.transform(_[0],_[1],_[2],_[3],_[4],_[5]),this._renderObjects(c,m),c.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(c),b&&(b.canvas=this,b.shouldCache(),b._transformDone=!0,b.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(c)),this._renderOverlay(c),this.controlsAboveOverlay&&this.interactive&&this.drawControls(c),this.fire("after:render",{ctx:c})},drawClipPathOnCanvas:function(c){var m=this.viewportTransform,_=this.clipPath;c.save(),c.transform(m[0],m[1],m[2],m[3],m[4],m[5]),c.globalCompositeOperation="destination-in",_.transform(c),c.scale(1/_.zoomX,1/_.zoomY),c.drawImage(_._cacheCanvas,-_.cacheTranslationX,-_.cacheTranslationY),c.restore()},_renderObjects:function(c,m){var _,b;for(_=0,b=m.length;_<b;++_)m[_]&&m[_].render(c)},_renderBackgroundOrOverlay:function(c,m){var _=this[m+"Color"],b=this[m+"Image"],y=this.viewportTransform,x=this[m+"Vpt"];if(!(!_&&!b)){if(_){c.save(),c.beginPath(),c.moveTo(0,0),c.lineTo(this.width,0),c.lineTo(this.width,this.height),c.lineTo(0,this.height),c.closePath(),c.fillStyle=_.toLive?_.toLive(c,this):_,x&&c.transform(y[0],y[1],y[2],y[3],y[4],y[5]),c.transform(1,0,0,1,_.offsetX||0,_.offsetY||0);var C=_.gradientTransform||_.patternTransform;C&&c.transform(C[0],C[1],C[2],C[3],C[4],C[5]),c.fill(),c.restore()}b&&(c.save(),x&&c.transform(y[0],y[1],y[2],y[3],y[4],y[5]),b.render(c),c.restore())}},_renderBackground:function(c){this._renderBackgroundOrOverlay(c,"background")},_renderOverlay:function(c){this._renderBackgroundOrOverlay(c,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new t.Point(this.width/2,this.height/2)},centerObjectH:function(c){return this._centerObject(c,new t.Point(this.getCenterPoint().x,c.getCenterPoint().y))},centerObjectV:function(c){return this._centerObject(c,new t.Point(c.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(c){var m=this.getCenterPoint();return this._centerObject(c,m)},viewportCenterObject:function(c){var m=this.getVpCenter();return this._centerObject(c,m)},viewportCenterObjectH:function(c){var m=this.getVpCenter();return this._centerObject(c,new t.Point(m.x,c.getCenterPoint().y)),this},viewportCenterObjectV:function(c){var m=this.getVpCenter();return this._centerObject(c,new t.Point(c.getCenterPoint().x,m.y))},getVpCenter:function(){var c=this.getCenterPoint(),m=l(this.viewportTransform);return r(c,m)},_centerObject:function(c,m){return c.setPositionByOrigin(m,"center","center"),c.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(c){return this.toDatalessObject(c)},toObject:function(c){return this._toObjectMethod("toObject",c)},toDatalessObject:function(c){return this._toObjectMethod("toDatalessObject",c)},_toObjectMethod:function(c,m){var _=this.clipPath,b={version:t.version,objects:this._toObjects(c,m)};return _&&!_.excludeFromExport&&(b.clipPath=this._toObject(this.clipPath,c,m)),o(b,this.__serializeBgOverlay(c,m)),t.util.populateWithProperties(this,b,m),b},_toObjects:function(c,m){return this._objects.filter(function(_){return!_.excludeFromExport}).map(function(_){return this._toObject(_,c,m)},this)},_toObject:function(c,m,_){var b;this.includeDefaultValues||(b=c.includeDefaultValues,c.includeDefaultValues=!1);var y=c[m](_);return this.includeDefaultValues||(c.includeDefaultValues=b),y},__serializeBgOverlay:function(c,m){var _={},b=this.backgroundImage,y=this.overlayImage,x=this.backgroundColor,C=this.overlayColor;return x&&x.toObject?x.excludeFromExport||(_.background=x.toObject(m)):x&&(_.background=x),C&&C.toObject?C.excludeFromExport||(_.overlay=C.toObject(m)):C&&(_.overlay=C),b&&!b.excludeFromExport&&(_.backgroundImage=this._toObject(b,c,m)),y&&!y.excludeFromExport&&(_.overlayImage=this._toObject(y,c,m)),_},svgViewportTransformation:!0,toSVG:function(c,m){c||(c={}),c.reviver=m;var _=[];return this._setSVGPreamble(_,c),this._setSVGHeader(_,c),this.clipPath&&_.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(_,"background"),this._setSVGBgOverlayImage(_,"backgroundImage",m),this._setSVGObjects(_,m),this.clipPath&&_.push(`</g>
`),this._setSVGBgOverlayColor(_,"overlay"),this._setSVGBgOverlayImage(_,"overlayImage",m),_.push("</svg>"),_.join("")},_setSVGPreamble:function(c,m){m.suppressPreamble||c.push('<?xml version="1.0" encoding="',m.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(c,m){var _=m.width||this.width,b=m.height||this.height,y,x='viewBox="0 0 '+this.width+" "+this.height+'" ',C=t.Object.NUM_FRACTION_DIGITS;m.viewBox?x='viewBox="'+m.viewBox.x+" "+m.viewBox.y+" "+m.viewBox.width+" "+m.viewBox.height+'" ':this.svgViewportTransformation&&(y=this.viewportTransform,x='viewBox="'+f(-y[4]/y[0],C)+" "+f(-y[5]/y[3],C)+" "+f(this.width/y[0],C)+" "+f(this.height/y[3],C)+'" '),c.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',_,'" ','height="',b,'" ',x,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(m),`</defs>
`)},createSVGClipPathMarkup:function(c){var m=this.clipPath;return m?(m.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+m.clipPathId+`" >
`+this.clipPath.toClipPathSVG(c.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var c=this,m=["background","overlay"].map(function(_){var b=c[_+"Color"];if(b&&b.toLive){var y=c[_+"Vpt"],x=c.viewportTransform,C={width:c.width/(y?x[0]:1),height:c.height/(y?x[3]:1)};return b.toSVG(C,{additionalTransform:y?t.util.matrixToSVG(x):""})}});return m.join("")},createSVGFontFacesMarkup:function(){var c="",m={},_,b,y,x,C,T,k,E,z,N=t.fontPaths,$=[];for(this._objects.forEach(function K(G){$.push(G),G._objects&&G._objects.forEach(K)}),E=0,z=$.length;E<z;E++)if(_=$[E],b=_.fontFamily,!(_.type.indexOf("text")===-1||m[b]||!N[b])&&(m[b]=!0,!!_.styles)){y=_.styles;for(C in y){x=y[C];for(k in x)T=x[k],b=T.fontFamily,!m[b]&&N[b]&&(m[b]=!0)}}for(var J in m)c+=[`		@font-face {
`,"			font-family: '",J,`';
`,"			src: url('",N[J],`');
`,`		}
`].join("");return c&&(c=['	<style type="text/css">',`<![CDATA[
`,c,"]]>",`</style>
`].join("")),c},_setSVGObjects:function(c,m){var _,b,y,x=this._objects;for(b=0,y=x.length;b<y;b++)_=x[b],!_.excludeFromExport&&this._setSVGObject(c,_,m)},_setSVGObject:function(c,m,_){c.push(m.toSVG(_))},_setSVGBgOverlayImage:function(c,m,_){this[m]&&!this[m].excludeFromExport&&this[m].toSVG&&c.push(this[m].toSVG(_))},_setSVGBgOverlayColor:function(c,m){var _=this[m+"Color"],b=this.viewportTransform,y=this.width,x=this.height;if(_)if(_.toLive){var C=_.repeat,T=t.util.invertTransform(b),k=this[m+"Vpt"],E=k?t.util.matrixToSVG(T):"";c.push('<rect transform="'+E+" translate(",y/2,",",x/2,')"',' x="',_.offsetX-y/2,'" y="',_.offsetY-x/2,'" ','width="',C==="repeat-y"||C==="no-repeat"?_.source.width:y,'" height="',C==="repeat-x"||C==="no-repeat"?_.source.height:x,'" fill="url(#SVGID_'+_.id+')"',`></rect>
`)}else c.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',_,'"',`></rect>
`)},sendToBack:function(c){if(!c)return this;var m=this._activeObject,_,b,y;if(c===m&&c.type==="activeSelection")for(y=m._objects,_=y.length;_--;)b=y[_],h(this._objects,b),this._objects.unshift(b);else h(this._objects,c),this._objects.unshift(c);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(c){if(!c)return this;var m=this._activeObject,_,b,y;if(c===m&&c.type==="activeSelection")for(y=m._objects,_=0;_<y.length;_++)b=y[_],h(this._objects,b),this._objects.push(b);else h(this._objects,c),this._objects.push(c);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(c,m){if(!c)return this;var _=this._activeObject,b,y,x,C,T,k=0;if(c===_&&c.type==="activeSelection")for(T=_._objects,b=0;b<T.length;b++)y=T[b],x=this._objects.indexOf(y),x>0+k&&(C=x-1,h(this._objects,y),this._objects.splice(C,0,y)),k++;else x=this._objects.indexOf(c),x!==0&&(C=this._findNewLowerIndex(c,x,m),h(this._objects,c),this._objects.splice(C,0,c));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(c,m,_){var b,y;if(_)for(b=m,y=m-1;y>=0;--y){var x=c.intersectsWithObject(this._objects[y])||c.isContainedWithinObject(this._objects[y])||this._objects[y].isContainedWithinObject(c);if(x){b=y;break}}else b=m-1;return b},bringForward:function(c,m){if(!c)return this;var _=this._activeObject,b,y,x,C,T,k=0;if(c===_&&c.type==="activeSelection")for(T=_._objects,b=T.length;b--;)y=T[b],x=this._objects.indexOf(y),x<this._objects.length-1-k&&(C=x+1,h(this._objects,y),this._objects.splice(C,0,y)),k++;else x=this._objects.indexOf(c),x!==this._objects.length-1&&(C=this._findNewUpperIndex(c,x,m),h(this._objects,c),this._objects.splice(C,0,c));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(c,m,_){var b,y,x;if(_)for(b=m,y=m+1,x=this._objects.length;y<x;++y){var C=c.intersectsWithObject(this._objects[y])||c.isContainedWithinObject(this._objects[y])||this._objects[y].isContainedWithinObject(c);if(C){b=y;break}}else b=m+1;return b},moveTo:function(c,m){return h(this._objects,c),this._objects.splice(m,0,c),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(c){c.dispose&&c.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),t.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),o(t.StaticCanvas.prototype,t.Observable),o(t.StaticCanvas.prototype,t.Collection),o(t.StaticCanvas.prototype,t.DataURLExporter),o(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(c){var m=d();if(!m||!m.getContext)return null;var _=m.getContext("2d");if(!_)return null;switch(c){case"setLineDash":return typeof _.setLineDash<"u";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var c=a(this.lowerCanvasEl);return c&&c.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(c){var m=a(this.lowerCanvasEl);return m&&m.createJPEGStream(c)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(o){o.strokeStyle=this.color,o.lineWidth=this.width,o.lineCap=this.strokeLineCap,o.miterLimit=this.strokeMiterLimit,o.lineJoin=this.strokeLineJoin,o.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(o){var n=this.canvas.viewportTransform;o.save(),o.transform(n[0],n[1],n[2],n[3],n[4],n[5])},_setShadow:function(){if(this.shadow){var o=this.canvas,n=this.shadow,h=o.contextTop,f=o.getZoom();o&&o._isRetinaScaling()&&(f*=t.devicePixelRatio),h.shadowColor=n.color,h.shadowBlur=n.blur*f,h.shadowOffsetX=n.offsetX*f,h.shadowOffsetY=n.offsetY*f}},needsFullRender:function(){var o=new t.Color(this.color);return o.getAlpha()<1||!!this.shadow},_resetShadow:function(){var o=this.canvas.contextTop;o.shadowColor="",o.shadowBlur=o.shadowOffsetX=o.shadowOffsetY=0},_isOutSideCanvas:function(o){return o.x<0||o.x>this.canvas.getWidth()||o.y<0||o.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(o){this.canvas=o,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(o,n,h){var f=n.midPointFrom(h);return o.quadraticCurveTo(n.x,n.y,f.x,f.y),f},onMouseDown:function(o,n){this.canvas._isMainEvent(n.e)&&(this.drawStraightLine=n.e[this.straightLineKey],this._prepareForDrawing(o),this._captureDrawingPath(o),this._render())},onMouseMove:function(o,n){if(this.canvas._isMainEvent(n.e)&&(this.drawStraightLine=n.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o))&&this._captureDrawingPath(o)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var h=this._points,f=h.length,r=this.canvas.contextTop;this._saveAndTransform(r),this.oldEnd&&(r.beginPath(),r.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(r,h[f-2],h[f-1],!0),r.stroke(),r.restore()}},onMouseUp:function(o){return this.canvas._isMainEvent(o.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(o){var n=new t.Point(o.x,o.y);this._reset(),this._addPoint(n),this.canvas.contextTop.moveTo(n.x,n.y)},_addPoint:function(o){return this._points.length>1&&o.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(o),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(o){var n=new t.Point(o.x,o.y);return this._addPoint(n)},_render:function(o){var n,h,f=this._points[0],r=this._points[1];if(o=o||this.canvas.contextTop,this._saveAndTransform(o),o.beginPath(),this._points.length===2&&f.x===r.x&&f.y===r.y){var l=this.width/1e3;f=new t.Point(f.x,f.y),r=new t.Point(r.x,r.y),f.x-=l,r.x+=l}for(o.moveTo(f.x,f.y),n=1,h=this._points.length;n<h;n++)this._drawSegment(o,f,r),f=this._points[n],r=this._points[n+1];o.lineTo(f.x,f.y),o.stroke(),o.restore()},convertPointsToSVGPath:function(o){var n=this.width/1e3;return t.util.getSmoothPathFromPoints(o,n)},_isEmptySVGPath:function(o){var n=t.util.joinPath(o);return n==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(o){var n=new t.Path(o,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,n.shadow=new t.Shadow(this.shadow)),n},decimatePoints:function(o,n){if(o.length<=2)return o;var h=this.canvas.getZoom(),f=Math.pow(n/h,2),r,l=o.length-1,a=o[0],d=[a],p;for(r=1;r<l-1;r++)p=Math.pow(a.x-o[r].x,2)+Math.pow(a.y-o[r].y,2),p>=f&&(a=o[r],d.push(a));return d.push(o[l]),d},_finalizeAndAddPath:function(){var o=this.canvas.contextTop;o.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var n=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(n)){this.canvas.requestRenderAll();return}var h=this.createPath(n);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:h}),this.canvas.add(h),this.canvas.requestRenderAll(),h.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:h})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(o){this.canvas=o,this.points=[]},drawDot:function(o){var n=this.addPoint(o),h=this.canvas.contextTop;this._saveAndTransform(h),this.dot(h,n),h.restore()},dot:function(o,n){o.fillStyle=n.fill,o.beginPath(),o.arc(n.x,n.y,n.radius,0,Math.PI*2,!1),o.closePath(),o.fill()},onMouseDown:function(o){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(o)},_render:function(){var o=this.canvas.contextTop,n,h,f=this.points;for(this._saveAndTransform(o),n=0,h=f.length;n<h;n++)this.dot(o,f[n]);o.restore()},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(o),this._render()):this.drawDot(o))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove,n,h;this.canvas.renderOnAddRemove=!1;var f=[];for(n=0,h=this.points.length;n<h;n++){var r=this.points[n],l=new t.Circle({radius:r.radius,left:r.x,top:r.y,originX:"center",originY:"center",fill:r.fill});this.shadow&&(l.shadow=new t.Shadow(this.shadow)),f.push(l)}var a=new t.Group(f);a.canvas=this.canvas,this.canvas.fire("before:path:created",{path:a}),this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},addPoint:function(o){var n=new t.Point(o.x,o.y),h=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,f=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return n.radius=h,n.fill=f,this.points.push(n),n}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(o){this.canvas=o,this.sprayChunks=[]},onMouseDown:function(o){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(o),this.render(this.sprayChunkPoints)},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.addSprayChunk(o),this.render(this.sprayChunkPoints))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var n=[],h=0,f=this.sprayChunks.length;h<f;h++)for(var r=this.sprayChunks[h],l=0,a=r.length;l<a;l++){var d=new t.Rect({width:r[l].width,height:r[l].width,left:r[l].x+1,top:r[l].y+1,originX:"center",originY:"center",fill:this.color});n.push(d)}this.optimizeOverlapping&&(n=this._getOptimizedRects(n));var p=new t.Group(n);this.shadow&&p.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:p}),this.canvas.add(p),this.canvas.fire("path:created",{path:p}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},_getOptimizedRects:function(o){var n={},h,f,r;for(f=0,r=o.length;f<r;f++)h=o[f].left+""+o[f].top,n[h]||(n[h]=o[f]);var l=[];for(h in n)l.push(n[h]);return l},render:function(o){var n=this.canvas.contextTop,h,f;for(n.fillStyle=this.color,this._saveAndTransform(n),h=0,f=o.length;h<f;h++){var r=o[h];typeof r.opacity<"u"&&(n.globalAlpha=r.opacity),n.fillRect(r.x,r.y,r.width,r.width)}n.restore()},_render:function(){var o=this.canvas.contextTop,n,h;for(o.fillStyle=this.color,this._saveAndTransform(o),n=0,h=this.sprayChunks.length;n<h;n++)this.render(this.sprayChunks[n]);o.restore()},addSprayChunk:function(o){this.sprayChunkPoints=[];var n,h,f,r=this.width/2,l;for(l=0;l<this.density;l++){n=t.util.getRandomInt(o.x-r,o.x+r),h=t.util.getRandomInt(o.y-r,o.y+r),this.dotWidthVariance?f=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):f=this.dotWidth;var a=new t.Point(n,h);a.width=f,this.randomOpacity&&(a.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var o=20,n=5,h=t.util.createCanvasElement(),f=h.getContext("2d");return h.width=h.height=o+n,f.fillStyle=this.color,f.beginPath(),f.arc(o/2,o/2,o/2,0,Math.PI*2,!1),f.closePath(),f.fill(),h},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(o){return o.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(o){this.callSuper("_setBrushStyles",o),o.strokeStyle=this.getPattern(o)},createPath:function(o){var n=this.callSuper("createPath",o),h=n._getLeftTopCoords().scalarAdd(n.strokeWidth/2);return n.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-h.x,offsetY:-h.y}),n}}),function(){var o=t.util.getPointer,n=t.util.degreesToRadians,h=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(r,l){l||(l={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(r,l),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var r=this.getActiveObjects(),l,a,d;if(r.length>0&&!this.preserveObjectStacking){a=[],d=[];for(var p=0,c=this._objects.length;p<c;p++)l=this._objects[p],r.indexOf(l)===-1?a.push(l):d.push(l);r.length>1&&(this._activeObject._objects=d),a.push.apply(a,d)}else a=this._objects;return a},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var r=this.contextContainer;return this.renderCanvas(r,this._chooseObjectsToRender()),this},renderTopLayer:function(r){r.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(r),this.contextTopDirty=!0),r.restore()},renderTop:function(){var r=this.contextTop;return this.clearContext(r),this.renderTopLayer(r),this.fire("after:render"),this},_normalizePointer:function(r,l){var a=r.calcTransformMatrix(),d=t.util.invertTransform(a),p=this.restorePointerVpt(l);return t.util.transformPoint(p,d)},isTargetTransparent:function(r,l,a){if(r.shouldCache()&&r._cacheCanvas&&r!==this._activeObject){var d=this._normalizePointer(r,{x:l,y:a}),p=Math.max(r.cacheTranslationX+d.x*r.zoomX,0),c=Math.max(r.cacheTranslationY+d.y*r.zoomY,0),y=t.util.isTransparent(r._cacheContext,Math.round(p),Math.round(c),this.targetFindTolerance);return y}var m=this.contextCache,_=r.selectionBackgroundColor,b=this.viewportTransform;r.selectionBackgroundColor="",this.clearContext(m),m.save(),m.transform(b[0],b[1],b[2],b[3],b[4],b[5]),r.render(m),m.restore(),r.selectionBackgroundColor=_;var y=t.util.isTransparent(m,l,a,this.targetFindTolerance);return y},_isSelectionKeyPressed:function(r){var l=!1;return Array.isArray(this.selectionKey)?l=!!this.selectionKey.find(function(a){return r[a]===!0}):l=r[this.selectionKey],l},_shouldClearSelection:function(r,l){var a=this.getActiveObjects(),d=this._activeObject;return!l||l&&d&&a.length>1&&a.indexOf(l)===-1&&d!==l&&!this._isSelectionKeyPressed(r)||l&&!l.evented||l&&!l.selectable&&d&&d!==l},_shouldCenterTransform:function(r,l,a){if(r){var d;return l==="scale"||l==="scaleX"||l==="scaleY"||l==="resizing"?d=this.centeredScaling||r.centeredScaling:l==="rotate"&&(d=this.centeredRotation||r.centeredRotation),d?!a:a}},_getOriginFromCorner:function(r,l){var a={x:r.originX,y:r.originY};return l==="ml"||l==="tl"||l==="bl"?a.x="right":(l==="mr"||l==="tr"||l==="br")&&(a.x="left"),l==="tl"||l==="mt"||l==="tr"?a.y="bottom":(l==="bl"||l==="mb"||l==="br")&&(a.y="top"),a},_getActionFromCorner:function(r,l,a,d){if(!l||!r)return"drag";var p=d.controls[l];return p.getActionName(a,p,d)},_setupCurrentTransform:function(r,l,a){if(l){var d=this.getPointer(r),p=l.__corner,c=l.controls[p],m=a&&p?c.getActionHandler(r,l,c):t.controlsUtils.dragHandler,_=this._getActionFromCorner(a,p,r,l),b=this._getOriginFromCorner(l,p),y=r[this.centeredKey],x={target:l,action:_,actionHandler:m,corner:p,scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY,offsetX:d.x-l.left,offsetY:d.y-l.top,originX:b.x,originY:b.y,ex:d.x,ey:d.y,lastX:d.x,lastY:d.y,theta:n(l.angle),width:l.width*l.scaleX,shiftKey:r.shiftKey,altKey:y,original:t.util.saveObjectTransform(l)};this._shouldCenterTransform(l,_,y)&&(x.originX="center",x.originY="center"),x.original.originX=b.x,x.original.originY=b.y,this._currentTransform=x,this._beforeTransform(r)}},setCursor:function(r){this.upperCanvasEl.style.cursor=r},_drawSelection:function(r){var l=this._groupSelector,a=new t.Point(l.ex,l.ey),d=t.util.transformPoint(a,this.viewportTransform),p=new t.Point(l.ex+l.left,l.ey+l.top),c=t.util.transformPoint(p,this.viewportTransform),m=Math.min(d.x,c.x),_=Math.min(d.y,c.y),b=Math.max(d.x,c.x),y=Math.max(d.y,c.y),x=this.selectionLineWidth/2;this.selectionColor&&(r.fillStyle=this.selectionColor,r.fillRect(m,_,b-m,y-_)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(r.lineWidth=this.selectionLineWidth,r.strokeStyle=this.selectionBorderColor,m+=x,_+=x,b-=x,y-=x,t.Object.prototype._setLineDash.call(this,r,this.selectionDashArray),r.strokeRect(m,_,b-m,y-_))},findTarget:function(r,l){if(!this.skipTargetFind){var a=!0,d=this.getPointer(r,a),p=this._activeObject,c=this.getActiveObjects(),m,_,b=h(r),y=c.length>1&&!l||c.length===1;if(this.targets=[],y&&p._findTargetCorner(d,b)||c.length>1&&!l&&p===this._searchPossibleTargets([p],d))return p;if(c.length===1&&p===this._searchPossibleTargets([p],d))if(this.preserveObjectStacking)m=p,_=this.targets,this.targets=[];else return p;var x=this._searchPossibleTargets(this._objects,d);return r[this.altSelectionKey]&&x&&m&&x!==m&&(x=m,this.targets=_),x}},_checkTarget:function(r,l,a){if(l&&l.visible&&l.evented&&l.containsPoint(r))if((this.perPixelTargetFind||l.perPixelTargetFind)&&!l.isEditing){var d=this.isTargetTransparent(l,a.x,a.y);if(!d)return!0}else return!0},_searchPossibleTargets:function(r,l){for(var a,d=r.length,p;d--;){var c=r[d],m=c.group?this._normalizePointer(c.group,l):l;if(this._checkTarget(m,c,l)){a=r[d],a.subTargetCheck&&a instanceof t.Group&&(p=this._searchPossibleTargets(a._objects,l),p&&this.targets.push(p));break}}return a},restorePointerVpt:function(r){return t.util.transformPoint(r,t.util.invertTransform(this.viewportTransform))},getPointer:function(r,l){if(this._absolutePointer&&!l)return this._absolutePointer;if(this._pointer&&l)return this._pointer;var a=o(r),d=this.upperCanvasEl,p=d.getBoundingClientRect(),c=p.width||0,m=p.height||0,_;(!c||!m)&&("top"in p&&"bottom"in p&&(m=Math.abs(p.top-p.bottom)),"right"in p&&"left"in p&&(c=Math.abs(p.right-p.left))),this.calcOffset(),a.x=a.x-this._offset.left,a.y=a.y-this._offset.top,l||(a=this.restorePointerVpt(a));var b=this.getRetinaScaling();return b!==1&&(a.x/=b,a.y/=b),c===0||m===0?_={width:1,height:1}:_={width:d.width/c,height:d.height/m},{x:a.x*_.width,y:a.y*_.height}},_createUpperCanvas:function(){var r=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),l=this.lowerCanvasEl,a=this.upperCanvasEl;a?a.className="":(a=this._createCanvasElement(),this.upperCanvasEl=a),t.util.addClass(a,"upper-canvas "+r),this.wrapperEl.appendChild(a),this._copyCanvasStyle(l,a),this._applyCanvasStyle(a),this.contextTop=a.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(r){var l=this.width||r.width,a=this.height||r.height;t.util.setStyle(r,{position:"absolute",width:l+"px",height:a+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),r.width=l,r.height=a,t.util.makeElementUnselectable(r)},_copyCanvasStyle:function(r,l){l.style.cssText=r.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var r=this._activeObject;return r?r.type==="activeSelection"&&r._objects?r._objects.slice(0):[r]:[]},_onObjectRemoved:function(r){r===this._activeObject&&(this.fire("before:selection:cleared",{target:r}),this._discardActiveObject(),this.fire("selection:cleared",{target:r}),r.fire("deselected")),r===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",r)},_fireSelectionEvents:function(r,l){var a=!1,d=this.getActiveObjects(),p=[],c=[];r.forEach(function(m){d.indexOf(m)===-1&&(a=!0,m.fire("deselected",{e:l,target:m}),c.push(m))}),d.forEach(function(m){r.indexOf(m)===-1&&(a=!0,m.fire("selected",{e:l,target:m}),p.push(m))}),r.length>0&&d.length>0?a&&this.fire("selection:updated",{e:l,selected:p,deselected:c}):d.length>0?this.fire("selection:created",{e:l,selected:p}):r.length>0&&this.fire("selection:cleared",{e:l,deselected:c})},setActiveObject:function(r,l){var a=this.getActiveObjects();return this._setActiveObject(r,l),this._fireSelectionEvents(a,l),this},_setActiveObject:function(r,l){return this._activeObject===r||!this._discardActiveObject(l,r)||r.onSelect({e:l})?!1:(this._activeObject=r,!0)},_discardActiveObject:function(r,l){var a=this._activeObject;if(a){if(a.onDeselect({e:r,object:l}))return!1;this._activeObject=null}return!0},discardActiveObject:function(r){var l=this.getActiveObjects(),a=this.getActiveObject();return l.length&&this.fire("before:selection:cleared",{target:a,e:r}),this._discardActiveObject(r),this._fireSelectionEvents(l,r),this},dispose:function(){var r=this.wrapperEl;return this.removeListeners(),r.removeChild(this.upperCanvasEl),r.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(l){t.util.cleanUpJsdomNode(this[l]),this[l]=void 0}).bind(this)),r.parentNode&&r.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(r){var l=this._activeObject;l&&l._renderControls(r)},_toObject:function(r,l,a){var d=this._realizeGroupTransformOnObject(r),p=this.callSuper("_toObject",r,l,a);return this._unwindGroupTransformOnObject(r,d),p},_realizeGroupTransformOnObject:function(r){if(r.group&&r.group.type==="activeSelection"&&this._activeObject===r.group){var l=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],a={};return l.forEach(function(d){a[d]=r[d]}),t.util.addTransformToObject(r,this._activeObject.calcOwnMatrix()),a}else return null},_unwindGroupTransformOnObject:function(r,l){l&&r.set(l)},_setSVGObject:function(r,l,a){var d=this._realizeGroupTransformOnObject(l);this.callSuper("_setSVGObject",r,l,a),this._unwindGroupTransformOnObject(l,d)},setViewportTransform:function(r){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,r)}});for(var f in t.StaticCanvas)f!=="prototype"&&(t.Canvas[f]=t.StaticCanvas[f])}(),function(){var o=t.util.addListener,n=t.util.removeListener,h=3,f=2,r=1,l={passive:!1};function a(d,p){return d.button&&d.button===p-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(o,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(d,p){var c=this.upperCanvasEl,m=this._getEventPrefix();d(t.window,"resize",this._onResize),d(c,m+"down",this._onMouseDown),d(c,m+"move",this._onMouseMove,l),d(c,m+"out",this._onMouseOut),d(c,m+"enter",this._onMouseEnter),d(c,"wheel",this._onMouseWheel),d(c,"contextmenu",this._onContextMenu),d(c,"dblclick",this._onDoubleClick),d(c,"dragover",this._onDragOver),d(c,"dragenter",this._onDragEnter),d(c,"dragleave",this._onDragLeave),d(c,"drop",this._onDrop),this.enablePointerEvents||d(c,"touchstart",this._onTouchStart,l),typeof eventjs<"u"&&p in eventjs&&(eventjs[p](c,"gesture",this._onGesture),eventjs[p](c,"drag",this._onDrag),eventjs[p](c,"orientation",this._onOrientationChange),eventjs[p](c,"shake",this._onShake),eventjs[p](c,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(n,"remove");var d=this._getEventPrefix();n(t.document,d+"up",this._onMouseUp),n(t.document,"touchend",this._onTouchEnd,l),n(t.document,d+"move",this._onMouseMove,l),n(t.document,"touchmove",this._onMouseMove,l)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(d,p){this.__onTransformGesture&&this.__onTransformGesture(d,p)},_onDrag:function(d,p){this.__onDrag&&this.__onDrag(d,p)},_onMouseWheel:function(d){this.__onMouseWheel(d)},_onMouseOut:function(d){var p=this._hoveredTarget;this.fire("mouse:out",{target:p,e:d}),this._hoveredTarget=null,p&&p.fire("mouseout",{e:d});var c=this;this._hoveredTargets.forEach(function(m){c.fire("mouse:out",{target:p,e:d}),m&&p.fire("mouseout",{e:d})}),this._hoveredTargets=[]},_onMouseEnter:function(d){!this._currentTransform&&!this.findTarget(d)&&(this.fire("mouse:over",{target:null,e:d}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(d,p){this.__onOrientationChange&&this.__onOrientationChange(d,p)},_onShake:function(d,p){this.__onShake&&this.__onShake(d,p)},_onLongPress:function(d,p){this.__onLongPress&&this.__onLongPress(d,p)},_onDragOver:function(d){d.preventDefault();var p=this._simpleEventHandler("dragover",d);this._fireEnterLeaveEvents(p,d)},_onDrop:function(d){return this._simpleEventHandler("drop:before",d),this._simpleEventHandler("drop",d)},_onContextMenu:function(d){return this.stopContextMenu&&(d.stopPropagation(),d.preventDefault()),!1},_onDoubleClick:function(d){this._cacheTransformEventData(d),this._handleEvent(d,"dblclick"),this._resetTransformEventData(d)},getPointerId:function(d){var p=d.changedTouches;return p?p[0]&&p[0].identifier:this.enablePointerEvents?d.pointerId:-1},_isMainEvent:function(d){return d.isPrimary===!0?!0:d.isPrimary===!1?!1:d.type==="touchend"&&d.touches.length===0?!0:d.changedTouches?d.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(d){d.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(d)),this.__onMouseDown(d),this._resetTransformEventData();var p=this.upperCanvasEl,c=this._getEventPrefix();o(t.document,"touchend",this._onTouchEnd,l),o(t.document,"touchmove",this._onMouseMove,l),n(p,c+"down",this._onMouseDown)},_onMouseDown:function(d){this.__onMouseDown(d),this._resetTransformEventData();var p=this.upperCanvasEl,c=this._getEventPrefix();n(p,c+"move",this._onMouseMove,l),o(t.document,c+"up",this._onMouseUp),o(t.document,c+"move",this._onMouseMove,l)},_onTouchEnd:function(d){if(!(d.touches.length>0)){this.__onMouseUp(d),this._resetTransformEventData(),this.mainTouchId=null;var p=this._getEventPrefix();n(t.document,"touchend",this._onTouchEnd,l),n(t.document,"touchmove",this._onMouseMove,l);var c=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){o(c.upperCanvasEl,p+"down",c._onMouseDown),c._willAddMouseDown=0},400)}},_onMouseUp:function(d){this.__onMouseUp(d),this._resetTransformEventData();var p=this.upperCanvasEl,c=this._getEventPrefix();this._isMainEvent(d)&&(n(t.document,c+"up",this._onMouseUp),n(t.document,c+"move",this._onMouseMove,l),o(p,c+"move",this._onMouseMove,l))},_onMouseMove:function(d){!this.allowTouchScrolling&&d.preventDefault&&d.preventDefault(),this.__onMouseMove(d)},_onResize:function(){this.calcOffset()},_shouldRender:function(d){var p=this._activeObject;return!!p!=!!d||p&&d&&p!==d?!0:(p&&p.isEditing,!1)},__onMouseUp:function(d){var p,c=this._currentTransform,m=this._groupSelector,_=!1,b=!m||m.left===0&&m.top===0;if(this._cacheTransformEventData(d),p=this._target,this._handleEvent(d,"up:before"),a(d,h)){this.fireRightClick&&this._handleEvent(d,"up",h,b);return}if(a(d,f)){this.fireMiddleClick&&this._handleEvent(d,"up",f,b),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(d);return}if(this._isMainEvent(d)){if(c&&(this._finalizeCurrentTransform(d),_=c.actionPerformed),!b){var y=p===this._activeObject;this._maybeGroupObjects(d),_||(_=this._shouldRender(p)||!y&&p===this._activeObject)}var x,C;if(p){if(x=p._findTargetCorner(this.getPointer(d,!0),t.util.isTouchEvent(d)),p.selectable&&p!==this._activeObject&&p.activeOn==="up")this.setActiveObject(p,d),_=!0;else{var T=p.controls[x],k=T&&T.getMouseUpHandler(d,p,T);k&&(C=this.getPointer(d),k(d,c,C.x,C.y))}p.isMoving=!1}if(c&&(c.target!==p||c.corner!==x)){var E=c.target&&c.target.controls[c.corner],z=E&&E.getMouseUpHandler(d,p,T);C=C||this.getPointer(d),z&&z(d,c,C.x,C.y)}this._setCursorFromEvent(d,p),this._handleEvent(d,"up",r,b),this._groupSelector=null,this._currentTransform=null,p&&(p.__corner=0),_?this.requestRenderAll():b||this.renderTop()}},_simpleEventHandler:function(d,p){var c=this.findTarget(p),m=this.targets,_={e:p,target:c,subTargets:m};if(this.fire(d,_),c&&c.fire(d,_),!m)return c;for(var b=0;b<m.length;b++)m[b].fire(d,_);return c},_handleEvent:function(d,p,c,m){var _=this._target,b=this.targets||[],y={e:d,target:_,subTargets:b,button:c||r,isClick:m||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};p==="up"&&(y.currentTarget=this.findTarget(d),y.currentSubTargets=this.targets),this.fire("mouse:"+p,y),_&&_.fire("mouse"+p,y);for(var x=0;x<b.length;x++)b[x].fire("mouse"+p,y)},_finalizeCurrentTransform:function(d){var p=this._currentTransform,c=p.target,m={e:d,target:c,transform:p,action:p.action};c._scaling&&(c._scaling=!1),c.setCoords(),(p.actionPerformed||this.stateful&&c.hasStateChanged())&&this._fire("modified",m)},_onMouseDownInDrawingMode:function(d){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(d).requestRenderAll();var p=this.getPointer(d);this.freeDrawingBrush.onMouseDown(p,{e:d,pointer:p}),this._handleEvent(d,"down")},_onMouseMoveInDrawingMode:function(d){if(this._isCurrentlyDrawing){var p=this.getPointer(d);this.freeDrawingBrush.onMouseMove(p,{e:d,pointer:p})}this.setCursor(this.freeDrawingCursor),this._handleEvent(d,"move")},_onMouseUpInDrawingMode:function(d){var p=this.getPointer(d);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:d,pointer:p}),this._handleEvent(d,"up")},__onMouseDown:function(d){this._cacheTransformEventData(d),this._handleEvent(d,"down:before");var p=this._target;if(a(d,h)){this.fireRightClick&&this._handleEvent(d,"down",h);return}if(a(d,f)){this.fireMiddleClick&&this._handleEvent(d,"down",f);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(d);return}if(this._isMainEvent(d)&&!this._currentTransform){var c=this._pointer;this._previousPointer=c;var m=this._shouldRender(p),_=this._shouldGroup(d,p);if(this._shouldClearSelection(d,p)?this.discardActiveObject(d):_&&(this._handleGrouping(d,p),p=this._activeObject),this.selection&&(!p||!p.selectable&&!p.isEditing&&p!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),p){var b=p===this._activeObject;p.selectable&&p.activeOn==="down"&&this.setActiveObject(p,d);var y=p._findTargetCorner(this.getPointer(d,!0),t.util.isTouchEvent(d));if(p.__corner=y,p===this._activeObject&&(y||!_)){this._setupCurrentTransform(d,p,b);var x=p.controls[y],c=this.getPointer(d),C=x&&x.getMouseDownHandler(d,p,x);C&&C(d,this._currentTransform,c.x,c.y)}}this._handleEvent(d,"down"),(m||_)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(d){this._resetTransformEventData(),this._pointer=this.getPointer(d,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(d)||null},_beforeTransform:function(d){var p=this._currentTransform;this.stateful&&p.target.saveState(),this.fire("before:transform",{e:d,transform:p})},__onMouseMove:function(d){this._handleEvent(d,"move:before"),this._cacheTransformEventData(d);var p,c;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(d);return}if(this._isMainEvent(d)){var m=this._groupSelector;m?(c=this._absolutePointer,m.left=c.x-m.ex,m.top=c.y-m.ey,this.renderTop()):this._currentTransform?this._transformObject(d):(p=this.findTarget(d)||null,this._setCursorFromEvent(d,p),this._fireOverOutEvents(p,d)),this._handleEvent(d,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(d,p){var c=this._hoveredTarget,m=this._hoveredTargets,_=this.targets,b=Math.max(m.length,_.length);this.fireSyntheticInOutEvents(d,p,{oldTarget:c,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var y=0;y<b;y++)this.fireSyntheticInOutEvents(_[y],p,{oldTarget:m[y],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=d,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(d,p){var c=this._draggedoverTarget,m=this._hoveredTargets,_=this.targets,b=Math.max(m.length,_.length);this.fireSyntheticInOutEvents(d,p,{oldTarget:c,evtOut:"dragleave",evtIn:"dragenter"});for(var y=0;y<b;y++)this.fireSyntheticInOutEvents(_[y],p,{oldTarget:m[y],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=d},fireSyntheticInOutEvents:function(d,p,c){var m,_,b=c.oldTarget,y,x,C=b!==d,T=c.canvasEvtIn,k=c.canvasEvtOut;C&&(m={e:p,target:d,previousTarget:b},_={e:p,target:b,nextTarget:d}),x=d&&C,y=b&&C,y&&(k&&this.fire(k,_),b.fire(c.evtOut,_)),x&&(T&&this.fire(T,m),d.fire(c.evtIn,m))},__onMouseWheel:function(d){this._cacheTransformEventData(d),this._handleEvent(d,"wheel"),this._resetTransformEventData()},_transformObject:function(d){var p=this.getPointer(d),c=this._currentTransform;c.reset=!1,c.shiftKey=d.shiftKey,c.altKey=d[this.centeredKey],this._performTransformAction(d,c,p),c.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(d,p,c){var m=c.x,_=c.y,b=p.action,y=!1,x=p.actionHandler;x&&(y=x(d,p,m,_)),b==="drag"&&y&&(p.target.isMoving=!0,this.setCursor(p.target.moveCursor||this.moveCursor)),p.actionPerformed=p.actionPerformed||y},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(d,p){if(!p)return this.setCursor(this.defaultCursor),!1;var c=p.hoverCursor||this.hoverCursor,m=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,_=(!m||!m.contains(p))&&p._findTargetCorner(this.getPointer(d,!0));_?this.setCursor(this.getCornerCursor(_,p,d)):(p.subTargetCheck&&this.targets.concat().reverse().map(function(b){c=b.hoverCursor||c}),this.setCursor(c))},getCornerCursor:function(d,p,c){var m=p.controls[d];return m.cursorStyleHandler(c,m,p)}})}(),function(){var o=Math.min,n=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(h,f){var r=this._activeObject;return r&&this._isSelectionKeyPressed(h)&&f&&f.selectable&&this.selection&&(r!==f||r.type==="activeSelection")&&!f.onSelect({e:h})},_handleGrouping:function(h,f){var r=this._activeObject;r.__corner||f===r&&(f=this.findTarget(h,!0),!f||!f.selectable)||(r&&r.type==="activeSelection"?this._updateActiveSelection(f,h):this._createActiveSelection(f,h))},_updateActiveSelection:function(h,f){var r=this._activeObject,l=r._objects.slice(0);r.contains(h)?(r.removeWithUpdate(h),this._hoveredTarget=h,this._hoveredTargets=this.targets.concat(),r.size()===1&&this._setActiveObject(r.item(0),f)):(r.addWithUpdate(h),this._hoveredTarget=r,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(l,f)},_createActiveSelection:function(h,f){var r=this.getActiveObjects(),l=this._createGroup(h);this._hoveredTarget=l,this._setActiveObject(l,f),this._fireSelectionEvents(r,f)},_createGroup:function(h){var f=this._objects,r=f.indexOf(this._activeObject)<f.indexOf(h),l=r?[this._activeObject,h]:[h,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(l,{canvas:this})},_groupSelectedObjects:function(h){var f=this._collectObjects(h),r;f.length===1?this.setActiveObject(f[0],h):f.length>1&&(r=new t.ActiveSelection(f.reverse(),{canvas:this}),this.setActiveObject(r,h))},_collectObjects:function(h){for(var f=[],r,l=this._groupSelector.ex,a=this._groupSelector.ey,d=l+this._groupSelector.left,p=a+this._groupSelector.top,c=new t.Point(o(l,d),o(a,p)),m=new t.Point(n(l,d),n(a,p)),_=!this.selectionFullyContained,b=l===d&&a===p,y=this._objects.length;y--&&(r=this._objects[y],!(!(!r||!r.selectable||!r.visible)&&(_&&r.intersectsWithRect(c,m,!0)||r.isContainedWithinRect(c,m,!0)||_&&r.containsPoint(c,null,!0)||_&&r.containsPoint(m,null,!0))&&(f.push(r),b))););return f.length>1&&(f=f.filter(function(x){return!x.onSelect({e:h})})),f},_maybeGroupObjects:function(h){this.selection&&this._groupSelector&&this._groupSelectedObjects(h),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(o){o||(o={});var n=o.format||"png",h=o.quality||1,f=(o.multiplier||1)*(o.enableRetinaScaling?this.getRetinaScaling():1),r=this.toCanvasElement(f,o);return t.util.toDataURL(r,n,h)},toCanvasElement:function(o,n){o=o||1,n=n||{};var h=(n.width||this.width)*o,f=(n.height||this.height)*o,r=this.getZoom(),l=this.width,a=this.height,d=r*o,p=this.viewportTransform,c=(p[4]-(n.left||0))*o,m=(p[5]-(n.top||0))*o,_=this.interactive,b=[d,0,0,d,c,m],y=this.enableRetinaScaling,x=t.util.createCanvasElement(),C=this.contextTop;return x.width=h,x.height=f,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=b,this.width=h,this.height=f,this.calcViewportBoundaries(),this.renderCanvas(x.getContext("2d"),this._objects),this.viewportTransform=p,this.width=l,this.height=a,this.calcViewportBoundaries(),this.interactive=_,this.enableRetinaScaling=y,this.contextTop=C,x}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(o,n,h){if(o){var f=typeof o=="string"?JSON.parse(o):t.util.object.clone(o),r=this,l=f.clipPath,a=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete f.clipPath,this._enlivenObjects(f.objects,function(d){r.clear(),r._setBgOverlay(f,function(){l?r._enlivenObjects([l],function(p){r.clipPath=p[0],r.__setupCanvas.call(r,f,d,a,n)}):r.__setupCanvas.call(r,f,d,a,n)})},h),this}},__setupCanvas:function(o,n,h,f){var r=this;n.forEach(function(l,a){r.insertAt(l,a)}),this.renderOnAddRemove=h,delete o.objects,delete o.backgroundImage,delete o.overlayImage,delete o.background,delete o.overlay,this._setOptions(o),this.renderAll(),f&&f()},_setBgOverlay:function(o,n){var h={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!o.backgroundImage&&!o.overlayImage&&!o.background&&!o.overlay){n&&n();return}var f=function(){h.backgroundImage&&h.overlayImage&&h.backgroundColor&&h.overlayColor&&n&&n()};this.__setBgOverlay("backgroundImage",o.backgroundImage,h,f),this.__setBgOverlay("overlayImage",o.overlayImage,h,f),this.__setBgOverlay("backgroundColor",o.background,h,f),this.__setBgOverlay("overlayColor",o.overlay,h,f)},__setBgOverlay:function(o,n,h,f){var r=this;if(!n){h[o]=!0,f&&f();return}o==="backgroundImage"||o==="overlayImage"?t.util.enlivenObjects([n],function(l){r[o]=l[0],h[o]=!0,f&&f()}):this["set"+t.util.string.capitalize(o,!0)](n,function(){h[o]=!0,f&&f()})},_enlivenObjects:function(o,n,h){if(!o||o.length===0){n&&n([]);return}t.util.enlivenObjects(o,function(f){n&&n(f)},null,h)},_toDataURL:function(o,n){this.clone(function(h){n(h.toDataURL(o))})},_toDataURLWithMultiplier:function(o,n,h){this.clone(function(f){h(f.toDataURLWithMultiplier(o,n))})},clone:function(o,n){var h=JSON.stringify(this.toJSON(n));this.cloneWithoutData(function(f){f.loadFromJSON(h,function(){o&&o(f)})})},cloneWithoutData:function(o){var n=t.util.createCanvasElement();n.width=this.width,n.height=this.height;var h=new t.Canvas(n);this.backgroundImage?(h.setBackgroundImage(this.backgroundImage.src,function(){h.renderAll(),o&&o(h)}),h.backgroundImageOpacity=this.backgroundImageOpacity,h.backgroundImageStretch=this.backgroundImageStretch):o&&o(h)}}),function(o){var n=o.fabric||(o.fabric={}),h=n.util.object.extend,f=n.util.object.clone,r=n.util.toFixed,l=n.util.string.capitalize,a=n.util.degreesToRadians,d=!n.isLikelyNode,p=2;n.Object||(n.Object=n.util.createClass(n.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:d,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(c){c&&this.setOptions(c)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=n.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(c){var m=n.perfLimitSizeTotal,_=c.width,b=c.height,y=n.maxCacheSideLimit,x=n.minCacheSideLimit;if(_<=y&&b<=y&&_*b<=m)return _<x&&(c.width=x),b<x&&(c.height=x),c;var C=_/b,T=n.util.limitDimsByArea(C,m),k=n.util.capValue,E=k(x,T.x,y),z=k(x,T.y,y);return _>E&&(c.zoomX/=_/E,c.width=E,c.capped=!0),b>z&&(c.zoomY/=b/z,c.height=z,c.capped=!0),c},_getCacheCanvasDimensions:function(){var c=this.getTotalObjectScaling(),m=this._getTransformedDimensions(0,0),_=m.x*c.scaleX/this.scaleX,b=m.y*c.scaleY/this.scaleY;return{width:_+p,height:b+p,zoomX:c.scaleX,zoomY:c.scaleY,x:_,y:b}},_updateCacheCanvas:function(){var c=this.canvas;if(this.noScaleCache&&c&&c._currentTransform){var m=c._currentTransform.target,_=c._currentTransform.action;if(this===m&&_.slice&&_.slice(0,5)==="scale")return!1}var b=this._cacheCanvas,y=this._limitCacheSize(this._getCacheCanvasDimensions()),x=n.minCacheSideLimit,C=y.width,T=y.height,k,E,z=y.zoomX,N=y.zoomY,$=C!==this.cacheWidth||T!==this.cacheHeight,J=this.zoomX!==z||this.zoomY!==N,K=$||J,G=0,Q=0,tt=!1;if($){var it=this._cacheCanvas.width,w=this._cacheCanvas.height,M=C>it||T>w,D=(C<it*.9||T<w*.9)&&it>x&&w>x;tt=M||D,M&&!y.capped&&(C>x||T>x)&&(G=C*.1,Q=T*.1)}return this instanceof n.Text&&this.path&&(K=!0,tt=!0,G+=this.getHeightOfLine(0)*this.zoomX,Q+=this.getHeightOfLine(0)*this.zoomY),K?(tt?(b.width=Math.ceil(C+G),b.height=Math.ceil(T+Q)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,b.width,b.height)),k=y.x/2,E=y.y/2,this.cacheTranslationX=Math.round(b.width/2-k)+k,this.cacheTranslationY=Math.round(b.height/2-E)+E,this.cacheWidth=C,this.cacheHeight=T,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(z,N),this.zoomX=z,this.zoomY=N,!0):!1},setOptions:function(c){this._setOptions(c),this._initGradient(c.fill,"fill"),this._initGradient(c.stroke,"stroke"),this._initPattern(c.fill,"fill"),this._initPattern(c.stroke,"stroke")},transform:function(c){var m=this.group&&!this.group._transformDone||this.group&&this.canvas&&c===this.canvas.contextTop,_=this.calcTransformMatrix(!m);c.transform(_[0],_[1],_[2],_[3],_[4],_[5])},toObject:function(c){var m=n.Object.NUM_FRACTION_DIGITS,_={type:this.type,version:n.version,originX:this.originX,originY:this.originY,left:r(this.left,m),top:r(this.top,m),width:r(this.width,m),height:r(this.height,m),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,m),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:r(this.strokeMiterLimit,m),scaleX:r(this.scaleX,m),scaleY:r(this.scaleY,m),angle:r(this.angle,m),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,m),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:r(this.skewX,m),skewY:r(this.skewY,m)};return this.clipPath&&!this.clipPath.excludeFromExport&&(_.clipPath=this.clipPath.toObject(c),_.clipPath.inverted=this.clipPath.inverted,_.clipPath.absolutePositioned=this.clipPath.absolutePositioned),n.util.populateWithProperties(this,_,c),this.includeDefaultValues||(_=this._removeDefaultValues(_)),_},toDatalessObject:function(c){return this.toObject(c)},_removeDefaultValues:function(c){var m=n.util.getKlass(c.type).prototype,_=m.stateProperties;return _.forEach(function(b){b==="left"||b==="top"||(c[b]===m[b]&&delete c[b],Array.isArray(c[b])&&Array.isArray(m[b])&&c[b].length===0&&m[b].length===0&&delete c[b])}),c},toString:function(){return"#<fabric."+l(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var c=n.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(c.scaleX),scaleY:Math.abs(c.scaleY)}},getTotalObjectScaling:function(){var c=this.getObjectScaling(),m=c.scaleX,_=c.scaleY;if(this.canvas){var b=this.canvas.getZoom(),y=this.canvas.getRetinaScaling();m*=b*y,_*=b*y}return{scaleX:m,scaleY:_}},getObjectOpacity:function(){var c=this.opacity;return this.group&&(c*=this.group.getObjectOpacity()),c},_set:function(c,m){var _=c==="scaleX"||c==="scaleY",b=this[c]!==m,y=!1;return _&&(m=this._constrainScale(m)),c==="scaleX"&&m<0?(this.flipX=!this.flipX,m*=-1):c==="scaleY"&&m<0?(this.flipY=!this.flipY,m*=-1):c==="shadow"&&m&&!(m instanceof n.Shadow)?m=new n.Shadow(m):c==="dirty"&&this.group&&this.group.set("dirty",m),this[c]=m,b&&(y=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(c)>-1?(this.dirty=!0,y&&this.group.set("dirty",!0)):y&&this.stateProperties.indexOf(c)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:n.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(c){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(c.save(),this._setupCompositeOperation(c),this.drawSelectionBackground(c),this.transform(c),this._setOpacity(c),this._setShadow(c,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(c)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(c),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),c.restore())},renderCache:function(c){c=c||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,c.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(c,m){if(c.save(),m.inverted?c.globalCompositeOperation="destination-out":c.globalCompositeOperation="destination-in",m.absolutePositioned){var _=n.util.invertTransform(this.calcTransformMatrix());c.transform(_[0],_[1],_[2],_[3],_[4],_[5])}m.transform(c),c.scale(1/m.zoomX,1/m.zoomY),c.drawImage(m._cacheCanvas,-m.cacheTranslationX,-m.cacheTranslationY),c.restore()},drawObject:function(c,m){var _=this.fill,b=this.stroke;m?(this.fill="black",this.stroke="",this._setClippingProperties(c)):this._renderBackground(c),this._render(c),this._drawClipPath(c,this.clipPath),this.fill=_,this.stroke=b},_drawClipPath:function(c,m){m&&(m.canvas=this.canvas,m.shouldCache(),m._transformDone=!0,m.renderCache({forClipping:!0}),this.drawClipPathOnCache(c,m))},drawCacheOnCanvas:function(c){c.scale(1/this.zoomX,1/this.zoomY),c.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(c){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!c&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!c){var m=this.cacheWidth/this.zoomX,_=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-m/2,-_/2,m,_)}return!0}return!1},_renderBackground:function(c){if(this.backgroundColor){var m=this._getNonTransformedDimensions();c.fillStyle=this.backgroundColor,c.fillRect(-m.x/2,-m.y/2,m.x,m.y),this._removeShadow(c)}},_setOpacity:function(c){this.group&&!this.group._transformDone?c.globalAlpha=this.getObjectOpacity():c.globalAlpha*=this.opacity},_setStrokeStyles:function(c,m){var _=m.stroke;_&&(c.lineWidth=m.strokeWidth,c.lineCap=m.strokeLineCap,c.lineDashOffset=m.strokeDashOffset,c.lineJoin=m.strokeLineJoin,c.miterLimit=m.strokeMiterLimit,_.toLive?_.gradientUnits==="percentage"||_.gradientTransform||_.patternTransform?this._applyPatternForTransformedGradient(c,_):(c.strokeStyle=_.toLive(c,this),this._applyPatternGradientTransform(c,_)):c.strokeStyle=m.stroke)},_setFillStyles:function(c,m){var _=m.fill;_&&(_.toLive?(c.fillStyle=_.toLive(c,this),this._applyPatternGradientTransform(c,m.fill)):c.fillStyle=_)},_setClippingProperties:function(c){c.globalAlpha=1,c.strokeStyle="transparent",c.fillStyle="#000000"},_setLineDash:function(c,m){!m||m.length===0||(1&m.length&&m.push.apply(m,m),c.setLineDash(m))},_renderControls:function(c,m){var _=this.getViewportTransform(),b=this.calcTransformMatrix(),y,x,C;m=m||{},x=typeof m.hasBorders<"u"?m.hasBorders:this.hasBorders,C=typeof m.hasControls<"u"?m.hasControls:this.hasControls,b=n.util.multiplyTransformMatrices(_,b),y=n.util.qrDecompose(b),c.save(),c.translate(y.translateX,y.translateY),c.lineWidth=1*this.borderScaleFactor,this.group||(c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(y.angle-=180),c.rotate(a(this.group?y.angle:this.angle)),m.forActiveSelection||this.group?x&&this.drawBordersInGroup(c,y,m):x&&this.drawBorders(c,m),C&&this.drawControls(c,m),c.restore()},_setShadow:function(c){if(this.shadow){var m=this.shadow,_=this.canvas,b,y=_&&_.viewportTransform[0]||1,x=_&&_.viewportTransform[3]||1;m.nonScaling?b={scaleX:1,scaleY:1}:b=this.getObjectScaling(),_&&_._isRetinaScaling()&&(y*=n.devicePixelRatio,x*=n.devicePixelRatio),c.shadowColor=m.color,c.shadowBlur=m.blur*n.browserShadowBlurConstant*(y+x)*(b.scaleX+b.scaleY)/4,c.shadowOffsetX=m.offsetX*y*b.scaleX,c.shadowOffsetY=m.offsetY*x*b.scaleY}},_removeShadow:function(c){this.shadow&&(c.shadowColor="",c.shadowBlur=c.shadowOffsetX=c.shadowOffsetY=0)},_applyPatternGradientTransform:function(c,m){if(!m||!m.toLive)return{offsetX:0,offsetY:0};var _=m.gradientTransform||m.patternTransform,b=-this.width/2+m.offsetX||0,y=-this.height/2+m.offsetY||0;return m.gradientUnits==="percentage"?c.transform(this.width,0,0,this.height,b,y):c.transform(1,0,0,1,b,y),_&&c.transform(_[0],_[1],_[2],_[3],_[4],_[5]),{offsetX:b,offsetY:y}},_renderPaintInOrder:function(c){this.paintFirst==="stroke"?(this._renderStroke(c),this._renderFill(c)):(this._renderFill(c),this._renderStroke(c))},_render:function(){},_renderFill:function(c){this.fill&&(c.save(),this._setFillStyles(c,this),this.fillRule==="evenodd"?c.fill("evenodd"):c.fill(),c.restore())},_renderStroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(c),c.save(),this.strokeUniform&&this.group){var m=this.getObjectScaling();c.scale(1/m.scaleX,1/m.scaleY)}else this.strokeUniform&&c.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(c,this.strokeDashArray),this._setStrokeStyles(c,this),c.stroke(),c.restore()}},_applyPatternForTransformedGradient:function(c,m){var _=this._limitCacheSize(this._getCacheCanvasDimensions()),b=n.util.createCanvasElement(),y,x=this.canvas.getRetinaScaling(),C=_.x/this.scaleX/x,T=_.y/this.scaleY/x;b.width=C,b.height=T,y=b.getContext("2d"),y.beginPath(),y.moveTo(0,0),y.lineTo(C,0),y.lineTo(C,T),y.lineTo(0,T),y.closePath(),y.translate(C/2,T/2),y.scale(_.zoomX/this.scaleX/x,_.zoomY/this.scaleY/x),this._applyPatternGradientTransform(y,m),y.fillStyle=m.toLive(c),y.fill(),c.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),c.scale(x*this.scaleX/_.zoomX,x*this.scaleY/_.zoomY),c.strokeStyle=y.createPattern(b,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var c=n.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",c.scaleX),this.set("scaleY",c.scaleY),this.angle=c.angle,this.skewX=c.skewX,this.skewY=0}},_removeTransformMatrix:function(c){var m=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),m=n.util.transformPoint(m,this.transformMatrix)),this.transformMatrix=null,c&&(this.scaleX*=c.scaleX,this.scaleY*=c.scaleY,this.cropX=c.cropX,this.cropY=c.cropY,m.x+=c.offsetLeft,m.y+=c.offsetTop,this.width=c.width,this.height=c.height),this.setPositionByOrigin(m,"center","center")},clone:function(c,m){var _=this.toObject(m);this.constructor.fromObject?this.constructor.fromObject(_,c):n.Object._fromObject("Object",_,c)},cloneAsImage:function(c,m){var _=this.toCanvasElement(m);return c&&c(new n.Image(_)),this},toCanvasElement:function(c){c||(c={});var m=n.util,_=m.saveObjectTransform(this),b=this.group,y=this.shadow,x=Math.abs,C=(c.multiplier||1)*(c.enableRetinaScaling?n.devicePixelRatio:1);delete this.group,c.withoutTransform&&m.resetObjectTransform(this),c.withoutShadow&&(this.shadow=null);var T=n.util.createCanvasElement(),k=this.getBoundingRect(!0,!0),E=this.shadow,z,N={x:0,y:0},$,J,K;E&&($=E.blur,E.nonScaling?z={scaleX:1,scaleY:1}:z=this.getObjectScaling(),N.x=2*Math.round(x(E.offsetX)+$)*x(z.scaleX),N.y=2*Math.round(x(E.offsetY)+$)*x(z.scaleY)),J=k.width+N.x,K=k.height+N.y,T.width=Math.ceil(J),T.height=Math.ceil(K);var G=new n.StaticCanvas(T,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});c.format==="jpeg"&&(G.backgroundColor="#fff"),this.setPositionByOrigin(new n.Point(G.width/2,G.height/2),"center","center");var Q=this.canvas;G.add(this);var tt=G.toCanvasElement(C||1,c);return this.shadow=y,this.set("canvas",Q),b&&(this.group=b),this.set(_).setCoords(),G._objects=[],G.dispose(),G=null,tt},toDataURL:function(c){return c||(c={}),n.util.toDataURL(this.toCanvasElement(c),c.format||"png",c.quality||1)},isType:function(c){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===c},complexity:function(){return 1},toJSON:function(c){return this.toObject(c)},rotate:function(c){var m=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return m&&this._setOriginToCenter(),this.set("angle",c),m&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(c,m){m=m||this.canvas.getPointer(c);var _=new n.Point(m.x,m.y),b=this._getLeftTopCoords();return this.angle&&(_=n.util.rotatePoint(_,b,a(-this.angle))),{x:_.x-b.x,y:_.y-b.y}},_setupCompositeOperation:function(c){this.globalCompositeOperation&&(c.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){n.runningAnimations&&n.runningAnimations.cancelByTarget(this)}}),n.util.createAccessors&&n.util.createAccessors(n.Object),h(n.Object.prototype,n.Observable),n.Object.NUM_FRACTION_DIGITS=2,n.Object.ENLIVEN_PROPS=["clipPath"],n.Object._fromObject=function(c,m,_,b){var y=n[c];m=f(m,!0),n.util.enlivenPatterns([m.fill,m.stroke],function(x){typeof x[0]<"u"&&(m.fill=x[0]),typeof x[1]<"u"&&(m.stroke=x[1]),n.util.enlivenObjectEnlivables(m,m,function(){var C=b?new y(m[b],m):new y(m);_&&_(C)})})},n.Object.__uid=0)}(i),function(){var o=t.util.degreesToRadians,n={left:-.5,center:0,right:.5},h={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(f,r,l,a,d){var p=f.x,c=f.y,m,_,b;return typeof r=="string"?r=n[r]:r-=.5,typeof a=="string"?a=n[a]:a-=.5,m=a-r,typeof l=="string"?l=h[l]:l-=.5,typeof d=="string"?d=h[d]:d-=.5,_=d-l,(m||_)&&(b=this._getTransformedDimensions(),p=f.x+m*b.x,c=f.y+_*b.y),new t.Point(p,c)},translateToCenterPoint:function(f,r,l){var a=this.translateToGivenOrigin(f,r,l,"center","center");return this.angle?t.util.rotatePoint(a,f,o(this.angle)):a},translateToOriginPoint:function(f,r,l){var a=this.translateToGivenOrigin(f,"center","center",r,l);return this.angle?t.util.rotatePoint(a,f,o(this.angle)):a},getCenterPoint:function(){var f=new t.Point(this.left,this.top);return this.translateToCenterPoint(f,this.originX,this.originY)},getPointByOrigin:function(f,r){var l=this.getCenterPoint();return this.translateToOriginPoint(l,f,r)},toLocalPoint:function(f,r,l){var a=this.getCenterPoint(),d,p;return typeof r<"u"&&typeof l<"u"?d=this.translateToGivenOrigin(a,"center","center",r,l):d=new t.Point(this.left,this.top),p=new t.Point(f.x,f.y),this.angle&&(p=t.util.rotatePoint(p,a,-o(this.angle))),p.subtractEquals(d)},setPositionByOrigin:function(f,r,l){var a=this.translateToCenterPoint(f,r,l),d=this.translateToOriginPoint(a,this.originX,this.originY);this.set("left",d.x),this.set("top",d.y)},adjustPosition:function(f){var r=o(this.angle),l=this.getScaledWidth(),a=t.util.cos(r)*l,d=t.util.sin(r)*l,p,c;typeof this.originX=="string"?p=n[this.originX]:p=this.originX-.5,typeof f=="string"?c=n[f]:c=f-.5,this.left+=a*(c-p),this.top+=d*(c-p),this.setCoords(),this.originX=f},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var f=this.getCenterPoint();this.originX="center",this.originY="center",this.left=f.x,this.top=f.y},_resetOrigin:function(){var f=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=f.x,this.top=f.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function o(l){return[new t.Point(l.tl.x,l.tl.y),new t.Point(l.tr.x,l.tr.y),new t.Point(l.br.x,l.br.y),new t.Point(l.bl.x,l.bl.y)]}var n=t.util,h=n.degreesToRadians,f=n.multiplyTransformMatrices,r=n.transformPoint;n.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(l,a){return a?l?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),l?this.aCoords:this.lineCoords)},getCoords:function(l,a){return o(this._getCoords(l,a))},intersectsWithRect:function(l,a,d,p){var c=this.getCoords(d,p),m=t.Intersection.intersectPolygonRectangle(c,l,a);return m.status==="Intersection"},intersectsWithObject:function(l,a,d){var p=t.Intersection.intersectPolygonPolygon(this.getCoords(a,d),l.getCoords(a,d));return p.status==="Intersection"||l.isContainedWithinObject(this,a,d)||this.isContainedWithinObject(l,a,d)},isContainedWithinObject:function(l,a,d){for(var p=this.getCoords(a,d),c=a?l.aCoords:l.lineCoords,m=0,_=l._getImageLines(c);m<4;m++)if(!l.containsPoint(p[m],_))return!1;return!0},isContainedWithinRect:function(l,a,d,p){var c=this.getBoundingRect(d,p);return c.left>=l.x&&c.left+c.width<=a.x&&c.top>=l.y&&c.top+c.height<=a.y},containsPoint:function(l,m,d,p){var c=this._getCoords(d,p),m=m||this._getImageLines(c),_=this._findCrossPoints(l,m);return _!==0&&_%2===1},isOnScreen:function(l){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,d=this.canvas.vptCoords.br,p=this.getCoords(!0,l);return p.some(function(c){return c.x<=d.x&&c.x>=a.x&&c.y<=d.y&&c.y>=a.y})||this.intersectsWithRect(a,d,!0,l)?!0:this._containsCenterOfCanvas(a,d,l)},_containsCenterOfCanvas:function(l,a,d){var p={x:(l.x+a.x)/2,y:(l.y+a.y)/2};return!!this.containsPoint(p,null,!0,d)},isPartiallyOnScreen:function(l){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,d=this.canvas.vptCoords.br;if(this.intersectsWithRect(a,d,!0,l))return!0;var p=this.getCoords(!0,l).every(function(c){return(c.x>=d.x||c.x<=a.x)&&(c.y>=d.y||c.y<=a.y)});return p&&this._containsCenterOfCanvas(a,d,l)},_getImageLines:function(l){var a={topline:{o:l.tl,d:l.tr},rightline:{o:l.tr,d:l.br},bottomline:{o:l.br,d:l.bl},leftline:{o:l.bl,d:l.tl}};return a},_findCrossPoints:function(l,a){var d,p,c,m,_,b=0,y;for(var x in a)if(y=a[x],!(y.o.y<l.y&&y.d.y<l.y)&&!(y.o.y>=l.y&&y.d.y>=l.y)&&(y.o.x===y.d.x&&y.o.x>=l.x?_=y.o.x:(d=0,p=(y.d.y-y.o.y)/(y.d.x-y.o.x),c=l.y-d*l.x,m=y.o.y-p*y.o.x,_=-(c-m)/(d-p)),_>=l.x&&(b+=1),b===2))break;return b},getBoundingRect:function(l,a){var d=this.getCoords(l,a);return n.makeBoundingBoxFromPoints(d)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(l){return Math.abs(l)<this.minScaleLimit?l<0?-this.minScaleLimit:this.minScaleLimit:l===0?1e-4:l},scale:function(l){return this._set("scaleX",l),this._set("scaleY",l),this.setCoords()},scaleToWidth:function(l,a){var d=this.getBoundingRect(a).width/this.getScaledWidth();return this.scale(l/this.width/d)},scaleToHeight:function(l,a){var d=this.getBoundingRect(a).height/this.getScaledHeight();return this.scale(l/this.height/d)},calcLineCoords:function(){var l=this.getViewportTransform(),a=this.padding,d=h(this.angle),p=n.cos(d),c=n.sin(d),m=p*a,_=c*a,b=m+_,y=m-_,x=this.calcACoords(),C={tl:r(x.tl,l),tr:r(x.tr,l),bl:r(x.bl,l),br:r(x.br,l)};return a&&(C.tl.x-=y,C.tl.y-=b,C.tr.x+=b,C.tr.y-=y,C.bl.x-=b,C.bl.y+=y,C.br.x+=y,C.br.y+=b),C},calcOCoords:function(){var l=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),d=this.getViewportTransform(),p=f(d,a),c=f(p,l),c=f(c,[1/d[0],0,0,1/d[3],0,0]),m=this._calculateCurrentDimensions(),_={};return this.forEachControl(function(b,y,x){_[y]=b.positionHandler(m,c,x)}),_},calcACoords:function(){var l=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),d=f(a,l),p=this._getTransformedDimensions(),c=p.x/2,m=p.y/2;return{tl:r({x:-c,y:-m},d),tr:r({x:c,y:-m},d),bl:r({x:-c,y:m},d),br:r({x:c,y:m},d)}},setCoords:function(l){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),l?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return n.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var l=this.getCenterPoint();return[1,0,0,1,l.x,l.y]},transformMatrixKey:function(l){var a="_",d="";return!l&&this.group&&(d=this.group.transformMatrixKey(l)+a),d+this.top+a+this.left+a+this.scaleX+a+this.scaleY+a+this.skewX+a+this.skewY+a+this.angle+a+this.originX+a+this.originY+a+this.width+a+this.height+a+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(l){var a=this.calcOwnMatrix();if(l||!this.group)return a;var d=this.transformMatrixKey(l),p=this.matrixCache||(this.matrixCache={});return p.key===d?p.value:(this.group&&(a=f(this.group.calcTransformMatrix(!1),a)),p.key=d,p.value=a,a)},calcOwnMatrix:function(){var l=this.transformMatrixKey(!0),a=this.ownMatrixCache||(this.ownMatrixCache={});if(a.key===l)return a.value;var d=this._calcTranslateMatrix(),p={angle:this.angle,translateX:d[4],translateY:d[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return a.key=l,a.value=n.composeMatrix(p),a.value},_getNonTransformedDimensions:function(){var l=this.strokeWidth,a=this.width+l,d=this.height+l;return{x:a,y:d}},_getTransformedDimensions:function(l,a){typeof l>"u"&&(l=this.skewX),typeof a>"u"&&(a=this.skewY);var d,p,c,m=l===0&&a===0;if(this.strokeUniform?(p=this.width,c=this.height):(d=this._getNonTransformedDimensions(),p=d.x,c=d.y),m)return this._finalizeDimensions(p*this.scaleX,c*this.scaleY);var _=n.sizeAfterTransform(p,c,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:l,skewY:a});return this._finalizeDimensions(_.x,_.y)},_finalizeDimensions:function(l,a){return this.strokeUniform?{x:l+this.strokeWidth,y:a+this.strokeWidth}:{x:l,y:a}},_calculateCurrentDimensions:function(){var l=this.getViewportTransform(),a=this._getTransformedDimensions(),d=r(a,l,!0);return d.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(o){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,o):this.canvas&&this.canvas.sendBackwards(this,o),this},bringForward:function(o){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,o):this.canvas&&this.canvas.bringForward(this,o),this},moveTo:function(o){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,o):this.canvas&&this.canvas.moveTo(this,o),this}}),function(){function o(h,f){if(f){if(f.toLive)return h+": url(#SVGID_"+f.id+"); ";var r=new t.Color(f),l=h+": "+r.toRgb()+"; ",a=r.getAlpha();return a!==1&&(l+=h+"-opacity: "+a.toString()+"; "),l}else return h+": none; "}var n=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(h){var f=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",l=this.strokeDashArray?this.strokeDashArray.join(" "):"none",a=this.strokeDashOffset?this.strokeDashOffset:"0",d=this.strokeLineCap?this.strokeLineCap:"butt",p=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",m=typeof this.opacity<"u"?this.opacity:"1",_=this.visible?"":" visibility: hidden;",b=h?"":this.getSvgFilter(),y=o("fill",this.fill),x=o("stroke",this.stroke);return[x,"stroke-width: ",r,"; ","stroke-dasharray: ",l,"; ","stroke-linecap: ",d,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",p,"; ","stroke-miterlimit: ",c,"; ",y,"fill-rule: ",f,"; ","opacity: ",m,";",b,_].join("")},getSvgSpanStyles:function(h,f){var r="; ",a=h.fontFamily?"font-family: "+(h.fontFamily.indexOf("'")===-1&&h.fontFamily.indexOf('"')===-1?"'"+h.fontFamily+"'":h.fontFamily)+r:"",l=h.strokeWidth?"stroke-width: "+h.strokeWidth+r:"",a=a,d=h.fontSize?"font-size: "+h.fontSize+"px"+r:"",p=h.fontStyle?"font-style: "+h.fontStyle+r:"",c=h.fontWeight?"font-weight: "+h.fontWeight+r:"",m=h.fill?o("fill",h.fill):"",_=h.stroke?o("stroke",h.stroke):"",b=this.getSvgTextDecoration(h),y=h.deltaY?"baseline-shift: "+-h.deltaY+"; ":"";return b&&(b="text-decoration: "+b+r),[_,l,a,d,p,c,b,m,y,f?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(h){return["overline","underline","line-through"].filter(function(f){return h[f.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(h,f){var r=h?this.calcTransformMatrix():this.calcOwnMatrix(),l='transform="'+t.util.matrixToSVG(r);return l+(f||"")+'" '},_setSVGBg:function(h){if(this.backgroundColor){var f=t.Object.NUM_FRACTION_DIGITS;h.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',n(-this.width/2,f),'" y="',n(-this.height/2,f),'" width="',n(this.width,f),'" height="',n(this.height,f),`"></rect>
`)}},toSVG:function(h){return this._createBaseSVGMarkup(this._toSVG(h),{reviver:h})},toClipPathSVG:function(h){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(h),{reviver:h})},_createBaseClipPathSVGMarkup:function(h,f){f=f||{};var r=f.reviver,l=f.additionalTransform||"",a=[this.getSvgTransform(!0,l),this.getSvgCommons()].join(""),d=h.indexOf("COMMON_PARTS");return h[d]=a,r?r(h.join("")):h.join("")},_createBaseSVGMarkup:function(h,f){f=f||{};var r=f.noStyle,l=f.reviver,a=r?"":'style="'+this.getSvgStyles()+'" ',d=f.withShadow?'style="'+this.getSvgFilter()+'" ':"",p=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",m=p&&p.absolutePositioned,_=this.stroke,b=this.fill,y=this.shadow,x,C=[],T,k=h.indexOf("COMMON_PARTS"),E=f.additionalTransform;return p&&(p.clipPathId="CLIPPATH_"+t.Object.__uid++,T='<clipPath id="'+p.clipPathId+`" >
`+p.toClipPathSVG(l)+`</clipPath>
`),m&&C.push("<g ",d,this.getSvgCommons(),` >
`),C.push("<g ",this.getSvgTransform(!1),m?"":d+this.getSvgCommons(),` >
`),x=[a,c,r?"":this.addPaintOrder()," ",E?'transform="'+E+'" ':""].join(""),h[k]=x,b&&b.toLive&&C.push(b.toSVG(this)),_&&_.toLive&&C.push(_.toSVG(this)),y&&C.push(y.toSVG(this)),p&&C.push(T),C.push(h.join("")),C.push(`</g>
`),m&&C.push(`</g>
`),l?l(C.join("")):C.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var o=t.util.object.extend,n="stateProperties";function h(r,l,a){var d={},p=!0;a.forEach(function(c){d[c]=r[c]}),o(r[l],d,p)}function f(r,l,a){if(r===l)return!0;if(Array.isArray(r)){if(!Array.isArray(l)||r.length!==l.length)return!1;for(var d=0,p=r.length;d<p;d++)if(!f(r[d],l[d]))return!1;return!0}else if(r&&typeof r=="object"){var c=Object.keys(r),m;if(!l||typeof l!="object"||!a&&c.length!==Object.keys(l).length)return!1;for(var d=0,p=c.length;d<p;d++)if(m=c[d],!(m==="canvas"||m==="group")&&!f(r[m],l[m]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(r){r=r||n;var l="_"+r;return Object.keys(this[l]).length<this[r].length?!0:!f(this[l],this,!0)},saveState:function(r){var l=r&&r.propertySet||n,a="_"+l;return this[a]?(h(this,a,this[l]),r&&r.stateProperties&&h(this,a,r.stateProperties),this):this.setupState(r)},setupState:function(r){r=r||{};var l=r.propertySet||n;return r.propertySet=l,this["_"+l]={},this.saveState(r),this}})}(),function(){var o=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(n,h){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var f=n.x,r=n.y,l,a,d=Object.keys(this.oCoords),p=d.length-1,c;for(this.__corner=0;p>=0;p--)if(c=d[p],!!this.isControlVisible(c)&&(a=this._getImageLines(h?this.oCoords[c].touchCorner:this.oCoords[c].corner),l=this._findCrossPoints({x:f,y:r},a),l!==0&&l%2===1))return this.__corner=c,c;return!1},forEachControl:function(n){for(var h in this.controls)n(this.controls[h],h,this)},_setCornerCoords:function(){var n=this.oCoords;for(var h in n){var f=this.controls[h];n[h].corner=f.calcCornerCoords(this.angle,this.cornerSize,n[h].x,n[h].y,!1),n[h].touchCorner=f.calcCornerCoords(this.angle,this.touchCornerSize,n[h].x,n[h].y,!0)}},drawSelectionBackground:function(n){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;n.save();var h=this.getCenterPoint(),f=this._calculateCurrentDimensions(),r=this.canvas.viewportTransform;return n.translate(h.x,h.y),n.scale(1/r[0],1/r[3]),n.rotate(o(this.angle)),n.fillStyle=this.selectionBackgroundColor,n.fillRect(-f.x/2,-f.y/2,f.x,f.y),n.restore(),this},drawBorders:function(n,h){h=h||{};var f=this._calculateCurrentDimensions(),r=this.borderScaleFactor,l=f.x+r,a=f.y+r,d=typeof h.hasControls<"u"?h.hasControls:this.hasControls,p=!1;return n.save(),n.strokeStyle=h.borderColor||this.borderColor,this._setLineDash(n,h.borderDashArray||this.borderDashArray),n.strokeRect(-l/2,-a/2,l,a),d&&(n.beginPath(),this.forEachControl(function(c,m,_){c.withConnection&&c.getVisibility(_,m)&&(p=!0,n.moveTo(c.x*l,c.y*a),n.lineTo(c.x*l+c.offsetX,c.y*a+c.offsetY))}),p&&n.stroke()),n.restore(),this},drawBordersInGroup:function(n,h,f){f=f||{};var r=t.util.sizeAfterTransform(this.width,this.height,h),l=this.strokeWidth,a=this.strokeUniform,d=this.borderScaleFactor,p=r.x+l*(a?this.canvas.getZoom():h.scaleX)+d,c=r.y+l*(a?this.canvas.getZoom():h.scaleY)+d;return n.save(),this._setLineDash(n,f.borderDashArray||this.borderDashArray),n.strokeStyle=f.borderColor||this.borderColor,n.strokeRect(-p/2,-c/2,p,c),n.restore(),this},drawControls:function(n,h){h=h||{},n.save();var f=this.canvas.getRetinaScaling(),r,l;return n.setTransform(f,0,0,f,0,0),n.strokeStyle=n.fillStyle=h.cornerColor||this.cornerColor,this.transparentCorners||(n.strokeStyle=h.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(n,h.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(r=this.group.calcTransformMatrix()),this.forEachControl(function(a,d,p){l=p.oCoords[d],a.getVisibility(p,d)&&(r&&(l=t.util.transformPoint(l,r)),a.render(n,l.x,l.y,h,p))}),n.restore(),this},isControlVisible:function(n){return this.controls[n]&&this.controls[n].getVisibility(this,n)},setControlVisible:function(n,h){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[n]=h,this},setControlsVisibility:function(n){n||(n={});for(var h in n)this.setControlVisible(h,n[h]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(o,n){n=n||{};var h=function(){},f=n.onComplete||h,r=n.onChange||h,l=this;return t.util.animate({target:this,startValue:o.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(a){o.set("left",a),l.requestRenderAll(),r()},onComplete:function(){o.setCoords(),f()}})},fxCenterObjectV:function(o,n){n=n||{};var h=function(){},f=n.onComplete||h,r=n.onChange||h,l=this;return t.util.animate({target:this,startValue:o.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(a){o.set("top",a),l.requestRenderAll(),r()},onComplete:function(){o.setCoords(),f()}})},fxRemove:function(o,n){n=n||{};var h=function(){},f=n.onComplete||h,r=n.onChange||h,l=this;return t.util.animate({target:this,startValue:o.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(a){o.set("opacity",a),l.requestRenderAll(),r()},onComplete:function(){l.remove(o),f()}})}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var o=[],n,h,f=[];for(n in arguments[0])o.push(n);for(var r=0,l=o.length;r<l;r++)n=o[r],h=r!==l-1,f.push(this._animate(n,arguments[0][n],arguments[1],h));return f}else return this._animate.apply(this,arguments)},_animate:function(o,n,h,f){var r=this,l;n=n.toString(),h?h=t.util.object.clone(h):h={},~o.indexOf(".")&&(l=o.split("."));var a=r.colorProperties.indexOf(o)>-1||l&&r.colorProperties.indexOf(l[1])>-1,d=l?this.get(l[0])[l[1]]:this.get(o);"from"in h||(h.from=d),a||(~n.indexOf("=")?n=d+parseFloat(n.replace("=","")):n=parseFloat(n));var p={target:this,startValue:h.from,endValue:n,byValue:h.by,easing:h.easing,duration:h.duration,abort:h.abort&&function(c,m,_){return h.abort.call(r,c,m,_)},onChange:function(c,m,_){l?r[l[0]][l[1]]=c:r.set(o,c),!f&&h.onChange&&h.onChange(c,m,_)},onComplete:function(c,m,_){f||(r.setCoords(),h.onComplete&&h.onComplete(c,m,_))}};return a?t.util.animateColor(p.startValue,p.endValue,p.duration,p):t.util.animate(p)}}),function(o){var n=o.fabric||(o.fabric={}),h=n.util.object.extend,f=n.util.object.clone,r={x1:1,x2:1,y1:1,y2:1};if(n.Line){n.warn("fabric.Line is already defined");return}n.Line=n.util.createClass(n.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:n.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(a,d){a||(a=[0,0,0,0]),this.callSuper("initialize",d),this.set("x1",a[0]),this.set("y1",a[1]),this.set("x2",a[2]),this.set("y2",a[3]),this._setWidthHeight(d)},_setWidthHeight:function(a){a||(a={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in a?a.left:this._getLeftToOriginX(),this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,d){return this.callSuper("_set",a,d),typeof r[a]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:l({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:l({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a){a.beginPath();var d=this.calcLinePoints();a.moveTo(d.x1,d.y1),a.lineTo(d.x2,d.y2),a.lineWidth=this.strokeWidth;var p=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle,this.stroke&&this._renderStroke(a),a.strokeStyle=p},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(a){return h(this.callSuper("toObject",a),this.calcLinePoints())},_getNonTransformedDimensions:function(){var a=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(a.y-=this.strokeWidth),this.height===0&&(a.x-=this.strokeWidth)),a},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,d=this.y1<=this.y2?-1:1,p=a*this.width*.5,c=d*this.height*.5,m=a*this.width*-.5,_=d*this.height*-.5;return{x1:p,x2:m,y1:c,y2:_}},_toSVG:function(){var a=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`" />
`]}}),n.Line.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),n.Line.fromElement=function(a,d,p){p=p||{};var c=n.parseAttributes(a,n.Line.ATTRIBUTE_NAMES),m=[c.x1||0,c.y1||0,c.x2||0,c.y2||0];d(new n.Line(m,h(c,p)))},n.Line.fromObject=function(a,d){function p(m){delete m.points,d&&d(m)}var c=f(a,!0);c.points=[a.x1,a.y1,a.x2,a.y2],n.Object._fromObject("Line",c,p,"points")};function l(a,d){var p=a.origin,c=a.axis1,m=a.axis2,_=a.dimension,b=d.nearest,y=d.center,x=d.farthest;return function(){switch(this.get(p)){case b:return Math.min(this.get(c),this.get(m));case y:return Math.min(this.get(c),this.get(m))+.5*this.get(_);case x:return Math.max(this.get(c),this.get(m))}}}}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.degreesToRadians;if(n.Circle){n.warn("fabric.Circle is already defined.");return}n.Circle=n.util.createClass(n.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:n.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(r,l){return this.callSuper("_set",r,l),r==="radius"&&this.setRadius(l),this},toObject:function(r){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(r))},_toSVG:function(){var r,l=0,a=0,d=(this.endAngle-this.startAngle)%360;if(d===0)r=["<circle ","COMMON_PARTS",'cx="'+l+'" cy="'+a+'" ','r="',this.radius,`" />
`];else{var p=h(this.startAngle),c=h(this.endAngle),m=this.radius,_=n.util.cos(p)*m,b=n.util.sin(p)*m,y=n.util.cos(c)*m,x=n.util.sin(c)*m,C=d>180?"1":"0";r=['<path d="M '+_+" "+b," A "+m+" "+m," 0 ",+C+" 1"," "+y+" "+x,'" ',"COMMON_PARTS",` />
`]}return r},_render:function(r){r.beginPath(),r.arc(0,0,this.radius,h(this.startAngle),h(this.endAngle),!1),this._renderPaintInOrder(r)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(r){return this.radius=r,this.set("width",r*2).set("height",r*2)}}),n.Circle.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),n.Circle.fromElement=function(r,l){var a=n.parseAttributes(r,n.Circle.ATTRIBUTE_NAMES);if(!f(a))throw new Error("value of `r` attribute is required and can not be negative");a.left=(a.left||0)-a.radius,a.top=(a.top||0)-a.radius,l(new n.Circle(a))};function f(r){return"radius"in r&&r.radius>=0}n.Circle.fromObject=function(r,l){n.Object._fromObject("Circle",r,l)}}(i),function(o){var n=o.fabric||(o.fabric={});if(n.Triangle){n.warn("fabric.Triangle is already defined");return}n.Triangle=n.util.createClass(n.Object,{type:"triangle",width:100,height:100,_render:function(h){var f=this.width/2,r=this.height/2;h.beginPath(),h.moveTo(-f,r),h.lineTo(0,-r),h.lineTo(f,r),h.closePath(),this._renderPaintInOrder(h)},_toSVG:function(){var h=this.width/2,f=this.height/2,r=[-h+" "+f,"0 "+-f,h+" "+f].join(",");return["<polygon ","COMMON_PARTS",'points="',r,'" />']}}),n.Triangle.fromObject=function(h,f){return n.Object._fromObject("Triangle",h,f)}}(i),function(o){var n=o.fabric||(o.fabric={}),h=Math.PI*2;if(n.Ellipse){n.warn("fabric.Ellipse is already defined.");return}n.Ellipse=n.util.createClass(n.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:n.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this.set("rx",f&&f.rx||0),this.set("ry",f&&f.ry||0)},_set:function(f,r){switch(this.callSuper("_set",f,r),f){case"rx":this.rx=r,this.set("width",r*2);break;case"ry":this.ry=r,this.set("height",r*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(f){f.beginPath(),f.save(),f.transform(1,0,0,this.ry/this.rx,0,0),f.arc(0,0,this.rx,0,h,!1),f.restore(),this._renderPaintInOrder(f)}}),n.Ellipse.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),n.Ellipse.fromElement=function(f,r){var l=n.parseAttributes(f,n.Ellipse.ATTRIBUTE_NAMES);l.left=(l.left||0)-l.rx,l.top=(l.top||0)-l.ry,r(new n.Ellipse(l))},n.Ellipse.fromObject=function(f,r){n.Object._fromObject("Ellipse",f,r)}}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.object.extend;if(n.Rect){n.warn("fabric.Rect is already defined");return}n.Rect=n.util.createClass(n.Object,{stateProperties:n.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:n.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(f){var r=this.rx?Math.min(this.rx,this.width/2):0,l=this.ry?Math.min(this.ry,this.height/2):0,a=this.width,d=this.height,p=-this.width/2,c=-this.height/2,m=r!==0||l!==0,_=1-.5522847498;f.beginPath(),f.moveTo(p+r,c),f.lineTo(p+a-r,c),m&&f.bezierCurveTo(p+a-_*r,c,p+a,c+_*l,p+a,c+l),f.lineTo(p+a,c+d-l),m&&f.bezierCurveTo(p+a,c+d-_*l,p+a-_*r,c+d,p+a-r,c+d),f.lineTo(p+r,c+d),m&&f.bezierCurveTo(p+_*r,c+d,p,c+d-_*l,p,c+d-l),f.lineTo(p,c+l),m&&f.bezierCurveTo(p,c+_*l,p+_*r,c,p+r,c),f.closePath(),this._renderPaintInOrder(f)},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){var f=-this.width/2,r=-this.height/2;return["<rect ","COMMON_PARTS",'x="',f,'" y="',r,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),n.Rect.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),n.Rect.fromElement=function(f,r,l){if(!f)return r(null);l=l||{};var a=n.parseAttributes(f,n.Rect.ATTRIBUTE_NAMES);a.left=a.left||0,a.top=a.top||0,a.height=a.height||0,a.width=a.width||0;var d=new n.Rect(h(l?n.util.object.clone(l):{},a));d.visible=d.visible&&d.width>0&&d.height>0,r(d)},n.Rect.fromObject=function(f,r){return n.Object._fromObject("Rect",f,r)}}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.object.extend,f=n.util.array.min,r=n.util.array.max,l=n.util.toFixed,a=n.util.projectStrokeOnPoints;if(n.Polyline){n.warn("fabric.Polyline is already defined");return}n.Polyline=n.util.createClass(n.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:n.Object.prototype.cacheProperties.concat("points"),initialize:function(d,p){p=p||{},this.points=d||[],this.callSuper("initialize",p),this._setPositionDimensions(p)},_projectStrokeOnPoints:function(){return a(this.points,this,!0)},_setPositionDimensions:function(d){var p=this._calcDimensions(d),c,m=this.exactBoundingBox?this.strokeWidth:0;this.width=p.width-m,this.height=p.height-m,d.fromSVG||(c=this.translateToGivenOrigin({x:p.left-this.strokeWidth/2+m/2,y:p.top-this.strokeWidth/2+m/2},"left","top",this.originX,this.originY)),typeof d.left>"u"&&(this.left=d.fromSVG?p.left:c.x),typeof d.top>"u"&&(this.top=d.fromSVG?p.top:c.y),this.pathOffset={x:p.left+this.width/2+m/2,y:p.top+this.height/2+m/2}},_calcDimensions:function(){var d=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,p=f(d,"x")||0,c=f(d,"y")||0,m=r(d,"x")||0,_=r(d,"y")||0,b=m-p,y=_-c;return{left:p,top:c,width:b,height:y}},toObject:function(d){return h(this.callSuper("toObject",d),{points:this.points.concat()})},_toSVG:function(){for(var d=[],p=this.pathOffset.x,c=this.pathOffset.y,m=n.Object.NUM_FRACTION_DIGITS,_=0,b=this.points.length;_<b;_++)d.push(l(this.points[_].x-p,m),",",l(this.points[_].y-c,m)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',d.join(""),`" />
`]},commonRender:function(d){var p,c=this.points.length,m=this.pathOffset.x,_=this.pathOffset.y;if(!c||isNaN(this.points[c-1].y))return!1;d.beginPath(),d.moveTo(this.points[0].x-m,this.points[0].y-_);for(var b=0;b<c;b++)p=this.points[b],d.lineTo(p.x-m,p.y-_);return!0},_render:function(d){this.commonRender(d)&&this._renderPaintInOrder(d)},complexity:function(){return this.get("points").length}}),n.Polyline.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat(),n.Polyline.fromElementGenerator=function(d){return function(p,c,m){if(!p)return c(null);m||(m={});var _=n.parsePointsAttribute(p.getAttribute("points")),b=n.parseAttributes(p,n[d].ATTRIBUTE_NAMES);b.fromSVG=!0,c(new n[d](_,h(b,m)))}},n.Polyline.fromElement=n.Polyline.fromElementGenerator("Polyline"),n.Polyline.fromObject=function(d,p){return n.Object._fromObject("Polyline",d,p,"points")}}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.projectStrokeOnPoints;if(n.Polygon){n.warn("fabric.Polygon is already defined");return}n.Polygon=n.util.createClass(n.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return h(this.points,this)},_render:function(f){this.commonRender(f)&&(f.closePath(),this._renderPaintInOrder(f))}}),n.Polygon.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat(),n.Polygon.fromElement=n.Polyline.fromElementGenerator("Polygon"),n.Polygon.fromObject=function(f,r){n.Object._fromObject("Polygon",f,r,"points")}}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.array.min,f=n.util.array.max,r=n.util.object.extend,l=n.util.object.clone,a=n.util.toFixed;if(n.Path){n.warn("fabric.Path is already defined");return}n.Path=n.util.createClass(n.Object,{type:"path",path:null,cacheProperties:n.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:n.Object.prototype.stateProperties.concat("path"),initialize:function(d,p){p=l(p||{}),delete p.path,this.callSuper("initialize",p),this._setPath(d||[],p)},_setPath:function(d,p){this.path=n.util.makePathSimpler(Array.isArray(d)?d:n.util.parsePath(d)),n.Polyline.prototype._setPositionDimensions.call(this,p||{})},_renderPathCommands:function(d){var p,c=0,m=0,_=0,b=0,y=0,x=0,C=-this.pathOffset.x,T=-this.pathOffset.y;d.beginPath();for(var k=0,E=this.path.length;k<E;++k)switch(p=this.path[k],p[0]){case"L":_=p[1],b=p[2],d.lineTo(_+C,b+T);break;case"M":_=p[1],b=p[2],c=_,m=b,d.moveTo(_+C,b+T);break;case"C":_=p[5],b=p[6],y=p[3],x=p[4],d.bezierCurveTo(p[1]+C,p[2]+T,y+C,x+T,_+C,b+T);break;case"Q":d.quadraticCurveTo(p[1]+C,p[2]+T,p[3]+C,p[4]+T),_=p[3],b=p[4],y=p[1],x=p[2];break;case"z":case"Z":_=c,b=m,d.closePath();break}},_render:function(d){this._renderPathCommands(d),this._renderPaintInOrder(d)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(d){return r(this.callSuper("toObject",d),{path:this.path.map(function(p){return p.slice()})})},toDatalessObject:function(d){var p=this.toObject(["sourcePath"].concat(d));return p.sourcePath&&delete p.path,p},_toSVG:function(){var d=n.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',d,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var d=n.Object.NUM_FRACTION_DIGITS;return" translate("+a(-this.pathOffset.x,d)+", "+a(-this.pathOffset.y,d)+")"},toClipPathSVG:function(d){var p=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:d,additionalTransform:p})},toSVG:function(d){var p=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:d,additionalTransform:p})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var d=[],p=[],c,m=0,_=0,b=0,y=0,x,C=0,T=this.path.length;C<T;++C){switch(c=this.path[C],c[0]){case"L":b=c[1],y=c[2],x=[];break;case"M":b=c[1],y=c[2],m=b,_=y,x=[];break;case"C":x=n.util.getBoundsOfCurve(b,y,c[1],c[2],c[3],c[4],c[5],c[6]),b=c[5],y=c[6];break;case"Q":x=n.util.getBoundsOfCurve(b,y,c[1],c[2],c[1],c[2],c[3],c[4]),b=c[3],y=c[4];break;case"z":case"Z":b=m,y=_;break}x.forEach(function(K){d.push(K.x),p.push(K.y)}),d.push(b),p.push(y)}var k=h(d)||0,E=h(p)||0,z=f(d)||0,N=f(p)||0,$=z-k,J=N-E;return{left:k,top:E,width:$,height:J}}}),n.Path.fromObject=function(d,p){if(typeof d.sourcePath=="string"){var c=d.sourcePath;n.loadSVGFromURL(c,function(m){var _=m[0];_.setOptions(d),d.clipPath?n.util.enlivenObjects([d.clipPath],function(b){_.clipPath=b[0],p&&p(_)}):p&&p(_)})}else n.Object._fromObject("Path",d,p,"path")},n.Path.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat(["d"]),n.Path.fromElement=function(d,p,c){var m=n.parseAttributes(d,n.Path.ATTRIBUTE_NAMES);m.fromSVG=!0,p(new n.Path(m.d,r(m,c)))}}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.array.min,f=n.util.array.max;n.Group||(n.Group=n.util.createClass(n.Object,n.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(r,l,a){l=l||{},this._objects=[],a&&this.callSuper("initialize",l),this._objects=r||[];for(var d=this._objects.length;d--;)this._objects[d].group=this;if(a)this._updateObjectsACoords();else{var p=l&&l.centerPoint;l.originX!==void 0&&(this.originX=l.originX),l.originY!==void 0&&(this.originY=l.originY),p||this._calcBounds(),this._updateObjectsCoords(p),delete l.centerPoint,this.callSuper("initialize",l)}this.setCoords()},_updateObjectsACoords:function(){for(var r=!0,l=this._objects.length;l--;)this._objects[l].setCoords(r)},_updateObjectsCoords:function(l){for(var l=l||this.getCenterPoint(),a=this._objects.length;a--;)this._updateObjectCoords(this._objects[a],l)},_updateObjectCoords:function(r,l){var a=r.left,d=r.top,p=!0;r.set({left:a-l.x,top:d-l.y}),r.group=this,r.setCoords(p)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(r){var l=!!this.group;return this._restoreObjectsState(),n.util.resetObjectTransform(this),r&&(l&&n.util.removeTransformFromObject(r,this.group.calcTransformMatrix()),this._objects.push(r),r.group=this,r._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,l?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(r){return this._restoreObjectsState(),n.util.resetObjectTransform(this),this.remove(r),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(r){this.dirty=!0,r.group=this,r._set("canvas",this.canvas)},_onObjectRemoved:function(r){this.dirty=!0,delete r.group},_set:function(r,l){var a=this._objects.length;if(this.useSetOnGroup)for(;a--;)this._objects[a].setOnGroup(r,l);if(r==="canvas")for(;a--;)this._objects[a]._set(r,l);n.Object.prototype._set.call(this,r,l)},toObject:function(r){var l=this.includeDefaultValues,a=this._objects.filter(function(p){return!p.excludeFromExport}).map(function(p){var c=p.includeDefaultValues;p.includeDefaultValues=l;var m=p.toObject(r);return p.includeDefaultValues=c,m}),d=n.Object.prototype.toObject.call(this,r);return d.objects=a,d},toDatalessObject:function(r){var l,a=this.sourcePath;if(a)l=a;else{var d=this.includeDefaultValues;l=this._objects.map(function(c){var m=c.includeDefaultValues;c.includeDefaultValues=d;var _=c.toDatalessObject(r);return c.includeDefaultValues=m,_})}var p=n.Object.prototype.toDatalessObject.call(this,r);return p.objects=l,p},render:function(r){this._transformDone=!0,this.callSuper("render",r),this._transformDone=!1},shouldCache:function(){var r=n.Object.prototype.shouldCache.call(this);if(r){for(var l=0,a=this._objects.length;l<a;l++)if(this._objects[l].willDrawShadow())return this.ownCaching=!1,!1}return r},willDrawShadow:function(){if(n.Object.prototype.willDrawShadow.call(this))return!0;for(var r=0,l=this._objects.length;r<l;r++)if(this._objects[r].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(r){for(var l=0,a=this._objects.length;l<a;l++)this._objects[l].render(r);this._drawClipPath(r,this.clipPath)},isCacheDirty:function(r){if(this.callSuper("isCacheDirty",r))return!0;if(!this.statefullCache)return!1;for(var l=0,a=this._objects.length;l<a;l++)if(this._objects[l].isCacheDirty(!0)){if(this._cacheCanvas){var d=this.cacheWidth/this.zoomX,p=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-d/2,-p/2,d,p)}return!0}return!1},_restoreObjectsState:function(){var r=this.calcOwnMatrix();return this._objects.forEach(function(l){n.util.addTransformToObject(l,r),delete l.group,l.setCoords()}),this},destroy:function(){return this._objects.forEach(function(r){r.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(r){r.dispose&&r.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var r=this._objects,l=this.canvas;this._objects=[];var a=this.toObject();delete a.objects;var d=new n.ActiveSelection([]);return d.set(a),d.type="activeSelection",l.remove(this),r.forEach(function(p){p.group=d,p.dirty=!0,l.add(p)}),d.canvas=l,d._objects=r,l._activeObject=d,d.setCoords(),d}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var r=!0;return this.forEachObject(function(l){l.setCoords(r)}),this},_calcBounds:function(r){for(var l=[],a=[],d,p,c,m=["tr","br","bl","tl"],_=0,b=this._objects.length,y,x=m.length;_<b;++_){for(d=this._objects[_],c=d.calcACoords(),y=0;y<x;y++)p=m[y],l.push(c[p].x),a.push(c[p].y);d.aCoords=c}this._getBounds(l,a,r)},_getBounds:function(r,l,a){var d=new n.Point(h(r),h(l)),p=new n.Point(f(r),f(l)),c=d.y||0,m=d.x||0,_=p.x-d.x||0,b=p.y-d.y||0;this.width=_,this.height=b,a||this.setPositionByOrigin({x:m,y:c},"left","top")},_toSVG:function(r){for(var l=["<g ","COMMON_PARTS",` >
`],a=0,d=this._objects.length;a<d;a++)l.push("		",this._objects[a].toSVG(r));return l.push(`</g>
`),l},getSvgStyles:function(){var r=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",l=this.visible?"":" visibility: hidden;";return[r,this.getSvgFilter(),l].join("")},toClipPathSVG:function(r){for(var l=[],a=0,d=this._objects.length;a<d;a++)l.push("	",this._objects[a].toClipPathSVG(r));return this._createBaseClipPathSVGMarkup(l,{reviver:r})}}),n.Group.fromObject=function(r,l){var a=r.objects,d=n.util.object.clone(r,!0);if(delete d.objects,typeof a=="string"){n.loadSVGFromURL(a,function(p){var c=n.util.groupSVGElements(p,r,a),m=d.clipPath;delete d.clipPath,c.set(d),m?n.util.enlivenObjects([m],function(_){c.clipPath=_[0],l&&l(c)}):l&&l(c)});return}n.util.enlivenObjects(a,function(p){n.util.enlivenObjectEnlivables(r,d,function(){l&&l(new n.Group(p,d,!0))})})})}(i),function(o){var n=o.fabric||(o.fabric={});n.ActiveSelection||(n.ActiveSelection=n.util.createClass(n.Group,{type:"activeSelection",initialize:function(h,f){f=f||{},this._objects=h||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;f.originX&&(this.originX=f.originX),f.originY&&(this.originY=f.originY),this._calcBounds(),this._updateObjectsCoords(),n.Object.prototype.initialize.call(this,f),this.setCoords()},toGroup:function(){var h=this._objects.concat();this._objects=[];var f=n.Object.prototype.toObject.call(this),r=new n.Group([]);if(delete f.type,r.set(f),h.forEach(function(a){a.canvas.remove(a),a.group=r}),r._objects=h,!this.canvas)return r;var l=this.canvas;return l.add(r),l._activeObject=r,r.setCoords(),r},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(h,f,r){h.save(),h.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",h,f),r=r||{},typeof r.hasControls>"u"&&(r.hasControls=!1),r.forActiveSelection=!0;for(var l=0,a=this._objects.length;l<a;l++)this._objects[l]._renderControls(h,r);h.restore()}}),n.ActiveSelection.fromObject=function(h,f){n.util.enlivenObjects(h.objects,function(r){delete h.objects,f&&f(new n.ActiveSelection(r,h,!0))})})}(i),function(o){var n=t.util.object.extend;if(o.fabric||(o.fabric={}),o.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(h,f){f||(f={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",f),this._initElement(h,f)},getElement:function(){return this._element||{}},setElement:function(h,f){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=h,this._originalElement=h,this._initConfig(f),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(h){var f=t.filterBackend;f&&f.evictCachesForKey&&f.evictCachesForKey(h)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(h){t.util.cleanUpJsdomNode(this[h]),this[h]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var h=this.getElement();return{width:h.naturalWidth||h.width,height:h.naturalHeight||h.height}},_stroke:function(h){if(!(!this.stroke||this.strokeWidth===0)){var f=this.width/2,r=this.height/2;h.beginPath(),h.moveTo(-f,-r),h.lineTo(f,-r),h.lineTo(f,r),h.lineTo(-f,r),h.lineTo(-f,-r),h.closePath()}},toObject:function(h){var f=[];this.filters.forEach(function(l){l&&f.push(l.toObject())});var r=n(this.callSuper("toObject",["cropX","cropY"].concat(h)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:f});return this.resizeFilter&&(r.resizeFilter=this.resizeFilter.toObject()),r},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var h=[],f=[],r,l=this._element,a=-this.width/2,d=-this.height/2,p="",c="";if(!l)return[];if(this.hasCrop()){var m=t.Object.__uid++;h.push('<clipPath id="imageCrop_'+m+`">
`,'	<rect x="'+a+'" y="'+d+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),p=' clip-path="url(#imageCrop_'+m+')" '}if(this.imageSmoothing||(c='" image-rendering="optimizeSpeed'),f.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',a-this.cropX,'" y="',d-this.cropY,'" width="',l.width||l.naturalWidth,'" height="',l.height||l.height,c,'"',p,`></image>
`),this.stroke||this.strokeDashArray){var _=this.fill;this.fill=null,r=["	<rect ",'x="',a,'" y="',d,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=_}return this.paintFirst!=="fill"?h=h.concat(r,f):h=h.concat(f,r),h},getSrc:function(h){var f=h?this._element:this._originalElement;return f?f.toDataURL?f.toDataURL():this.srcFromAttribute?f.getAttribute("src"):f.src:this.src||""},setSrc:function(h,f,r){return t.util.loadImage(h,function(l,a){this.setElement(l,r),this._setWidthHeight(),f&&f(this,a)},this,r&&r.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var h=this.resizeFilter,f=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),l=r.scaleX,a=r.scaleY,d=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!h||l>f&&a>f){this._element=d,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=l,this._lastScaleY=a;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var p=t.util.createCanvasElement(),c=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,m=d.width,_=d.height;p.width=m,p.height=_,this._element=p,this._lastScaleX=h.scaleX=l,this._lastScaleY=h.scaleY=a,t.filterBackend.applyFilters([h],d,m,_,this._element,c),this._filterScalingX=p.width/this._originalElement.width,this._filterScalingY=p.height/this._originalElement.height},applyFilters:function(h){if(h=h||this.filters||[],h=h.filter(function(d){return d&&!d.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),h.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var f=this._originalElement,r=f.naturalWidth||f.width,l=f.naturalHeight||f.height;if(this._element===this._originalElement){var a=t.util.createCanvasElement();a.width=r,a.height=l,this._element=a,this._filteredEl=a}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,l),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(h,this._originalElement,r,l,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(h){t.util.setImageSmoothing(h,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(h),this._renderPaintInOrder(h)},drawCacheOnCanvas:function(h){t.util.setImageSmoothing(h,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,h)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(h){var f=this._element;if(f){var r=this._filterScalingX,l=this._filterScalingY,a=this.width,d=this.height,p=Math.min,c=Math.max,m=c(this.cropX,0),_=c(this.cropY,0),b=f.naturalWidth||f.width,y=f.naturalHeight||f.height,x=m*r,C=_*l,T=p(a*r,b-x),k=p(d*l,y-C),E=-a/2,z=-d/2,N=p(a,b/r-m),$=p(d,y/l-_);f&&h.drawImage(f,x,C,T,k,E,z,N,$)}},_needsResize:function(){var h=this.getTotalObjectScaling();return h.scaleX!==this._lastScaleX||h.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(h,f){this.setElement(t.util.getById(h),f),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(h){h||(h={}),this.setOptions(h),this._setWidthHeight(h)},_initFilters:function(h,f){h&&h.length?t.util.enlivenObjects(h,function(r){f&&f(r)},"fabric.Image.filters"):f&&f()},_setWidthHeight:function(h){h||(h={});var f=this.getElement();this.width=h.width||f.naturalWidth||f.width||0,this.height=h.height||f.naturalHeight||f.height||0},parsePreserveAspectRatioAttribute:function(){var h=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),f=this._element.width,r=this._element.height,l=1,a=1,d=0,p=0,c=0,m=0,_,b=this.width,y=this.height,x={width:b,height:y};return h&&(h.alignX!=="none"||h.alignY!=="none")?(h.meetOrSlice==="meet"&&(l=a=t.util.findScaleToFit(this._element,x),_=(b-f*l)/2,h.alignX==="Min"&&(d=-_),h.alignX==="Max"&&(d=_),_=(y-r*a)/2,h.alignY==="Min"&&(p=-_),h.alignY==="Max"&&(p=_)),h.meetOrSlice==="slice"&&(l=a=t.util.findScaleToCover(this._element,x),_=f-b/l,h.alignX==="Mid"&&(c=_/2),h.alignX==="Max"&&(c=_),_=r-y/a,h.alignY==="Mid"&&(m=_/2),h.alignY==="Max"&&(m=_),f=b/l,r=y/a)):(l=b/f,a=y/r),{width:f,height:r,scaleX:l,scaleY:a,offsetLeft:d,offsetTop:p,cropX:c,cropY:m}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(h,f){var r=t.util.object.clone(h);t.util.loadImage(r.src,function(l,a){if(a){f&&f(null,!0);return}t.Image.prototype._initFilters.call(r,r.filters,function(d){r.filters=d||[],t.Image.prototype._initFilters.call(r,[r.resizeFilter],function(p){r.resizeFilter=p[0],t.util.enlivenObjectEnlivables(r,r,function(){var c=new t.Image(l,r);f(c,!1)})})})},null,r.crossOrigin)},t.Image.fromURL=function(h,f,r){t.util.loadImage(h,function(l,a){f&&f(new t.Image(l,r),a)},null,r&&r.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(h,f,r){var l=t.parseAttributes(h,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(l["xlink:href"],f,n(r?t.util.object.clone(r):{},l))}}(i),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var o=this.angle%360;return o>0?Math.round((o-1)/90)*90:Math.round(o/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(o){o=o||{};var n=function(){},h=o.onComplete||n,f=o.onChange||n,r=this;return t.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(l){r.rotate(l),f()},onComplete:function(){r.setCoords(),h()}})}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(o){return o.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(o){return o.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function o(h,f){var r="precision "+f+` float;
void main(){}`,l=h.createShader(h.FRAGMENT_SHADER);return h.shaderSource(l,r),h.compileShader(l),!!h.getShaderParameter(l,h.COMPILE_STATUS)}t.isWebglSupported=function(h){if(t.isLikelyNode)return!1;h=h||t.WebglFilterBackend.prototype.tileSize;var f=document.createElement("canvas"),r=f.getContext("webgl")||f.getContext("experimental-webgl"),l=!1;if(r){t.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),l=t.maxTextureSize>=h;for(var a=["highp","mediump","lowp"],d=0;d<3;d++)if(o(r,a[d])){t.webGlPrecision=a[d];break}}return this.isSupported=l,l},t.WebglFilterBackend=n;function n(h){h&&h.tileSize&&(this.tileSize=h.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}n.prototype={tileSize:2048,resources:{},setupGLContext:function(h,f){this.dispose(),this.createWebGLCanvas(h,f),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(h,f)},chooseFastestCopyGLTo2DMethod:function(h,f){var r=typeof window.performance<"u",l;try{new ImageData(1,1),l=!0}catch{l=!1}var a=typeof ArrayBuffer<"u",d=typeof Uint8ClampedArray<"u";if(r&&l&&a&&d){var p=t.util.createCanvasElement(),c=new ArrayBuffer(h*f*4);if(t.forceGLPutImageData){this.imageBuffer=c,this.copyGLTo2D=v;return}var m={imageBuffer:c,destinationWidth:h,destinationHeight:f,targetCanvas:p},_,b,y;p.width=h,p.height=f,_=window.performance.now(),g.call(m,this.gl,m),b=window.performance.now()-_,_=window.performance.now(),v.call(m,this.gl,m),y=window.performance.now()-_,b>y?(this.imageBuffer=c,this.copyGLTo2D=v):this.copyGLTo2D=g}},createWebGLCanvas:function(h,f){var r=t.util.createCanvasElement();r.width=h,r.height=f;var l={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},a=r.getContext("webgl",l);a||(a=r.getContext("experimental-webgl",l)),a&&(a.clearColor(0,0,0,0),this.canvas=r,this.gl=a)},applyFilters:function(h,f,r,l,a,d){var p=this.gl,c;d&&(c=this.getCachedTexture(d,f));var m={originalWidth:f.width||f.originalWidth,originalHeight:f.height||f.originalHeight,sourceWidth:r,sourceHeight:l,destinationWidth:r,destinationHeight:l,context:p,sourceTexture:this.createTexture(p,r,l,!c&&f),targetTexture:this.createTexture(p,r,l),originalTexture:c||this.createTexture(p,r,l,!c&&f),passes:h.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:a},_=p.createFramebuffer();return p.bindFramebuffer(p.FRAMEBUFFER,_),h.forEach(function(b){b&&b.applyTo(m)}),u(m),this.copyGLTo2D(p,m),p.bindTexture(p.TEXTURE_2D,null),p.deleteTexture(m.sourceTexture),p.deleteTexture(m.targetTexture),p.deleteFramebuffer(_),a.getContext("2d").setTransform(1,0,0,1,0,0),m},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(h,f,r,l,a){var d=h.createTexture();return h.bindTexture(h.TEXTURE_2D,d),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,a||h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,a||h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),l?h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,l):h.texImage2D(h.TEXTURE_2D,0,h.RGBA,f,r,0,h.RGBA,h.UNSIGNED_BYTE,null),d},getCachedTexture:function(h,f){if(this.textureCache[h])return this.textureCache[h];var r=this.createTexture(this.gl,f.width,f.height,f);return this.textureCache[h]=r,r},evictCachesForKey:function(h){this.textureCache[h]&&(this.gl.deleteTexture(this.textureCache[h]),delete this.textureCache[h])},copyGLTo2D:g,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var h=this.gl,f={renderer:"",vendor:""};if(!h)return f;var r=h.getExtension("WEBGL_debug_renderer_info");if(r){var l=h.getParameter(r.UNMASKED_RENDERER_WEBGL),a=h.getParameter(r.UNMASKED_VENDOR_WEBGL);l&&(f.renderer=l.toLowerCase()),a&&(f.vendor=a.toLowerCase())}return this.gpuInfo=f,f}}}();function u(o){var n=o.targetCanvas,h=n.width,f=n.height,r=o.destinationWidth,l=o.destinationHeight;(h!==r||f!==l)&&(n.width=r,n.height=l)}function g(o,n){var h=o.canvas,f=n.targetCanvas,r=f.getContext("2d");r.translate(0,f.height),r.scale(1,-1);var l=h.height-f.height;r.drawImage(h,0,l,f.width,f.height,0,0,f.width,f.height)}function v(o,n){var h=n.targetCanvas,f=h.getContext("2d"),r=n.destinationWidth,l=n.destinationHeight,a=r*l*4,d=new Uint8Array(this.imageBuffer,0,a),p=new Uint8ClampedArray(this.imageBuffer,0,a);o.readPixels(0,0,r,l,o.RGBA,o.UNSIGNED_BYTE,d);var c=new ImageData(p,r,l);f.putImageData(c,0,0)}(function(){var o=function(){};t.Canvas2dFilterBackend=n;function n(){}n.prototype={evictCachesForKey:o,dispose:o,clearWebGLCaches:o,resources:{},applyFilters:function(h,f,r,l,a){var d=a.getContext("2d");d.drawImage(f,0,0,r,l);var p=d.getImageData(0,0,r,l),c=d.getImageData(0,0,r,l),m={sourceWidth:r,sourceHeight:l,imageData:p,originalEl:f,originalImageData:c,canvasEl:a,ctx:d,filterBackend:this};return h.forEach(function(_){_.applyTo(m)}),(m.imageData.width!==r||m.imageData.height!==l)&&(a.width=m.imageData.width,a.height=m.imageData.height),d.putImageData(m.imageData,0,0),m}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(o){o&&this.setOptions(o)},setOptions:function(o){for(var n in o)this[n]=o[n]},createProgram:function(o,n,h){n=n||this.fragmentSource,h=h||this.vertexSource,t.webGlPrecision!=="highp"&&(n=n.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var f=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(f,h),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+o.getShaderInfoLog(f));var r=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(r,n),o.compileShader(r),!o.getShaderParameter(r,o.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+o.getShaderInfoLog(r));var l=o.createProgram();if(o.attachShader(l,f),o.attachShader(l,r),o.linkProgram(l),!o.getProgramParameter(l,o.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+o.getProgramInfoLog(l));var a=this.getAttributeLocations(o,l),d=this.getUniformLocations(o,l)||{};return d.uStepW=o.getUniformLocation(l,"uStepW"),d.uStepH=o.getUniformLocation(l,"uStepH"),{program:l,attributeLocations:a,uniformLocations:d}},getAttributeLocations:function(o,n){return{aPosition:o.getAttribLocation(n,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(o,n,h){var f=n.aPosition,r=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,r),o.enableVertexAttribArray(f),o.vertexAttribPointer(f,2,o.FLOAT,!1,0,0),o.bufferData(o.ARRAY_BUFFER,h,o.STATIC_DRAW)},_setupFrameBuffer:function(o){var n=o.context,h,f;o.passes>1?(h=o.destinationWidth,f=o.destinationHeight,(o.sourceWidth!==h||o.sourceHeight!==f)&&(n.deleteTexture(o.targetTexture),o.targetTexture=o.filterBackend.createTexture(n,h,f)),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o.targetTexture,0)):(n.bindFramebuffer(n.FRAMEBUFFER,null),n.finish())},_swapTextures:function(o){o.passes--,o.pass++;var n=o.targetTexture;o.targetTexture=o.sourceTexture,o.sourceTexture=n},isNeutralState:function(){var o=this.mainParameter,n=t.Image.filters[this.type].prototype;if(o)if(Array.isArray(n[o])){for(var h=n[o].length;h--;)if(this[o][h]!==n[o][h])return!1;return!0}else return n[o]===this[o];else return!1},applyTo:function(o){o.webgl?(this._setupFrameBuffer(o),this.applyToWebGL(o),this._swapTextures(o)):this.applyTo2d(o)},retrieveShader:function(o){return o.programCache.hasOwnProperty(this.type)||(o.programCache[this.type]=this.createProgram(o.context)),o.programCache[this.type]},applyToWebGL:function(o){var n=o.context,h=this.retrieveShader(o);o.pass===0&&o.originalTexture?n.bindTexture(n.TEXTURE_2D,o.originalTexture):n.bindTexture(n.TEXTURE_2D,o.sourceTexture),n.useProgram(h.program),this.sendAttributeData(n,h.attributeLocations,o.aPosition),n.uniform1f(h.uniformLocations.uStepW,1/o.sourceWidth),n.uniform1f(h.uniformLocations.uStepH,1/o.sourceHeight),this.sendUniformData(n,h.uniformLocations),n.viewport(0,0,o.destinationWidth,o.destinationHeight),n.drawArrays(n.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(o,n,h){o.activeTexture(h),o.bindTexture(o.TEXTURE_2D,n),o.activeTexture(o.TEXTURE0)},unbindAdditionalTexture:function(o,n){o.activeTexture(n),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(o){this[this.mainParameter]=o},sendUniformData:function(){},createHelpLayer:function(o){if(!o.helpLayer){var n=document.createElement("canvas");n.width=o.sourceWidth,n.height=o.sourceHeight,o.helpLayer=n}},toObject:function(){var o={type:this.type},n=this.mainParameter;return n&&(o[n]=this[n]),o},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(o,n){var h=new t.Image.filters[o.type](o);return n&&n(h),h},function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.ColorMatrix=f(h.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(r){this.callSuper("initialize",r),this.matrix=this.matrix.slice(0)},applyTo2d:function(r){var l=r.imageData,a=l.data,d=a.length,p=this.matrix,c,m,_,b,y,x=this.colorsOnly;for(y=0;y<d;y+=4)c=a[y],m=a[y+1],_=a[y+2],x?(a[y]=c*p[0]+m*p[1]+_*p[2]+p[4]*255,a[y+1]=c*p[5]+m*p[6]+_*p[7]+p[9]*255,a[y+2]=c*p[10]+m*p[11]+_*p[12]+p[14]*255):(b=a[y+3],a[y]=c*p[0]+m*p[1]+_*p[2]+b*p[3]+p[4]*255,a[y+1]=c*p[5]+m*p[6]+_*p[7]+b*p[8]+p[9]*255,a[y+2]=c*p[10]+m*p[11]+_*p[12]+b*p[13]+p[14]*255,a[y+3]=c*p[15]+m*p[16]+_*p[17]+b*p[18]+p[19]*255)},getUniformLocations:function(r,l){return{uColorMatrix:r.getUniformLocation(l,"uColorMatrix"),uConstants:r.getUniformLocation(l,"uConstants")}},sendUniformData:function(r,l){var a=this.matrix,d=[a[0],a[1],a[2],a[3],a[5],a[6],a[7],a[8],a[10],a[11],a[12],a[13],a[15],a[16],a[17],a[18]],p=[a[4],a[9],a[14],a[19]];r.uniformMatrix4fv(l.uColorMatrix,!1,d),r.uniform4fv(l.uConstants,p)}}),n.Image.filters.ColorMatrix.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.Brightness=f(h.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(r){if(this.brightness!==0){var l=r.imageData,a=l.data,d,p=a.length,c=Math.round(this.brightness*255);for(d=0;d<p;d+=4)a[d]=a[d]+c,a[d+1]=a[d+1]+c,a[d+2]=a[d+2]+c}},getUniformLocations:function(r,l){return{uBrightness:r.getUniformLocation(l,"uBrightness")}},sendUniformData:function(r,l){r.uniform1f(l.uBrightness,this.brightness)}}),n.Image.filters.Brightness.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.object.extend,f=n.Image.filters,r=n.util.createClass;f.Convolute=r(f.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(l){var a=Math.sqrt(this.matrix.length),d=this.type+"_"+a+"_"+(this.opaque?1:0),p=this.fragmentSource[d];return l.programCache.hasOwnProperty(d)||(l.programCache[d]=this.createProgram(l.context,p)),l.programCache[d]},applyTo2d:function(l){var a=l.imageData,d=a.data,p=this.matrix,c=Math.round(Math.sqrt(p.length)),m=Math.floor(c/2),_=a.width,b=a.height,y=l.ctx.createImageData(_,b),x=y.data,C=this.opaque?1:0,T,k,E,z,N,$,J,K,G,Q,tt,it,w;for(tt=0;tt<b;tt++)for(Q=0;Q<_;Q++){for(N=(tt*_+Q)*4,T=0,k=0,E=0,z=0,w=0;w<c;w++)for(it=0;it<c;it++)J=tt+w-m,$=Q+it-m,!(J<0||J>=b||$<0||$>=_)&&(K=(J*_+$)*4,G=p[w*c+it],T+=d[K]*G,k+=d[K+1]*G,E+=d[K+2]*G,C||(z+=d[K+3]*G));x[N]=T,x[N+1]=k,x[N+2]=E,C?x[N+3]=d[N+3]:x[N+3]=z}l.imageData=y},getUniformLocations:function(l,a){return{uMatrix:l.getUniformLocation(a,"uMatrix"),uOpaque:l.getUniformLocation(a,"uOpaque"),uHalfSize:l.getUniformLocation(a,"uHalfSize"),uSize:l.getUniformLocation(a,"uSize")}},sendUniformData:function(l,a){l.uniform1fv(a.uMatrix,this.matrix)},toObject:function(){return h(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),n.Image.filters.Convolute.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.Grayscale=f(h.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(r){var l=r.imageData,a=l.data,d,p=a.length,c,m=this.mode;for(d=0;d<p;d+=4)m==="average"?c=(a[d]+a[d+1]+a[d+2])/3:m==="lightness"?c=(Math.min(a[d],a[d+1],a[d+2])+Math.max(a[d],a[d+1],a[d+2]))/2:m==="luminosity"&&(c=.21*a[d]+.72*a[d+1]+.07*a[d+2]),a[d]=c,a[d+1]=c,a[d+2]=c},retrieveShader:function(r){var l=this.type+"_"+this.mode;if(!r.programCache.hasOwnProperty(l)){var a=this.fragmentSource[this.mode];r.programCache[l]=this.createProgram(r.context,a)}return r.programCache[l]},getUniformLocations:function(r,l){return{uMode:r.getUniformLocation(l,"uMode")}},sendUniformData:function(r,l){var a=1;r.uniform1i(l.uMode,a)},isNeutralState:function(){return!1}}),n.Image.filters.Grayscale.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.Invert=f(h.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(r){var l=r.imageData,a=l.data,d,p=a.length;for(d=0;d<p;d+=4)a[d]=255-a[d],a[d+1]=255-a[d+1],a[d+2]=255-a[d+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(r,l){return{uInvert:r.getUniformLocation(l,"uInvert")}},sendUniformData:function(r,l){r.uniform1i(l.uInvert,this.invert)}}),n.Image.filters.Invert.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.object.extend,f=n.Image.filters,r=n.util.createClass;f.Noise=r(f.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(l){if(this.noise!==0){var a=l.imageData,d=a.data,p,c=d.length,m=this.noise,_;for(p=0,c=d.length;p<c;p+=4)_=(.5-Math.random())*m,d[p]+=_,d[p+1]+=_,d[p+2]+=_}},getUniformLocations:function(l,a){return{uNoise:l.getUniformLocation(a,"uNoise"),uSeed:l.getUniformLocation(a,"uSeed")}},sendUniformData:function(l,a){l.uniform1f(a.uNoise,this.noise/255),l.uniform1f(a.uSeed,Math.random())},toObject:function(){return h(this.callSuper("toObject"),{noise:this.noise})}}),n.Image.filters.Noise.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.Pixelate=f(h.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(r){var l=r.imageData,a=l.data,d=l.height,p=l.width,c,m,_,b,y,x,C,T,k,E,z;for(m=0;m<d;m+=this.blocksize)for(_=0;_<p;_+=this.blocksize)for(c=m*4*p+_*4,b=a[c],y=a[c+1],x=a[c+2],C=a[c+3],E=Math.min(m+this.blocksize,d),z=Math.min(_+this.blocksize,p),T=m;T<E;T++)for(k=_;k<z;k++)c=T*4*p+k*4,a[c]=b,a[c+1]=y,a[c+2]=x,a[c+3]=C},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(r,l){return{uBlocksize:r.getUniformLocation(l,"uBlocksize"),uStepW:r.getUniformLocation(l,"uStepW"),uStepH:r.getUniformLocation(l,"uStepH")}},sendUniformData:function(r,l){r.uniform1f(l.uBlocksize,this.blocksize)}}),n.Image.filters.Pixelate.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.object.extend,f=n.Image.filters,r=n.util.createClass;f.RemoveColor=r(f.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(l){var a=l.imageData,d=a.data,p,c=this.distance*255,m,_,b,y=new n.Color(this.color).getSource(),x=[y[0]-c,y[1]-c,y[2]-c],C=[y[0]+c,y[1]+c,y[2]+c];for(p=0;p<d.length;p+=4)m=d[p],_=d[p+1],b=d[p+2],m>x[0]&&_>x[1]&&b>x[2]&&m<C[0]&&_<C[1]&&b<C[2]&&(d[p+3]=0)},getUniformLocations:function(l,a){return{uLow:l.getUniformLocation(a,"uLow"),uHigh:l.getUniformLocation(a,"uHigh")}},sendUniformData:function(l,a){var d=new n.Color(this.color).getSource(),p=parseFloat(this.distance),c=[0+d[0]/255-p,0+d[1]/255-p,0+d[2]/255-p,1],m=[d[0]/255+p,d[1]/255+p,d[2]/255+p,1];l.uniform4fv(a.uLow,c),l.uniform4fv(a.uHigh,m)},toObject:function(){return h(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),n.Image.filters.RemoveColor.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass,r={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var l in r)h[l]=f(h.ColorMatrix,{type:l,matrix:r[l],mainParameter:!1,colorsOnly:!0}),n.Image.filters[l].fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric,h=n.Image.filters,f=n.util.createClass;h.BlendColor=f(h.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(r){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[r]+`}
}`},retrieveShader:function(r){var l=this.type+"_"+this.mode,a;return r.programCache.hasOwnProperty(l)||(a=this.buildSource(this.mode),r.programCache[l]=this.createProgram(r.context,a)),r.programCache[l]},applyTo2d:function(r){var l=r.imageData,a=l.data,d=a.length,p,c,m,_,b,y,x,C=1-this.alpha;x=new n.Color(this.color).getSource(),p=x[0]*this.alpha,c=x[1]*this.alpha,m=x[2]*this.alpha;for(var T=0;T<d;T+=4)switch(_=a[T],b=a[T+1],y=a[T+2],this.mode){case"multiply":a[T]=_*p/255,a[T+1]=b*c/255,a[T+2]=y*m/255;break;case"screen":a[T]=255-(255-_)*(255-p)/255,a[T+1]=255-(255-b)*(255-c)/255,a[T+2]=255-(255-y)*(255-m)/255;break;case"add":a[T]=_+p,a[T+1]=b+c,a[T+2]=y+m;break;case"diff":case"difference":a[T]=Math.abs(_-p),a[T+1]=Math.abs(b-c),a[T+2]=Math.abs(y-m);break;case"subtract":a[T]=_-p,a[T+1]=b-c,a[T+2]=y-m;break;case"darken":a[T]=Math.min(_,p),a[T+1]=Math.min(b,c),a[T+2]=Math.min(y,m);break;case"lighten":a[T]=Math.max(_,p),a[T+1]=Math.max(b,c),a[T+2]=Math.max(y,m);break;case"overlay":a[T]=p<128?2*_*p/255:255-2*(255-_)*(255-p)/255,a[T+1]=c<128?2*b*c/255:255-2*(255-b)*(255-c)/255,a[T+2]=m<128?2*y*m/255:255-2*(255-y)*(255-m)/255;break;case"exclusion":a[T]=p+_-2*p*_/255,a[T+1]=c+b-2*c*b/255,a[T+2]=m+y-2*m*y/255;break;case"tint":a[T]=p+_*C,a[T+1]=c+b*C,a[T+2]=m+y*C}},getUniformLocations:function(r,l){return{uColor:r.getUniformLocation(l,"uColor")}},sendUniformData:function(r,l){var a=new n.Color(this.color).getSource();a[0]=this.alpha*a[0]/255,a[1]=this.alpha*a[1]/255,a[2]=this.alpha*a[2]/255,a[3]=this.alpha,r.uniform4fv(l.uColor,a)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),n.Image.filters.BlendColor.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric,h=n.Image.filters,f=n.util.createClass;h.BlendImage=f(h.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(r){var l=this.type+"_"+this.mode,a=this.fragmentSource[this.mode];return r.programCache.hasOwnProperty(l)||(r.programCache[l]=this.createProgram(r.context,a)),r.programCache[l]},applyToWebGL:function(r){var l=r.context,a=this.createTexture(r.filterBackend,this.image);this.bindAdditionalTexture(l,a,l.TEXTURE1),this.callSuper("applyToWebGL",r),this.unbindAdditionalTexture(l,l.TEXTURE1)},createTexture:function(r,l){return r.getCachedTexture(l.cacheKey,l._element)},calculateMatrix:function(){var r=this.image,l=r._element.width,a=r._element.height;return[1/r.scaleX,0,0,0,1/r.scaleY,0,-r.left/l,-r.top/a,1]},applyTo2d:function(r){var l=r.imageData,a=r.filterBackend.resources,d=l.data,p=d.length,c=l.width,m=l.height,_,b,y,x,C,T,k,E,z,N,$=this.image,J;a.blendImage||(a.blendImage=n.util.createCanvasElement()),z=a.blendImage,N=z.getContext("2d"),z.width!==c||z.height!==m?(z.width=c,z.height=m):N.clearRect(0,0,c,m),N.setTransform($.scaleX,0,0,$.scaleY,$.left,$.top),N.drawImage($._element,0,0,c,m),J=N.getImageData(0,0,c,m).data;for(var K=0;K<p;K+=4)switch(C=d[K],T=d[K+1],k=d[K+2],E=d[K+3],_=J[K],b=J[K+1],y=J[K+2],x=J[K+3],this.mode){case"multiply":d[K]=C*_/255,d[K+1]=T*b/255,d[K+2]=k*y/255,d[K+3]=E*x/255;break;case"mask":d[K+3]=x;break}},getUniformLocations:function(r,l){return{uTransformMatrix:r.getUniformLocation(l,"uTransformMatrix"),uImage:r.getUniformLocation(l,"uImage")}},sendUniformData:function(r,l){var a=this.calculateMatrix();r.uniform1i(l.uImage,1),r.uniformMatrix3fv(l.uTransformMatrix,!1,a)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),n.Image.filters.BlendImage.fromObject=function(r,l){n.Image.fromObject(r.image,function(a){var d=n.util.object.clone(r);d.image=a,l(new n.Image.filters.BlendImage(d))})}}(i),function(o){var n=o.fabric||(o.fabric={}),h=Math.pow,f=Math.floor,r=Math.sqrt,l=Math.abs,a=Math.round,d=Math.sin,p=Math.ceil,c=n.Image.filters,m=n.util.createClass;c.Resize=m(c.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(_,b){return{uDelta:_.getUniformLocation(b,"uDelta"),uTaps:_.getUniformLocation(b,"uTaps")}},sendUniformData:function(_,b){_.uniform2fv(b.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),_.uniform1fv(b.uTaps,this.taps)},retrieveShader:function(_){var b=this.getFilterWindow(),y=this.type+"_"+b;if(!_.programCache.hasOwnProperty(y)){var x=this.generateShader(b);_.programCache[y]=this.createProgram(_.context,x)}return _.programCache[y]},getFilterWindow:function(){var _=this.tempScale;return Math.ceil(this.lanczosLobes/_)},getTaps:function(){for(var _=this.lanczosCreate(this.lanczosLobes),b=this.tempScale,y=this.getFilterWindow(),x=new Array(y),C=1;C<=y;C++)x[C-1]=_(C*b);return x},generateShader:function(x){for(var b=new Array(x),y=this.fragmentSourceTOP,x,C=1;C<=x;C++)b[C-1]=C+".0 * uDelta";return y+="uniform float uTaps["+x+`];
`,y+=`void main() {
`,y+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,y+=`  float sum = 1.0;
`,b.forEach(function(T,k){y+="  color += texture2D(uTexture, vTexCoord + "+T+") * uTaps["+k+`];
`,y+="  color += texture2D(uTexture, vTexCoord - "+T+") * uTaps["+k+`];
`,y+="  sum += 2.0 * uTaps["+k+`];
`}),y+=`  gl_FragColor = color / sum;
`,y+="}",y},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(_){_.webgl?(_.passes++,this.width=_.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=_.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),_.destinationWidth=this.dW,this._setupFrameBuffer(_),this.applyToWebGL(_),this._swapTextures(_),_.sourceWidth=_.destinationWidth,this.height=_.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),_.destinationHeight=this.dH,this._setupFrameBuffer(_),this.applyToWebGL(_),this._swapTextures(_),_.sourceHeight=_.destinationHeight):this.applyTo2d(_)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(_){return function(b){if(b>=_||b<=-_)return 0;if(b<11920929e-14&&b>-11920929e-14)return 1;b*=Math.PI;var y=b/_;return d(b)/b*d(y)/y}},applyTo2d:function(_){var b=_.imageData,y=this.scaleX,x=this.scaleY;this.rcpScaleX=1/y,this.rcpScaleY=1/x;var C=b.width,T=b.height,k=a(C*y),E=a(T*x),z;this.resizeType==="sliceHack"?z=this.sliceByTwo(_,C,T,k,E):this.resizeType==="hermite"?z=this.hermiteFastResize(_,C,T,k,E):this.resizeType==="bilinear"?z=this.bilinearFiltering(_,C,T,k,E):this.resizeType==="lanczos"&&(z=this.lanczosResize(_,C,T,k,E)),_.imageData=z},sliceByTwo:function(_,b,y,x,C){var T=_.imageData,k=.5,E=!1,z=!1,N=b*k,$=y*k,J=n.filterBackend.resources,K,G,Q=0,tt=0,it=b,w=0;for(J.sliceByTwo||(J.sliceByTwo=document.createElement("canvas")),K=J.sliceByTwo,(K.width<b*1.5||K.height<y)&&(K.width=b*1.5,K.height=y),G=K.getContext("2d"),G.clearRect(0,0,b*1.5,y),G.putImageData(T,0,0),x=f(x),C=f(C);!E||!z;)b=N,y=$,x<f(N*k)?N=f(N*k):(N=x,E=!0),C<f($*k)?$=f($*k):($=C,z=!0),G.drawImage(K,Q,tt,b,y,it,w,N,$),Q=it,tt=w,w+=$;return G.getImageData(Q,tt,x,C)},lanczosResize:function(_,b,y,x,C){function T(D){var P,R,O,S,A,L,W,I,H,q,Z;for(w.x=(D+.5)*$,M.x=f(w.x),P=0;P<C;P++){for(w.y=(P+.5)*J,M.y=f(w.y),A=0,L=0,W=0,I=0,H=0,R=M.x-Q;R<=M.x+Q;R++)if(!(R<0||R>=b)){q=f(1e3*l(R-w.x)),it[q]||(it[q]={});for(var B=M.y-tt;B<=M.y+tt;B++)B<0||B>=y||(Z=f(1e3*l(B-w.y)),it[q][Z]||(it[q][Z]=N(r(h(q*K,2)+h(Z*G,2))/1e3)),O=it[q][Z],O>0&&(S=(B*b+R)*4,A+=O,L+=O*k[S],W+=O*k[S+1],I+=O*k[S+2],H+=O*k[S+3]))}S=(P*x+D)*4,z[S]=L/A,z[S+1]=W/A,z[S+2]=I/A,z[S+3]=H/A}return++D<x?T(D):E}var k=_.imageData.data,E=_.ctx.createImageData(x,C),z=E.data,N=this.lanczosCreate(this.lanczosLobes),$=this.rcpScaleX,J=this.rcpScaleY,K=2/this.rcpScaleX,G=2/this.rcpScaleY,Q=p($*this.lanczosLobes/2),tt=p(J*this.lanczosLobes/2),it={},w={},M={};return T(0)},bilinearFiltering:function(_,b,y,x,C){var T,k,E,z,N,$,J,K,G,Q,tt,it,w=0,M,D=this.rcpScaleX,P=this.rcpScaleY,R=4*(b-1),O=_.imageData,S=O.data,A=_.ctx.createImageData(x,C),L=A.data;for(J=0;J<C;J++)for(K=0;K<x;K++)for(N=f(D*K),$=f(P*J),G=D*K-N,Q=P*J-$,M=4*($*b+N),tt=0;tt<4;tt++)T=S[M+tt],k=S[M+4+tt],E=S[M+R+tt],z=S[M+R+4+tt],it=T*(1-G)*(1-Q)+k*G*(1-Q)+E*Q*(1-G)+z*G*Q,L[w++]=it;return A},hermiteFastResize:function(_,b,y,x,C){for(var T=this.rcpScaleX,k=this.rcpScaleY,E=p(T/2),z=p(k/2),N=_.imageData,$=N.data,J=_.ctx.createImageData(x,C),K=J.data,G=0;G<C;G++)for(var Q=0;Q<x;Q++){for(var tt=(Q+G*x)*4,it=0,w=0,M=0,D=0,P=0,R=0,O=0,S=(G+.5)*k,A=f(G*k);A<(G+1)*k;A++)for(var L=l(S-(A+.5))/z,W=(Q+.5)*T,I=L*L,H=f(Q*T);H<(Q+1)*T;H++){var q=l(W-(H+.5))/E,Z=r(I+q*q);Z>1&&Z<-1||(it=2*Z*Z*Z-3*Z*Z+1,it>0&&(q=4*(H+A*b),O+=it*$[q+3],M+=it,$[q+3]<255&&(it=it*$[q+3]/250),D+=it*$[q],P+=it*$[q+1],R+=it*$[q+2],w+=it))}K[tt]=D/w,K[tt+1]=P/w,K[tt+2]=R/w,K[tt+3]=O/M}return J},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),n.Image.filters.Resize.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.Contrast=f(h.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(r){if(this.contrast!==0){var l=r.imageData,a,p,d=l.data,p=d.length,c=Math.floor(this.contrast*255),m=259*(c+255)/(255*(259-c));for(a=0;a<p;a+=4)d[a]=m*(d[a]-128)+128,d[a+1]=m*(d[a+1]-128)+128,d[a+2]=m*(d[a+2]-128)+128}},getUniformLocations:function(r,l){return{uContrast:r.getUniformLocation(l,"uContrast")}},sendUniformData:function(r,l){r.uniform1f(l.uContrast,this.contrast)}}),n.Image.filters.Contrast.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.Saturation=f(h.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(r){if(this.saturation!==0){var l=r.imageData,a=l.data,d=a.length,p=-this.saturation,c,m;for(c=0;c<d;c+=4)m=Math.max(a[c],a[c+1],a[c+2]),a[c]+=m!==a[c]?(m-a[c])*p:0,a[c+1]+=m!==a[c+1]?(m-a[c+1])*p:0,a[c+2]+=m!==a[c+2]?(m-a[c+2])*p:0}},getUniformLocations:function(r,l){return{uSaturation:r.getUniformLocation(l,"uSaturation")}},sendUniformData:function(r,l){r.uniform1f(l.uSaturation,-this.saturation)}}),n.Image.filters.Saturation.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.Vibrance=f(h.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(r){if(this.vibrance!==0){var l=r.imageData,a=l.data,d=a.length,p=-this.vibrance,c,m,_,b;for(c=0;c<d;c+=4)m=Math.max(a[c],a[c+1],a[c+2]),_=(a[c]+a[c+1]+a[c+2])/3,b=Math.abs(m-_)*2/255*p,a[c]+=m!==a[c]?(m-a[c])*b:0,a[c+1]+=m!==a[c+1]?(m-a[c+1])*b:0,a[c+2]+=m!==a[c+2]?(m-a[c+2])*b:0}},getUniformLocations:function(r,l){return{uVibrance:r.getUniformLocation(l,"uVibrance")}},sendUniformData:function(r,l){r.uniform1f(l.uVibrance,-this.vibrance)}}),n.Image.filters.Vibrance.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.Blur=f(h.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(r){r.webgl?(this.aspectRatio=r.sourceWidth/r.sourceHeight,r.passes++,this._setupFrameBuffer(r),this.horizontal=!0,this.applyToWebGL(r),this._swapTextures(r),this._setupFrameBuffer(r),this.horizontal=!1,this.applyToWebGL(r),this._swapTextures(r)):this.applyTo2d(r)},applyTo2d:function(r){r.imageData=this.simpleBlur(r)},simpleBlur:function(r){var l=r.filterBackend.resources,a,d,p=r.imageData.width,c=r.imageData.height;l.blurLayer1||(l.blurLayer1=n.util.createCanvasElement(),l.blurLayer2=n.util.createCanvasElement()),a=l.blurLayer1,d=l.blurLayer2,(a.width!==p||a.height!==c)&&(d.width=a.width=p,d.height=a.height=c);var m=a.getContext("2d"),_=d.getContext("2d"),b=15,y,x,C,T,k=this.blur*.06*.5;for(m.putImageData(r.imageData,0,0),_.clearRect(0,0,p,c),T=-b;T<=b;T++)y=(Math.random()-.5)/4,x=T/b,C=k*x*p+y,_.globalAlpha=1-Math.abs(x),_.drawImage(a,C,y),m.drawImage(d,0,0),_.globalAlpha=1,_.clearRect(0,0,d.width,d.height);for(T=-b;T<=b;T++)y=(Math.random()-.5)/4,x=T/b,C=k*x*c+y,_.globalAlpha=1-Math.abs(x),_.drawImage(a,y,C),m.drawImage(d,0,0),_.globalAlpha=1,_.clearRect(0,0,d.width,d.height);r.ctx.drawImage(a,0,0);var E=r.ctx.getImageData(0,0,a.width,a.height);return m.globalAlpha=1,m.clearRect(0,0,a.width,a.height),E},getUniformLocations:function(r,l){return{delta:r.getUniformLocation(l,"uDelta")}},sendUniformData:function(r,l){var a=this.chooseRightDelta();r.uniform2fv(l.delta,a)},chooseRightDelta:function(){var r=1,l=[0,0],a;return this.horizontal?this.aspectRatio>1&&(r=1/this.aspectRatio):this.aspectRatio<1&&(r=this.aspectRatio),a=r*this.blur*.12,this.horizontal?l[0]=a:l[1]=a,l}}),h.Blur.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.Gamma=f(h.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(r){this.gamma=[1,1,1],h.BaseFilter.prototype.initialize.call(this,r)},applyTo2d:function(r){var l=r.imageData,a=l.data,d=this.gamma,p=a.length,c=1/d[0],m=1/d[1],_=1/d[2],b;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),b=0,p=256;b<p;b++)this.rVals[b]=Math.pow(b/255,c)*255,this.gVals[b]=Math.pow(b/255,m)*255,this.bVals[b]=Math.pow(b/255,_)*255;for(b=0,p=a.length;b<p;b+=4)a[b]=this.rVals[a[b]],a[b+1]=this.gVals[a[b+1]],a[b+2]=this.bVals[a[b+2]]},getUniformLocations:function(r,l){return{uGamma:r.getUniformLocation(l,"uGamma")}},sendUniformData:function(r,l){r.uniform3fv(l.uGamma,this.gamma)}}),n.Image.filters.Gamma.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.Composed=f(h.BaseFilter,{type:"Composed",subFilters:[],initialize:function(r){this.callSuper("initialize",r),this.subFilters=this.subFilters.slice(0)},applyTo:function(r){r.passes+=this.subFilters.length-1,this.subFilters.forEach(function(l){l.applyTo(r)})},toObject:function(){return n.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(r){return r.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(r){return!r.isNeutralState()})}}),n.Image.filters.Composed.fromObject=function(r,l){var a=r.subFilters||[],d=a.map(function(c){return new n.Image.filters[c.type](c)}),p=new n.Image.filters.Composed({subFilters:d});return l&&l(p),p}}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.Image.filters,f=n.util.createClass;h.HueRotation=f(h.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var r=this.rotation*Math.PI,l=n.util.cos(r),a=n.util.sin(r),d=1/3,p=Math.sqrt(d)*a,c=1-l;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=l+c/3,this.matrix[1]=d*c-p,this.matrix[2]=d*c+p,this.matrix[5]=d*c+p,this.matrix[6]=l+d*c,this.matrix[7]=d*c-p,this.matrix[10]=d*c-p,this.matrix[11]=d*c+p,this.matrix[12]=l+d*c},isNeutralState:function(r){return this.calculateMatrix(),h.BaseFilter.prototype.isNeutralState.call(this,r)},applyTo:function(r){this.calculateMatrix(),h.BaseFilter.prototype.applyTo.call(this,r)}}),n.Image.filters.HueRotation.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(o){var n=o.fabric||(o.fabric={}),h=n.util.object.clone;if(n.Text){n.warn("fabric.Text is already defined");return}var f="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");n.Text=n.util.createClass(n.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:n.Object.prototype.stateProperties.concat(f),cacheProperties:n.Object.prototype.cacheProperties.concat(f),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(r,l){this.styles=l?l.styles||{}:{},this.text=r,this.__skipDimension=!0,this.callSuper("initialize",l),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var r=this.path;r&&(r.segmentsInfo=n.util.getPathSegmentsInfo(r.path))},getMeasuringContext:function(){return n._measuringContext||(n._measuringContext=this.canvas&&this.canvas.contextCache||n.util.createCanvasElement().getContext("2d")),n._measuringContext},_splitText:function(){var r=this._splitTextIntoLines(this.text);return this.textLines=r.lines,this._textLines=r.graphemeLines,this._unwrappedTextLines=r._unwrappedLines,this._text=r.graphemeText,r},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var r,l,a,d,p,c,m,_=0,b=this._textLines.length;_<b;_++)if(!(this.textAlign!=="justify"&&(_===b-1||this.isEndOfWrapping(_)))&&(d=0,p=this._textLines[_],l=this.getLineWidth(_),l<this.width&&(m=this.textLines[_].match(this._reSpacesAndTabs)))){a=m.length,r=(this.width-l)/a;for(var y=0,x=p.length;y<=x;y++)c=this.__charBounds[_][y],this._reSpaceAndTab.test(p[y])?(c.width+=r,c.kernedWidth+=r,c.left+=d,d+=r):c.left+=d}},isEndOfWrapping:function(r){return r===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var r=this.callSuper("_getCacheCanvasDimensions"),l=this.fontSize;return r.width+=l*r.zoomX,r.height+=l*r.zoomY,r},_render:function(r){var l=this.path;l&&!l.isNotVisible()&&l._render(r),this._setTextStyles(r),this._renderTextLinesBackground(r),this._renderTextDecoration(r,"underline"),this._renderText(r),this._renderTextDecoration(r,"overline"),this._renderTextDecoration(r,"linethrough")},_renderText:function(r){this.paintFirst==="stroke"?(this._renderTextStroke(r),this._renderTextFill(r)):(this._renderTextFill(r),this._renderTextStroke(r))},_setTextStyles:function(r,l,a){if(r.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":r.textBaseline="middle";break;case"ascender":r.textBaseline="top";break;case"descender":r.textBaseline="bottom";break}r.font=this._getFontDeclaration(l,a)},calcTextWidth:function(){for(var r=this.getLineWidth(0),l=1,a=this._textLines.length;l<a;l++){var d=this.getLineWidth(l);d>r&&(r=d)}return r},_renderTextLine:function(r,l,a,d,p,c){this._renderChars(r,l,a,d,p,c)},_renderTextLinesBackground:function(r){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var l,a,d=r.fillStyle,p,c,m=this._getLeftOffset(),_=this._getTopOffset(),b=0,y=0,x,C,T=this.path,k,E=0,z=this._textLines.length;E<z;E++){if(l=this.getHeightOfLine(E),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",E)){_+=l;continue}p=this._textLines[E],a=this._getLineLeftOffset(E),y=0,b=0,c=this.getValueOfPropertyAt(E,0,"textBackgroundColor");for(var N=0,$=p.length;N<$;N++)x=this.__charBounds[E][N],C=this.getValueOfPropertyAt(E,N,"textBackgroundColor"),T?(r.save(),r.translate(x.renderLeft,x.renderTop),r.rotate(x.angle),r.fillStyle=C,C&&r.fillRect(-x.width/2,-l/this.lineHeight*(1-this._fontSizeFraction),x.width,l/this.lineHeight),r.restore()):C!==c?(k=m+a+b,this.direction==="rtl"&&(k=this.width-k-y),r.fillStyle=c,c&&r.fillRect(k,_,y,l/this.lineHeight),b=x.left,y=x.width,c=C):y+=x.kernedWidth;C&&!T&&(k=m+a+b,this.direction==="rtl"&&(k=this.width-k-y),r.fillStyle=C,r.fillRect(k,_,y,l/this.lineHeight)),_+=l}r.fillStyle=d,this._removeShadow(r)}},getFontCache:function(r){var l=r.fontFamily.toLowerCase();n.charWidthsCache[l]||(n.charWidthsCache[l]={});var a=n.charWidthsCache[l],d=r.fontStyle.toLowerCase()+"_"+(r.fontWeight+"").toLowerCase();return a[d]||(a[d]={}),a[d]},_measureChar:function(r,l,a,d){var p=this.getFontCache(l),c=this._getFontDeclaration(l),m=this._getFontDeclaration(d),_=a+r,b=c===m,y,x,C,T=l.fontSize/this.CACHE_FONT_SIZE,k;if(a&&p[a]!==void 0&&(C=p[a]),p[r]!==void 0&&(k=y=p[r]),b&&p[_]!==void 0&&(x=p[_],k=x-C),y===void 0||C===void 0||x===void 0){var E=this.getMeasuringContext();this._setTextStyles(E,l,!0)}return y===void 0&&(k=y=E.measureText(r).width,p[r]=y),C===void 0&&b&&a&&(C=E.measureText(a).width,p[a]=C),b&&x===void 0&&(x=E.measureText(_).width,p[_]=x,k=x-C),{width:y*T,kernedWidth:k*T}},getHeightOfChar:function(r,l){return this.getValueOfPropertyAt(r,l,"fontSize")},measureLine:function(r){var l=this._measureLine(r);return this.charSpacing!==0&&(l.width-=this._getWidthOfCharSpacing()),l.width<0&&(l.width=0),l},_measureLine:function(r){var l=0,a,d,p=this._textLines[r],c,m,_=0,b=new Array(p.length),y=0,x,C,T=this.path,k=this.pathSide==="right";for(this.__charBounds[r]=b,a=0;a<p.length;a++)d=p[a],m=this._getGraphemeBox(d,r,a,c),b[a]=m,l+=m.kernedWidth,c=d;if(b[a]={left:m?m.left+m.width:0,width:0,kernedWidth:0,height:this.fontSize},T){switch(C=T.segmentsInfo[T.segmentsInfo.length-1].length,x=n.util.getPointOnPath(T.path,0,T.segmentsInfo),x.x+=T.pathOffset.x,x.y+=T.pathOffset.y,this.textAlign){case"left":y=k?C-l:0;break;case"center":y=(C-l)/2;break;case"right":y=k?0:C-l;break}for(y+=this.pathStartOffset*(k?-1:1),a=k?p.length-1:0;k?a>=0:a<p.length;k?a--:a++)m=b[a],y>C?y%=C:y<0&&(y+=C),this._setGraphemeOnPath(y,m,x),y+=m.kernedWidth}return{width:l,numOfSpaces:_}},_setGraphemeOnPath:function(r,l,a){var d=r+l.kernedWidth/2,p=this.path,c=n.util.getPointOnPath(p.path,d,p.segmentsInfo);l.renderLeft=c.x-a.x,l.renderTop=c.y-a.y,l.angle=c.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(r,l,a,d,p){var c=this.getCompleteStyleDeclaration(l,a),m=d?this.getCompleteStyleDeclaration(l,a-1):{},_=this._measureChar(r,c,d,m),b=_.kernedWidth,y=_.width,x;this.charSpacing!==0&&(x=this._getWidthOfCharSpacing(),y+=x,b+=x);var C={width:y,left:0,height:c.fontSize,kernedWidth:b,deltaY:c.deltaY};if(a>0&&!p){var T=this.__charBounds[l][a-1];C.left=T.left+T.width+_.kernedWidth-_.width}return C},getHeightOfLine:function(r){if(this.__lineHeights[r])return this.__lineHeights[r];for(var l=this._textLines[r],a=this.getHeightOfChar(r,0),d=1,p=l.length;d<p;d++)a=Math.max(this.getHeightOfChar(r,d),a);return this.__lineHeights[r]=a*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var r,l=0,a=0,d=this._textLines.length;a<d;a++)r=this.getHeightOfLine(a),l+=a===d-1?r/this.lineHeight:r;return l},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(r,l){r.save();for(var a=0,d=this._getLeftOffset(),p=this._getTopOffset(),c=0,m=this._textLines.length;c<m;c++){var _=this.getHeightOfLine(c),b=_/this.lineHeight,y=this._getLineLeftOffset(c);this._renderTextLine(l,r,this._textLines[c],d+y,p+a+b,c),a+=_}r.restore()},_renderTextFill:function(r){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(r,"fillText")},_renderTextStroke:function(r){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(r),r.save(),this._setLineDash(r,this.strokeDashArray),r.beginPath(),this._renderTextCommon(r,"strokeText"),r.closePath(),r.restore())},_renderChars:function(r,l,a,d,p,c){var m=this.getHeightOfLine(c),_=this.textAlign.indexOf("justify")!==-1,b,y,x="",C,T=0,k,E=this.path,z=!_&&this.charSpacing===0&&this.isEmptyStyles(c)&&!E,N=this.direction==="ltr",$=this.direction==="ltr"?1:-1,J,K=l.canvas.getAttribute("dir");if(l.save(),K!==this.direction&&(l.canvas.setAttribute("dir",N?"ltr":"rtl"),l.direction=N?"ltr":"rtl",l.textAlign=N?"left":"right"),p-=m*this._fontSizeFraction/this.lineHeight,z){this._renderChar(r,l,c,0,a.join(""),d,p,m),l.restore();return}for(var G=0,Q=a.length-1;G<=Q;G++)k=G===Q||this.charSpacing||E,x+=a[G],C=this.__charBounds[c][G],T===0?(d+=$*(C.kernedWidth-C.width),T+=C.width):T+=C.kernedWidth,_&&!k&&this._reSpaceAndTab.test(a[G])&&(k=!0),k||(b=b||this.getCompleteStyleDeclaration(c,G),y=this.getCompleteStyleDeclaration(c,G+1),k=n.util.hasStyleChanged(b,y,!1)),k&&(E?(l.save(),l.translate(C.renderLeft,C.renderTop),l.rotate(C.angle),this._renderChar(r,l,c,G,x,-T/2,0,m),l.restore()):(J=d,this._renderChar(r,l,c,G,x,J,p,m)),x="",b=y,d+=$*T,T=0);l.restore()},_applyPatternGradientTransformText:function(r){var l=n.util.createCanvasElement(),a,d=this.width+this.strokeWidth,p=this.height+this.strokeWidth;return l.width=d,l.height=p,a=l.getContext("2d"),a.beginPath(),a.moveTo(0,0),a.lineTo(d,0),a.lineTo(d,p),a.lineTo(0,p),a.closePath(),a.translate(d/2,p/2),a.fillStyle=r.toLive(a),this._applyPatternGradientTransform(a,r),a.fill(),a.createPattern(l,"no-repeat")},handleFiller:function(r,l,a){var d,p;return a.toLive?a.gradientUnits==="percentage"||a.gradientTransform||a.patternTransform?(d=-this.width/2,p=-this.height/2,r.translate(d,p),r[l]=this._applyPatternGradientTransformText(a),{offsetX:d,offsetY:p}):(r[l]=a.toLive(r,this),this._applyPatternGradientTransform(r,a)):(r[l]=a,{offsetX:0,offsetY:0})},_setStrokeStyles:function(r,l){return r.lineWidth=l.strokeWidth,r.lineCap=this.strokeLineCap,r.lineDashOffset=this.strokeDashOffset,r.lineJoin=this.strokeLineJoin,r.miterLimit=this.strokeMiterLimit,this.handleFiller(r,"strokeStyle",l.stroke)},_setFillStyles:function(r,l){return this.handleFiller(r,"fillStyle",l.fill)},_renderChar:function(r,l,a,d,p,c,m){var _=this._getStyleDeclaration(a,d),b=this.getCompleteStyleDeclaration(a,d),y=r==="fillText"&&b.fill,x=r==="strokeText"&&b.stroke&&b.strokeWidth,C,T;!x&&!y||(l.save(),y&&(C=this._setFillStyles(l,b)),x&&(T=this._setStrokeStyles(l,b)),l.font=this._getFontDeclaration(b),_&&_.textBackgroundColor&&this._removeShadow(l),_&&_.deltaY&&(m+=_.deltaY),y&&l.fillText(p,c-C.offsetX,m-C.offsetY),x&&l.strokeText(p,c-T.offsetX,m-T.offsetY),l.restore())},setSuperscript:function(r,l){return this._setScript(r,l,this.superscript)},setSubscript:function(r,l){return this._setScript(r,l,this.subscript)},_setScript:function(r,l,a){var d=this.get2DCursorLocation(r,!0),p=this.getValueOfPropertyAt(d.lineIndex,d.charIndex,"fontSize"),c=this.getValueOfPropertyAt(d.lineIndex,d.charIndex,"deltaY"),m={fontSize:p*a.size,deltaY:c+p*a.baseline};return this.setSelectionStyles(m,r,l),this},_getLineLeftOffset:function(r){var l=this.getLineWidth(r),a=this.width-l,d=this.textAlign,p=this.direction,m,c=0,m=this.isEndOfWrapping(r);return d==="justify"||d==="justify-center"&&!m||d==="justify-right"&&!m||d==="justify-left"&&!m?0:(d==="center"&&(c=a/2),d==="right"&&(c=a),d==="justify-center"&&(c=a/2),d==="justify-right"&&(c=a),p==="rtl"&&(c-=a),c)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var r=this._forceClearCache;return r||(r=this.hasStateChanged("_dimensionAffectingProps")),r&&(this.dirty=!0,this._forceClearCache=!1),r},getLineWidth:function(r){if(this.__lineWidths[r]!==void 0)return this.__lineWidths[r];var l=this.measureLine(r),a=l.width;return this.__lineWidths[r]=a,a},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(r,l,a){var d=this._getStyleDeclaration(r,l);return d&&typeof d[a]<"u"?d[a]:this[a]},_renderTextDecoration:function(r,l){if(!(!this[l]&&!this.styleHas(l))){for(var a,d,p,c,m,_,b,y,x=this._getLeftOffset(),C=this._getTopOffset(),T,k,E,z,N,$,J,K,G=this.path,Q=this._getWidthOfCharSpacing(),tt=this.offsets[l],it=0,w=this._textLines.length;it<w;it++){if(a=this.getHeightOfLine(it),!this[l]&&!this.styleHas(l,it)){C+=a;continue}b=this._textLines[it],$=a/this.lineHeight,c=this._getLineLeftOffset(it),k=0,E=0,y=this.getValueOfPropertyAt(it,0,l),K=this.getValueOfPropertyAt(it,0,"fill"),T=C+$*(1-this._fontSizeFraction),d=this.getHeightOfChar(it,0),m=this.getValueOfPropertyAt(it,0,"deltaY");for(var M=0,D=b.length;M<D;M++)if(z=this.__charBounds[it][M],N=this.getValueOfPropertyAt(it,M,l),J=this.getValueOfPropertyAt(it,M,"fill"),p=this.getHeightOfChar(it,M),_=this.getValueOfPropertyAt(it,M,"deltaY"),G&&N&&J)r.save(),r.fillStyle=K,r.translate(z.renderLeft,z.renderTop),r.rotate(z.angle),r.fillRect(-z.kernedWidth/2,tt*p+_,z.kernedWidth,this.fontSize/15),r.restore();else if((N!==y||J!==K||p!==d||_!==m)&&E>0){var P=x+c+k;this.direction==="rtl"&&(P=this.width-P-E),y&&K&&(r.fillStyle=K,r.fillRect(P,T+tt*d+m,E,this.fontSize/15)),k=z.left,E=z.width,y=N,K=J,d=p,m=_}else E+=z.kernedWidth;var P=x+c+k;this.direction==="rtl"&&(P=this.width-P-E),r.fillStyle=J,N&&J&&r.fillRect(P,T+tt*d+m,E-Q,this.fontSize/15),C+=a}this._removeShadow(r)}},_getFontDeclaration:function(r,l){var a=r||this,d=this.fontFamily,p=n.Text.genericFonts.indexOf(d.toLowerCase())>-1,c=d===void 0||d.indexOf("'")>-1||d.indexOf(",")>-1||d.indexOf('"')>-1||p?a.fontFamily:'"'+a.fontFamily+'"';return[n.isLikelyNode?a.fontWeight:a.fontStyle,n.isLikelyNode?a.fontStyle:a.fontWeight,l?this.CACHE_FONT_SIZE+"px":a.fontSize+"px",c].join(" ")},render:function(r){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",r)))},_splitTextIntoLines:function(r){for(var l=r.split(this._reNewline),a=new Array(l.length),d=[`
`],p=[],c=0;c<l.length;c++)a[c]=n.util.string.graphemeSplit(l[c]),p=p.concat(a[c],d);return p.pop(),{_unwrappedLines:a,lines:l,graphemeText:p,graphemeLines:a}},toObject:function(r){var l=f.concat(r),a=this.callSuper("toObject",l);return a.styles=n.util.stylesToArray(this.styles,this.text),a.path&&(a.path=this.path.toObject()),a},set:function(r,l){this.callSuper("set",r,l);var a=!1,d=!1;if(typeof r=="object")for(var p in r)p==="path"&&this.setPathInfo(),a=a||this._dimensionAffectingProps.indexOf(p)!==-1,d=d||p==="path";else a=this._dimensionAffectingProps.indexOf(r)!==-1,d=r==="path";return d&&this.setPathInfo(),a&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),n.Text.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),n.Text.DEFAULT_SVG_FONT_SIZE=16,n.Text.fromElement=function(r,l,a){if(!r)return l(null);var d=n.parseAttributes(r,n.Text.ATTRIBUTE_NAMES),p=d.textAnchor||"left";if(a=n.util.object.extend(a?h(a):{},d),a.top=a.top||0,a.left=a.left||0,d.textDecoration){var c=d.textDecoration;c.indexOf("underline")!==-1&&(a.underline=!0),c.indexOf("overline")!==-1&&(a.overline=!0),c.indexOf("line-through")!==-1&&(a.linethrough=!0),delete a.textDecoration}"dx"in d&&(a.left+=d.dx),"dy"in d&&(a.top+=d.dy),"fontSize"in a||(a.fontSize=n.Text.DEFAULT_SVG_FONT_SIZE);var m="";"textContent"in r?m=r.textContent:"firstChild"in r&&r.firstChild!==null&&"data"in r.firstChild&&r.firstChild.data!==null&&(m=r.firstChild.data),m=m.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var _=a.strokeWidth;a.strokeWidth=0;var b=new n.Text(m,a),y=b.getScaledHeight()/b.height,x=(b.height+b.strokeWidth)*b.lineHeight-b.height,C=x*y,T=b.getScaledHeight()+C,k=0;p==="center"&&(k=b.getScaledWidth()/2),p==="right"&&(k=b.getScaledWidth()),b.set({left:b.left-k,top:b.top-(T-b.fontSize*(.07+b._fontSizeFraction))/b.lineHeight,strokeWidth:typeof _<"u"?_:1}),l(b)},n.Text.fromObject=function(r,l){var a=h(r),d=r.path;return delete a.path,n.Object._fromObject("Text",a,function(p){p.styles=n.util.stylesFromArray(r.styles,r.text),d?n.Object._fromObject("Path",d,function(c){p.set("path",c),l(p)},"path"):l(p)},"text")},n.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],n.util.createAccessors&&n.util.createAccessors(n.Text)}(i),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(o){if(!this.styles||typeof o<"u"&&!this.styles[o])return!0;var n=typeof o>"u"?this.styles:{line:this.styles[o]};for(var h in n)for(var f in n[h])for(var r in n[h][f])return!1;return!0},styleHas:function(o,n){if(!this.styles||!o||o===""||typeof n<"u"&&!this.styles[n])return!1;var h=typeof n>"u"?this.styles:{0:this.styles[n]};for(var f in h)for(var r in h[f])if(typeof h[f][r][o]<"u")return!0;return!1},cleanStyle:function(o){if(!this.styles||!o||o==="")return!1;var n=this.styles,h=0,f,r,l=!0,a=0,d;for(var p in n){f=0;for(var c in n[p]){var d=n[p][c],m=d.hasOwnProperty(o);h++,m?(r?d[o]!==r&&(l=!1):r=d[o],d[o]===this[o]&&delete d[o]):l=!1,Object.keys(d).length!==0?f++:delete n[p][c]}f===0&&delete n[p]}for(var _=0;_<this._textLines.length;_++)a+=this._textLines[_].length;l&&h===a&&(this[o]=r,this.removeStyle(o))},removeStyle:function(o){if(!(!this.styles||!o||o==="")){var n=this.styles,h,f,r;for(f in n){h=n[f];for(r in h)delete h[r][o],Object.keys(h[r]).length===0&&delete h[r];Object.keys(h).length===0&&delete n[f]}}},_extendStyles:function(o,n){var h=this.get2DCursorLocation(o);this._getLineStyle(h.lineIndex)||this._setLineStyle(h.lineIndex),this._getStyleDeclaration(h.lineIndex,h.charIndex)||this._setStyleDeclaration(h.lineIndex,h.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(h.lineIndex,h.charIndex),n)},get2DCursorLocation:function(o,n){typeof o>"u"&&(o=this.selectionStart);for(var h=n?this._unwrappedTextLines:this._textLines,f=h.length,r=0;r<f;r++){if(o<=h[r].length)return{lineIndex:r,charIndex:o};o-=h[r].length+this.missingNewlineOffset(r)}return{lineIndex:r-1,charIndex:h[r-1].length<o?h[r-1].length:o}},getSelectionStyles:function(o,n,h){typeof o>"u"&&(o=this.selectionStart||0),typeof n>"u"&&(n=this.selectionEnd||o);for(var f=[],r=o;r<n;r++)f.push(this.getStyleAtPosition(r,h));return f},getStyleAtPosition:function(o,n){var h=this.get2DCursorLocation(o),f=n?this.getCompleteStyleDeclaration(h.lineIndex,h.charIndex):this._getStyleDeclaration(h.lineIndex,h.charIndex);return f||{}},setSelectionStyles:function(o,n,h){typeof n>"u"&&(n=this.selectionStart||0),typeof h>"u"&&(h=this.selectionEnd||n);for(var f=n;f<h;f++)this._extendStyles(f,o);return this._forceClearCache=!0,this},_getStyleDeclaration:function(o,n){var h=this.styles&&this.styles[o];return h?h[n]:null},getCompleteStyleDeclaration:function(o,n){for(var h=this._getStyleDeclaration(o,n)||{},f={},r,l=0;l<this._styleProperties.length;l++)r=this._styleProperties[l],f[r]=typeof h[r]>"u"?this[r]:h[r];return f},_setStyleDeclaration:function(o,n,h){this.styles[o][n]=h},_deleteStyleDeclaration:function(o,n){delete this.styles[o][n]},_getLineStyle:function(o){return!!this.styles[o]},_setLineStyle:function(o){this.styles[o]={}},_deleteLineStyle:function(o){delete this.styles[o]}})}(),function(){function o(n){n.textDecoration&&(n.textDecoration.indexOf("underline")>-1&&(n.underline=!0),n.textDecoration.indexOf("line-through")>-1&&(n.linethrough=!0),n.textDecoration.indexOf("overline")>-1&&(n.overline=!0),delete n.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(n,h){this.callSuper("initialize",n,h),this.initBehavior()},setSelectionStart:function(n){n=Math.max(n,0),this._updateAndFire("selectionStart",n)},setSelectionEnd:function(n){n=Math.min(n,this.text.length),this._updateAndFire("selectionEnd",n)},_updateAndFire:function(n,h){this[n]!==h&&(this._fireSelectionChanged(),this[n]=h),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(n){this.clearContextTop(),this.callSuper("render",n),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(n){this.callSuper("_render",n)},clearContextTop:function(n){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var h=this.canvas.contextTop,f=this.canvas.viewportTransform;h.save(),h.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this.transform(h),this._clearTextArea(h),n||h.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var n=this._getCursorBoundaries(),h=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(n,h):this.renderSelection(n,h),h.restore()}},_clearTextArea:function(n){var h=this.width+4,f=this.height+4;n.clearRect(-h/2,-f/2,h,f)},_getCursorBoundaries:function(n){typeof n>"u"&&(n=this.selectionStart);var h=this._getLeftOffset(),f=this._getTopOffset(),r=this._getCursorBoundariesOffsets(n);return{left:h,top:f,leftOffset:r.left,topOffset:r.top}},_getCursorBoundariesOffsets:function(n){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var h,f,r,l=0,a=0,d,p=this.get2DCursorLocation(n);r=p.charIndex,f=p.lineIndex;for(var c=0;c<f;c++)l+=this.getHeightOfLine(c);h=this._getLineLeftOffset(f);var m=this.__charBounds[f][r];return m&&(a=m.left),this.charSpacing!==0&&r===this._textLines[f].length&&(a-=this._getWidthOfCharSpacing()),d={top:l,left:h+(a>0?a:0)},this.direction==="rtl"&&(d.left*=-1),this.cursorOffsetCache=d,this.cursorOffsetCache},renderCursor:function(n,h){var f=this.get2DCursorLocation(),r=f.lineIndex,l=f.charIndex>0?f.charIndex-1:0,a=this.getValueOfPropertyAt(r,l,"fontSize"),d=this.scaleX*this.canvas.getZoom(),p=this.cursorWidth/d,c=n.topOffset,m=this.getValueOfPropertyAt(r,l,"deltaY");c+=(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-a*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(n,h),h.fillStyle=this.cursorColor||this.getValueOfPropertyAt(r,l,"fill"),h.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,h.fillRect(n.left+n.leftOffset-p/2,c+n.top+m,p,a)},renderSelection:function(n,h){for(var f=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,r=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,l=this.textAlign.indexOf("justify")!==-1,a=this.get2DCursorLocation(f),d=this.get2DCursorLocation(r),p=a.lineIndex,c=d.lineIndex,m=a.charIndex<0?0:a.charIndex,_=d.charIndex<0?0:d.charIndex,b=p;b<=c;b++){var y=this._getLineLeftOffset(b)||0,x=this.getHeightOfLine(b),C=0,T=0,k=0;if(b===p&&(T=this.__charBounds[p][m].left),b>=p&&b<c)k=l&&!this.isEndOfWrapping(b)?this.width:this.getLineWidth(b)||5;else if(b===c)if(_===0)k=this.__charBounds[c][_].left;else{var E=this._getWidthOfCharSpacing();k=this.__charBounds[c][_-1].left+this.__charBounds[c][_-1].width-E}C=x,(this.lineHeight<1||b===c&&this.lineHeight>1)&&(x/=this.lineHeight);var z=n.left+y+T,N=k-T,$=x,J=0;this.inCompositionMode?(h.fillStyle=this.compositionColor||"black",$=1,J=x):h.fillStyle=this.selectionColor,this.direction==="rtl"&&(z=this.width-z-N),h.fillRect(z,n.top+n.topOffset+J,N,$),n.topOffset+=C}},getCurrentCharFontSize:function(){var n=this._getCurrentCharIndex();return this.getValueOfPropertyAt(n.l,n.c,"fontSize")},getCurrentCharColor:function(){var n=this._getCurrentCharIndex();return this.getValueOfPropertyAt(n.l,n.c,"fill")},_getCurrentCharIndex:function(){var n=this.get2DCursorLocation(this.selectionStart,!0),h=n.charIndex>0?n.charIndex-1:0;return{l:n.lineIndex,c:h}}}),t.IText.fromObject=function(n,h){var f=t.util.stylesFromArray(n.styles,n.text),r=Object.assign({},n,{styles:f});if(o(r),r.styles)for(var l in r.styles)for(var a in r.styles[l])o(r.styles[l][a]);t.Object._fromObject("IText",r,h,"text")}}(),function(){var o=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var n=this;this.on("added",function(){var h=n.canvas;h&&(h._hasITextHandlers||(h._hasITextHandlers=!0,n._initCanvasHandlers(h)),h._iTextInstances=h._iTextInstances||[],h._iTextInstances.push(n))})},initRemovedHandler:function(){var n=this;this.on("removed",function(){var h=n.canvas;h&&(h._iTextInstances=h._iTextInstances||[],t.util.removeFromArray(h._iTextInstances,n),h._iTextInstances.length===0&&(h._hasITextHandlers=!1,n._removeCanvasHandlers(h)))})},_initCanvasHandlers:function(n){n._mouseUpITextHandler=function(){n._iTextInstances&&n._iTextInstances.forEach(function(h){h.__isMousedown=!1})},n.on("mouse:up",n._mouseUpITextHandler)},_removeCanvasHandlers:function(n){n.off("mouse:up",n._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(n,h,f,r){var l;return l={isAborted:!1,abort:function(){this.isAborted=!0}},n.animate("_currentCursorOpacity",h,{duration:f,onComplete:function(){l.isAborted||n[r]()},onChange:function(){n.canvas&&n.selectionStart===n.selectionEnd&&n.renderCursorOrSelection()},abort:function(){return l.isAborted}}),l},_onTickComplete:function(){var n=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){n._currentTickCompleteState=n._animateCursor(n,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(n){var h=this,f=n?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){h._tick()},f)},abortCursorAnimation:function(){var n=this._currentTickState||this._currentTickCompleteState,h=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,n&&h&&h.clearContext(h.contextTop||h.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(n){var h=0,f=n-1;if(this._reSpace.test(this._text[f]))for(;this._reSpace.test(this._text[f]);)h++,f--;for(;/\S/.test(this._text[f])&&f>-1;)h++,f--;return n-h},findWordBoundaryRight:function(n){var h=0,f=n;if(this._reSpace.test(this._text[f]))for(;this._reSpace.test(this._text[f]);)h++,f++;for(;/\S/.test(this._text[f])&&f<this._text.length;)h++,f++;return n+h},findLineBoundaryLeft:function(n){for(var h=0,f=n-1;!/\n/.test(this._text[f])&&f>-1;)h++,f--;return n-h},findLineBoundaryRight:function(n){for(var h=0,f=n;!/\n/.test(this._text[f])&&f<this._text.length;)h++,f++;return n+h},searchWordBoundary:function(n,h){for(var f=this._text,r=this._reSpace.test(f[n])?n-1:n,l=f[r],a=t.reNonWord;!a.test(l)&&r>0&&r<f.length;)r+=h,l=f[r];return a.test(l)&&(r+=h===1?0:1),r},selectWord:function(n){n=n||this.selectionStart;var h=this.searchWordBoundary(n,-1),f=this.searchWordBoundary(n,1);this.selectionStart=h,this.selectionEnd=f,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(n){n=n||this.selectionStart;var h=this.findLineBoundaryLeft(n),f=this.findLineBoundaryRight(n);return this.selectionStart=h,this.selectionEnd=f,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(n){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(n),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(n){n._iTextInstances&&n._iTextInstances.forEach(function(h){h.selected=!1,h.isEditing&&h.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(n){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var h=this.getSelectionStartFromPointer(n.e),f=this.selectionStart,r=this.selectionEnd;(h!==this.__selectionStartOnMouseDown||f===r)&&(f===h||r===h)||(h>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=h):(this.selectionStart=h,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==f||this.selectionEnd!==r)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(n,h,f){var r=f.slice(0,n),l=t.util.string.graphemeSplit(r).length;if(n===h)return{selectionStart:l,selectionEnd:l};var a=f.slice(n,h),d=t.util.string.graphemeSplit(a).length;return{selectionStart:l,selectionEnd:l+d}},fromGraphemeToStringSelection:function(n,h,f){var r=f.slice(0,n),l=r.join("").length;if(n===h)return{selectionStart:l,selectionEnd:l};var a=f.slice(n,h),d=a.join("").length;return{selectionStart:l,selectionEnd:l+d}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var n=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=n.selectionStart,this.hiddenTextarea.selectionEnd=n.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var n=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=n.selectionEnd,this.inCompositionMode||(this.selectionStart=n.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var n=this._calcTextareaPosition();this.hiddenTextarea.style.left=n.left,this.hiddenTextarea.style.top=n.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var n=this.inCompositionMode?this.compositionStart:this.selectionStart,h=this._getCursorBoundaries(n),f=this.get2DCursorLocation(n),r=f.lineIndex,l=f.charIndex,a=this.getValueOfPropertyAt(r,l,"fontSize")*this.lineHeight,d=h.leftOffset,p=this.calcTransformMatrix(),c={x:h.left+d,y:h.top+h.topOffset+a},m=this.canvas.getRetinaScaling(),_=this.canvas.upperCanvasEl,b=_.width/m,y=_.height/m,x=b-a,C=y-a,T=_.clientWidth/b,k=_.clientHeight/y;return c=t.util.transformPoint(c,p),c=t.util.transformPoint(c,this.canvas.viewportTransform),c.x*=T,c.y*=k,c.x<0&&(c.x=0),c.x>x&&(c.x=x),c.y<0&&(c.y=0),c.y>C&&(c.y=C),c.x+=this.canvas._offset.left,c.y+=this.canvas._offset.top,{left:c.x+"px",top:c.y+"px",fontSize:a+"px",charHeight:a}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var n=this._textBeforeEdit!==this.text,h=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,h&&(h.blur&&h.blur(),h.parentNode&&h.parentNode.removeChild(h)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),n&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),n&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var n in this.styles)this._textLines[n]||delete this.styles[n]},removeStyleFromTo:function(n,h){var f=this.get2DCursorLocation(n,!0),r=this.get2DCursorLocation(h,!0),l=f.lineIndex,a=f.charIndex,d=r.lineIndex,p=r.charIndex,c,m;if(l!==d){if(this.styles[l])for(c=a;c<this._unwrappedTextLines[l].length;c++)delete this.styles[l][c];if(this.styles[d])for(c=p;c<this._unwrappedTextLines[d].length;c++)m=this.styles[d][c],m&&(this.styles[l]||(this.styles[l]={}),this.styles[l][a+c-p]=m);for(c=l+1;c<=d;c++)delete this.styles[c];this.shiftLineStyles(d,l-d)}else if(this.styles[l]){m=this.styles[l];var _=p-a,b,y;for(c=a;c<p;c++)delete m[c];for(y in this.styles[l])b=parseInt(y,10),b>=p&&(m[b-_]=m[y],delete m[y])}},shiftLineStyles:function(n,h){var f=o(this.styles);for(var r in this.styles){var l=parseInt(r,10);l>n&&(this.styles[l+h]=f[l],f[l-h]||delete this.styles[l])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(n,h,f,r){var l,a={},d=!1,p=this._unwrappedTextLines[n].length===h;f||(f=1),this.shiftLineStyles(n,f),this.styles[n]&&(l=this.styles[n][h===0?h:h-1]);for(var c in this.styles[n]){var m=parseInt(c,10);m>=h&&(d=!0,a[m-h]=this.styles[n][c],p&&h===0||delete this.styles[n][c])}var _=!1;for(d&&!p&&(this.styles[n+f]=a,_=!0),_&&f--;f>0;)r&&r[f-1]?this.styles[n+f]={0:o(r[f-1])}:l?this.styles[n+f]={0:o(l)}:delete this.styles[n+f],f--;this._forceClearCache=!0},insertCharStyleObject:function(n,h,f,r){this.styles||(this.styles={});var l=this.styles[n],a=l?o(l):{};f||(f=1);for(var d in a){var p=parseInt(d,10);p>=h&&(l[p+f]=a[p],a[p-f]||delete l[p])}if(this._forceClearCache=!0,r){for(;f--;)Object.keys(r[f]).length&&(this.styles[n]||(this.styles[n]={}),this.styles[n][h+f]=o(r[f]));return}if(l)for(var c=l[h?h-1:1];c&&f--;)this.styles[n][h+f]=o(c)},insertNewStyleBlock:function(n,h,f){for(var r=this.get2DCursorLocation(h,!0),l=[0],a=0,d=0;d<n.length;d++)n[d]===`
`?(a++,l[a]=0):l[a]++;l[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,l[0],f),f=f&&f.slice(l[0]+1)),a&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+l[0],a);for(var d=1;d<a;d++)l[d]>0?this.insertCharStyleObject(r.lineIndex+d,0,l[d],f):f&&this.styles[r.lineIndex+d]&&f[0]&&(this.styles[r.lineIndex+d][0]=f[0]),f=f&&f.slice(l[d]+1);l[d]>0&&this.insertCharStyleObject(r.lineIndex+d,0,l[d],f)},setSelectionStartEndWithShift:function(n,h,f){f<=n?(h===n?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=n),this.selectionStart=f):f>n&&f<h?this._selectionDirection==="right"?this.selectionEnd=f:this.selectionStart=f:(h===n?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=h),this.selectionEnd=f)},setSelectionInBoundaries:function(){var n=this.text.length;this.selectionStart>n?this.selectionStart=n:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>n?this.selectionEnd=n:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(o){if(this.canvas){this.__newClickTime=+new Date;var n=o.pointer;this.isTripleClick(n)&&(this.fire("tripleclick",o),this._stopEvent(o.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=n,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(o){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===o.x&&this.__lastPointer.y===o.y},_stopEvent:function(o){o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(o){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(o.e))},tripleClickHandler:function(o){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(o.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(o.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(o){if(this.__isMousedown=!1,!(!this.editable||this.group||o.transform&&o.transform.actionPerformed||o.e.button&&o.e.button!==1)){if(this.canvas){var n=this.canvas._activeObject;if(n&&n!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(o.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(o){var n=this.getSelectionStartFromPointer(o),h=this.selectionStart,f=this.selectionEnd;o.shiftKey?this.setSelectionStartEndWithShift(h,f,n):(this.selectionStart=n,this.selectionEnd=n),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(o){for(var n=this.getLocalPointer(o),h=0,f=0,r=0,l=0,a=0,d,p,c=0,m=this._textLines.length;c<m&&r<=n.y;c++)r+=this.getHeightOfLine(c)*this.scaleY,a=c,c>0&&(l+=this._textLines[c-1].length+this.missingNewlineOffset(c-1));d=this._getLineLeftOffset(a),f=d*this.scaleX,p=this._textLines[a],this.direction==="rtl"&&(n.x=this.width*this.scaleX-n.x+f);for(var _=0,b=p.length;_<b&&(h=f,f+=this.__charBounds[a][_].kernedWidth*this.scaleX,f<=n.x);_++)l++;return this._getNewSelectionStartFromOffset(n,h,f,l,b)},_getNewSelectionStartFromOffset:function(o,n,h,f,r){var l=o.x-n,a=h-o.x,d=a>l||a<0?0:1,p=f+d;return this.flipX&&(p=r-p),p>this._text.length&&(p=this._text.length),p}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var o=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+o.top+"; left: "+o.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+o.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(o){if(this.isEditing){var n=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(o.keyCode in n)this[n[o.keyCode]](o);else if(o.keyCode in this.ctrlKeysMapDown&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapDown[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),o.keyCode>=33&&o.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(o){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(o.keyCode in this.ctrlKeysMapUp&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapUp[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(o){var n=this.fromPaste;if(this.fromPaste=!1,o&&o.stopPropagation(),!!this.isEditing){var h=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,f=this._text.length,r=h.length,l,a,d=r-f,p=this.selectionStart,c=this.selectionEnd,m=p!==c,_,b,y;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var x=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),C=p>x.selectionStart;m?(l=this._text.slice(p,c),d+=c-p):r<f&&(C?l=this._text.slice(c+d,c):l=this._text.slice(p,p-d)),a=h.slice(x.selectionEnd-d,x.selectionEnd),l&&l.length&&(a.length&&(_=this.getSelectionStyles(p,p+1,!1),_=a.map(function(){return _[0]})),m?(b=p,y=c):C?(b=c-l.length,y=c):(b=c,y=c+l.length),this.removeStyleFromTo(b,y)),a.length&&(n&&a.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(_=t.copiedTextStyle),this.insertNewStyleBlock(a,p,_)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(o){this.compositionStart=o.target.selectionStart,this.compositionEnd=o.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(o){return o&&o.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(o,n){var h=this._getLineLeftOffset(o),f;return n>0&&(f=this.__charBounds[o][n-1],h+=f.left+f.width),h},getDownCursorOffset:function(o,n){var h=this._getSelectionForOffset(o,n),f=this.get2DCursorLocation(h),r=f.lineIndex;if(r===this._textLines.length-1||o.metaKey||o.keyCode===34)return this._text.length-h;var l=f.charIndex,a=this._getWidthBeforeCursor(r,l),d=this._getIndexOnLine(r+1,a),p=this._textLines[r].slice(l);return p.length+d+1+this.missingNewlineOffset(r)},_getSelectionForOffset:function(o,n){return o.shiftKey&&this.selectionStart!==this.selectionEnd&&n?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(o,n){var h=this._getSelectionForOffset(o,n),f=this.get2DCursorLocation(h),r=f.lineIndex;if(r===0||o.metaKey||o.keyCode===33)return-h;var l=f.charIndex,a=this._getWidthBeforeCursor(r,l),d=this._getIndexOnLine(r-1,a),p=this._textLines[r].slice(0,l),c=this.missingNewlineOffset(r-1);return-this._textLines[r-1].length+d-p.length+(1-c)},_getIndexOnLine:function(o,n){for(var h=this._textLines[o],f=this._getLineLeftOffset(o),r=f,l=0,a,d,p=0,c=h.length;p<c;p++)if(a=this.__charBounds[o][p].width,r+=a,r>n){d=!0;var m=r-a,_=r,b=Math.abs(m-n),y=Math.abs(_-n);l=y<b?p:p-1;break}return d||(l=h.length-1),l},moveCursorDown:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",o)},moveCursorUp:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",o)},_moveCursorUpOrDown:function(o,n){var h="get"+o+"CursorOffset",f=this[h](n,this._selectionDirection==="right");n.shiftKey?this.moveCursorWithShift(f):this.moveCursorWithoutShift(f),f!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(o){var n=this._selectionDirection==="left"?this.selectionStart+o:this.selectionEnd+o;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,n),o!==0},moveCursorWithoutShift:function(o){return o<0?(this.selectionStart+=o,this.selectionEnd=this.selectionStart):(this.selectionEnd+=o,this.selectionStart=this.selectionEnd),o!==0},moveCursorLeft:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",o)},_move:function(o,n,h){var f;if(o.altKey)f=this["findWordBoundary"+h](this[n]);else if(o.metaKey||o.keyCode===35||o.keyCode===36)f=this["findLineBoundary"+h](this[n]);else return this[n]+=h==="Left"?-1:1,!0;if(typeof f<"u"&&this[n]!==f)return this[n]=f,!0},_moveLeft:function(o,n){return this._move(o,n,"Left")},_moveRight:function(o,n){return this._move(o,n,"Right")},moveCursorLeftWithoutShift:function(o){var n=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(n=this._moveLeft(o,"selectionStart")),this.selectionEnd=this.selectionStart,n},moveCursorLeftWithShift:function(o){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(o,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(o,"selectionStart")},moveCursorRight:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",o)},_moveCursorLeftOrRight:function(o,n){var h="moveCursor"+o+"With";this._currentCursorOpacity=1,n.shiftKey?h+="Shift":h+="outShift",this[h](n)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(o){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(o,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(o,"selectionEnd")},moveCursorRightWithoutShift:function(o){var n=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(n=this._moveRight(o,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,n},removeChars:function(o,n){typeof n>"u"&&(n=o+1),this.removeStyleFromTo(o,n),this._text.splice(o,n-o),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(o,n,h,f){typeof f>"u"&&(f=h),f>h&&this.removeStyleFromTo(h,f);var r=t.util.string.graphemeSplit(o);this.insertNewStyleBlock(r,h,n),this._text=[].concat(this._text.slice(0,h),r,this._text.slice(f)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var o=t.util.toFixed,n=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var h=this._getSVGLeftTopOffsets(),f=this._getSVGTextAndBg(h.textTop,h.textLeft);return this._wrapSVGTextAndBg(f)},toSVG:function(h){return this._createBaseSVGMarkup(this._toSVG(),{reviver:h,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(h){var f=!0,r=this.getSvgTextDecoration(this);return[h.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",r?'text-decoration="'+r+'" ':"",'style="',this.getSvgStyles(f),'"',this.addPaintOrder()," >",h.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(h,f){var r=[],l=[],a=h,d;this._setSVGBg(l);for(var p=0,c=this._textLines.length;p<c;p++)d=this._getLineLeftOffset(p),(this.textBackgroundColor||this.styleHas("textBackgroundColor",p))&&this._setSVGTextLineBg(l,p,f+d,a),this._setSVGTextLineText(r,p,f+d,a),a+=this.getHeightOfLine(p);return{textSpans:r,textBgRects:l}},_createTextCharSpan:function(h,f,r,l){var a=h!==h.trim()||h.match(n),d=this.getSvgSpanStyles(f,a),p=d?'style="'+d+'"':"",c=f.deltaY,m="",_=t.Object.NUM_FRACTION_DIGITS;return c&&(m=' dy="'+o(c,_)+'" '),['<tspan x="',o(r,_),'" y="',o(l,_),'" ',m,p,">",t.util.string.escapeXml(h),"</tspan>"].join("")},_setSVGTextLineText:function(h,f,r,l){var a=this.getHeightOfLine(f),d=this.textAlign.indexOf("justify")!==-1,p,c,m="",_,b,y=0,x=this._textLines[f],C;l+=a*(1-this._fontSizeFraction)/this.lineHeight;for(var T=0,k=x.length-1;T<=k;T++)C=T===k||this.charSpacing,m+=x[T],_=this.__charBounds[f][T],y===0?(r+=_.kernedWidth-_.width,y+=_.width):y+=_.kernedWidth,d&&!C&&this._reSpaceAndTab.test(x[T])&&(C=!0),C||(p=p||this.getCompleteStyleDeclaration(f,T),c=this.getCompleteStyleDeclaration(f,T+1),C=t.util.hasStyleChanged(p,c,!0)),C&&(b=this._getStyleDeclaration(f,T)||{},h.push(this._createTextCharSpan(m,b,r,l)),m="",p=c,r+=y,y=0)},_pushTextBgRect:function(h,f,r,l,a,d){var p=t.Object.NUM_FRACTION_DIGITS;h.push("		<rect ",this._getFillAttributes(f),' x="',o(r,p),'" y="',o(l,p),'" width="',o(a,p),'" height="',o(d,p),`"></rect>
`)},_setSVGTextLineBg:function(h,f,r,l){for(var a=this._textLines[f],d=this.getHeightOfLine(f)/this.lineHeight,p=0,c=0,m,_,b=this.getValueOfPropertyAt(f,0,"textBackgroundColor"),y=0,x=a.length;y<x;y++)m=this.__charBounds[f][y],_=this.getValueOfPropertyAt(f,y,"textBackgroundColor"),_!==b?(b&&this._pushTextBgRect(h,b,r+c,l,p,d),c=m.left,p=m.width,b=_):p+=m.kernedWidth;_&&this._pushTextBgRect(h,_,r+c,l,p,d)},_getFillAttributes:function(h){var f=h&&typeof h=="string"?new t.Color(h):"";return!f||!f.getSource()||f.getAlpha()===1?'fill="'+h+'"':'opacity="'+f.getAlpha()+'" fill="'+f.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(h){for(var f=0,r=0,l=0;l<h;l++)f+=this.getHeightOfLine(l);return r=this.getHeightOfLine(l),{lineTop:f,offset:(this._fontSizeMult-this._fontSizeFraction)*r/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(h){var f=t.Object.prototype.getSvgStyles.call(this,h);return f+" white-space: pre;"}})}(),function(o){var n=o.fabric||(o.fabric={});n.Textbox=n.util.createClass(n.IText,n.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:n.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(h){for(var f=0,r=0,l=0,a={},d=0;d<h.graphemeLines.length;d++)h.graphemeText[l]===`
`&&d>0?(r=0,l++,f++):!this.splitByGrapheme&&this._reSpaceAndTab.test(h.graphemeText[l])&&d>0&&(r++,l++),a[d]={line:f,offset:r},l+=h.graphemeLines[d].length,r+=h.graphemeLines[d].length;return a},styleHas:function(h,f){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[f];r&&(f=r.line)}return n.Text.prototype.styleHas.call(this,h,f)},isEmptyStyles:function(h){if(!this.styles)return!0;var f=0,r=h+1,l,a,d=!1,p=this._styleMap[h],c=this._styleMap[h+1];p&&(h=p.line,f=p.offset),c&&(r=c.line,d=r===h,l=c.offset),a=typeof h>"u"?this.styles:{line:this.styles[h]};for(var m in a)for(var _ in a[m])if(_>=f&&(!d||_<l))for(var b in a[m][_])return!1;return!0},_getStyleDeclaration:function(h,f){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[h];if(!r)return null;h=r.line,f=r.offset+f}return this.callSuper("_getStyleDeclaration",h,f)},_setStyleDeclaration:function(h,f,r){var l=this._styleMap[h];h=l.line,f=l.offset+f,this.styles[h][f]=r},_deleteStyleDeclaration:function(h,f){var r=this._styleMap[h];h=r.line,f=r.offset+f,delete this.styles[h][f]},_getLineStyle:function(h){var f=this._styleMap[h];return!!this.styles[f.line]},_setLineStyle:function(h){var f=this._styleMap[h];this.styles[f.line]={}},_wrapText:function(h,f){var r=[],l;for(this.isWrapping=!0,l=0;l<h.length;l++)r=r.concat(this._wrapLine(h[l],l,f));return this.isWrapping=!1,r},_measureWord:function(h,f,r){var l=0,a,d=!0;r=r||0;for(var p=0,c=h.length;p<c;p++){var m=this._getGraphemeBox(h[p],f,p+r,a,d);l+=m.kernedWidth,a=h[p]}return l},_wrapLine:function(h,f,r,z){var a=0,d=this.splitByGrapheme,p=[],c=[],m=d?n.util.string.graphemeSplit(h):h.split(this._wordJoiners),_="",b=0,y=d?"":" ",x=0,C=0,T=0,k=!0,E=this._getWidthOfCharSpacing(),z=z||0;m.length===0&&m.push([]),r-=z;for(var N=0;N<m.length;N++)_=d?m[N]:n.util.string.graphemeSplit(m[N]),x=this._measureWord(_,f,b),b+=_.length,a+=C+x-E,a>r&&!k?(p.push(c),c=[],a=x,k=!0):a+=E,!k&&!d&&c.push(y),c=c.concat(_),C=d?0:this._measureWord([y],f,b),b++,k=!1,x>T&&(T=x);return N&&p.push(c),T+z>this.dynamicMinWidth&&(this.dynamicMinWidth=T-E+z),p},isEndOfWrapping:function(h){return!this._styleMap[h+1]||this._styleMap[h+1].line!==this._styleMap[h].line},missingNewlineOffset:function(h){return this.splitByGrapheme?this.isEndOfWrapping(h)?1:0:1},_splitTextIntoLines:function(h){for(var f=n.Text.prototype._splitTextIntoLines.call(this,h),r=this._wrapText(f.lines,this.width),l=new Array(r.length),a=0;a<r.length;a++)l[a]=r[a].join("");return f.lines=l,f.graphemeLines=r,f},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var h={};for(var f in this._styleMap)this._textLines[f]&&(h[this._styleMap[f].line]=1);for(var f in this.styles)h[f]||delete this.styles[f]},toObject:function(h){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(h))}}),n.Textbox.fromObject=function(h,f){var r=n.util.stylesFromArray(h.styles,h.text),l=Object.assign({},h,{styles:r});return n.Object._fromObject("Textbox",l,f,"text")}}(i),function(){var o=t.controlsUtils,n=o.scaleSkewCursorStyleHandler,h=o.scaleCursorStyleHandler,f=o.scalingEqually,r=o.scalingYOrSkewingX,l=o.scalingXOrSkewingY,a=o.scaleOrSkewActionName,d=t.Object.prototype.controls;if(d.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:n,actionHandler:l,getActionName:a}),d.mr=new t.Control({x:.5,y:0,cursorStyleHandler:n,actionHandler:l,getActionName:a}),d.mb=new t.Control({x:0,y:.5,cursorStyleHandler:n,actionHandler:r,getActionName:a}),d.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:n,actionHandler:r,getActionName:a}),d.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:h,actionHandler:f}),d.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:h,actionHandler:f}),d.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:h,actionHandler:f}),d.br=new t.Control({x:.5,y:.5,cursorStyleHandler:h,actionHandler:f}),d.mtr=new t.Control({x:0,y:-.5,actionHandler:o.rotationWithSnapping,cursorStyleHandler:o.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var p=t.Textbox.prototype.controls={};p.mtr=d.mtr,p.tr=d.tr,p.br=d.br,p.tl=d.tl,p.bl=d.bl,p.mt=d.mt,p.mb=d.mb,p.mr=new t.Control({x:.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:n,actionName:"resizing"}),p.ml=new t.Control({x:-.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:n,actionName:"resizing"})}}()})(po);function Su(i,t,e){const s=wu(i,t,e);return ku(s)}function wu(i,t,e){const[s,u,g]=Tu(i);t.fillStyle="rgba(255, 255, 255, 255)",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.save(),t.canvas.width=Math.max(s,u)*1.2,t.canvas.height=Math.max(s,u)*1.2;const v=(t.canvas.width-s)/2,o=(t.canvas.height-u)/2;t.putImageData(g,v,o),e.save(),e.clearRect(0,0,e.canvas.height,e.canvas.width),e.fillStyle="rgba(255, 255, 255, 255)",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.scale(28/t.canvas.height,28/t.canvas.width),e.drawImage(t.canvas,0,0);const{data:n}=e.getImageData(0,0,28,28);return e.restore(),n}function Tu(i){const t=i.getImageData(0,0,i.canvas.width,i.canvas.height),{sx:e,sy:s,sw:u,sh:g}=Ou(t);return[u,g,i.getImageData(e,s,u,g)]}function Ou(i){const t=i.width,e=i.height;let s=t,u=e,g=0,v=0;for(let o=0;o<e;o++)for(let n=0;n<t;n++){const h=(o*t+n)*4;let f=i.data[h],r=i.data[h+1],l=i.data[h+2];Math.min(f,r,l)!=255&&(n<s?s=n:n>g&&(g=n),o<u?u=o:o>v&&(v=o))}return{sx:s,sy:u,sw:1+g-s,sh:1+v-u}}function ku(i){let t=new Float64Array(i.length/4);for(let e=0;e<i.length;e+=4){const s=255-i[e],u=255-i[e+1],g=255-i[e+2];255-i[e+3];const v=.299*s+.587*u+.114*g;t[e/4]=v}return t}function Pu(i){let t,e,s,u,g,v,o,n;return{c(){t=ot("div"),e=ot("div"),s=ot("canvas"),u=bt(),g=ot("div"),v=ot("canvas"),o=bt(),n=ot("canvas"),ht(s,"width","300"),ht(s,"height","300"),ht(e,"id","canvas-wrapper"),ht(e,"class","svelte-o19mfq"),ht(v,"width","28"),ht(v,"height","28"),ht(v,"class","svelte-o19mfq"),ht(n,"width","28"),ht(n,"height","28"),ht(n,"class","svelte-o19mfq"),ht(g,"id","hidden"),ht(g,"class","svelte-o19mfq")},m(h,f){ft(h,t,f),rt(t,e),rt(e,s),i[4](s),rt(t,u),rt(t,g),rt(g,v),i[5](v),rt(g,o),rt(g,n),i[6](n)},p:yt,i:yt,o:yt,d(h){h&&ut(t),i[4](null),i[5](null),i[6](null)}}}function Mu(i,t,e){const s=xr();let u,g,v,o,n,h,f;function r(){u.clear(),u.backgroundColor="rgba(255, 255, 255, 255)",u.renderAll(),n.clearRect(0,0,n.canvas.width,n.canvas.height),h.clearRect(0,0,h.canvas.width,h.canvas.height),f.clearRect(0,0,f.canvas.width,f.canvas.height)}en(()=>{n=g.getContext("2d",{willReadFrequently:!0}),h=v.getContext("2d",{willReadFrequently:!0}),f=o.getContext("2d",{willReadFrequently:!0}),u=new po.fabric.Canvas(g,{isDrawingMode:!0}),u.freeDrawingBrush.color="black",u.freeDrawingBrush.width=25,u.backgroundColor="rgba(255, 255, 255, 255)";let p,c=!1,m=!1;function _(){clearTimeout(p),p=setTimeout(()=>{m=!0,u.freeDrawingBrush._finalizeAndAddPath();const b=Su(u.getContext(),h,f);s("fire",b),m=!1},50),m=!0}u.on("mouse:down",b=>{c=!0}),u.on("mouse:up",b=>{c=!1,_()}),u.on("mouse:move",b=>{c&&m==!1&&_()})});function l(p){Zt[p?"unshift":"push"](()=>{g=p,e(0,g)})}function a(p){Zt[p?"unshift":"push"](()=>{v=p,e(1,v)})}function d(p){Zt[p?"unshift":"push"](()=>{o=p,e(2,o)})}return[g,v,o,r,l,a,d]}class Du extends Ut{constructor(t){super(),Ht(this,t,Mu,Pu,Xt,{clear_canvas:3})}get clear_canvas(){return this.$$.ctx[3]}}function Au(i){let t;return{c(){t=ot("canvas")},m(e,s){ft(e,t,s),i[3](t)},p:yt,i:yt,o:yt,d(e){e&&ut(t),i[3](null)}}}function Eu(i,t,e){Lt.register(Li,Wi,En,co,fo);let s,u,{data:g}=t;en(()=>{e(2,u=new Lt(s,{type:"bar",data:{labels:[0,1,2,3,4,5,6,7,8,9],datasets:[{label:"Probability",data:g}]},options:{responsive:!0,scales:{x:{type:"category",title:{display:!0,text:"Digit"},grid:{display:!1}},y:{type:"linear",min:0,max:1,title:{display:!0,text:"Confidence"},grid:{display:!1}}}}}))});function v(o){Zt[o?"unshift":"push"](()=>{s=o,e(0,s)})}return i.$$set=o=>{"data"in o&&e(1,g=o.data)},i.$$.update=()=>{i.$$.dirty&6&&g&&u&&(e(2,u.data.datasets[0].data=g,u),u.update())},[s,g,u,v]}class Fu extends Ut{constructor(t){super(),Ht(this,t,Eu,Au,Xt,{data:1})}}function Lu(i){let t,e,s,u,g,v,o,n,h,f,r,l={};return s=new Du({props:l}),i[3](s),s.$on("fire",i[4]),n=new Fu({props:{data:i[0]}}),{c(){t=ot("div"),e=ot("div"),qt(s.$$.fragment),u=bt(),g=ot("button"),g.textContent="Clear",v=bt(),o=ot("div"),qt(n.$$.fragment),ht(t,"class","grid")},m(a,d){ft(a,t,d),rt(t,e),Nt(s,e,null),rt(e,u),rt(e,g),rt(t,v),rt(t,o),Nt(n,o,null),h=!0,f||(r=jt(g,"click",i[2]),f=!0)},p(a,[d]){const p={};s.$set(p);const c={};d&1&&(c.data=a[0]),n.$set(c)},i(a){h||(Dt(s.$$.fragment,a),Dt(n.$$.fragment,a),h=!0)},o(a){Rt(s.$$.fragment,a),Rt(n.$$.fragment,a),h=!1},d(a){a&&ut(t),i[3](null),Vt(s),Vt(n),f=!1,r()}}}function Ru(i,t,e){let{data:s}=t,u;function g(){u.clear_canvas(),e(0,s=[])}function v(n){Zt[n?"unshift":"push"](()=>{u=n,e(1,u)})}function o(n){To.call(this,i,n)}return i.$$set=n=>{"data"in n&&e(0,s=n.data)},[s,u,g,v,o]}class Iu extends Ut{constructor(t){super(),Ht(this,t,Ru,Lu,Xt,{data:0})}}class Bu{constructor(t){nt(this,"worker");nt(this,"count",0);nt(this,"resolvers",new Map);nt(this,"handlers",{});this.worker=t,this.worker.onmessage=({data:e})=>{e.type=="req"?this.handleReq(e):e.type=="ack"&&this.handleAck(e)}}request(t,e,s){const u=ju(this.count,t);return this.count++,this.worker.postMessage({type:"req",id:u,key:t,value:e},{transfer:s}),new Promise((g,v)=>{this.resolvers.has(u)?v(`Duplicate resolver id: ${u}`):this.resolvers.set(u,{res:g,rej:v})})}handle(t,e){this.handlers[t]=e}ack(t,e,s,u){this.worker.postMessage({type:"ack",id:t,key:e,value:s},{transfer:u})}handleReq({id:t,key:e,value:s}){const u=this.handlers[e];if(u!=null){const g=u(s);this.ack(t,e,g.value,g.transfer)}else this.worker.postMessage({type:"ack",id:t,key:e,value:null,err:"handler not set"})}handleAck({id:t,key:e,value:s,err:u}){const g=this.resolvers.get(t);g!==void 0&&(u===void 0?g.res.call(null,s):g.rej.call(null,u),this.resolvers.delete(t))}}function ju(...i){return i.map(t=>String(t)).join(".")}class zu{constructor(){nt(this,"pipe");nt(this,"handlers",{});this.pipe=new Bu(new Worker(new URL("/digit-recognizer/assets/wasm.worker-6280e143.js",self.location),{type:"module"})),this.pipe.handle("step",t=>{var s;return{value:(s=this.handlers.step)==null?void 0:s.call(null,t)}})}set on_step(t){this.handlers.step=t}send(t,e,s){return this.pipe.request(t,e,s)}}function Wu(i){let t,e,s,u,g;function v(n){i[14](n)}let o={};return i[0].param.perceptron!==void 0&&(o.param=i[0].param.perceptron),s=new Vo({props:o}),Zt.push(()=>In(s,"param",v)),{c(){t=ot("h3"),t.textContent="Perceptron (1-layer Neural Network)",e=bt(),qt(s.$$.fragment)},m(n,h){ft(n,t,h),ft(n,e,h),Nt(s,n,h),g=!0},p(n,h){const f={};!u&&h&1&&(u=!0,f.param=n[0].param.perceptron,Rn(()=>u=!1)),s.$set(f)},i(n){g||(Dt(s.$$.fragment,n),g=!0)},o(n){Rt(s.$$.fragment,n),g=!1},d(n){n&&(ut(t),ut(e)),Vt(s,n)}}}function Nu(i){let t,e,s,u,g;function v(n){i[13](n)}let o={};return i[0].param.knn!==void 0&&(o.param=i[0].param.knn),s=new zo({props:o}),Zt.push(()=>In(s,"param",v)),{c(){t=ot("h3"),t.textContent="K Nearest Neighbors",e=bt(),qt(s.$$.fragment)},m(n,h){ft(n,t,h),ft(n,e,h),Nt(s,n,h),g=!0},p(n,h){const f={};!u&&h&1&&(u=!0,f.param=n[0].param.knn,Rn(()=>u=!1)),s.$set(f)},i(n){g||(Dt(s.$$.fragment,n),g=!0)},o(n){Rt(s.$$.fragment,n),g=!1},d(n){n&&(ut(t),ut(e)),Vt(s,n)}}}function Vu(i){let t,e,s,u,g,v,o;function n(f){i[12](f)}let h={};return i[0].param.kmeans!==void 0&&(h.param=i[0].param.kmeans),g=new Io({props:h}),Zt.push(()=>In(g,"param",n)),{c(){t=ot("h3"),t.textContent="K Means Clustering",e=bt(),s=ot("p"),s.innerHTML=`The K Means clustering is an algorithm that groups data into <i>K</i> number
        of clusters by assigning each observation to a cluster with the closest centroid
        (center of cluster).`,u=bt(),qt(g.$$.fragment)},m(f,r){ft(f,t,r),ft(f,e,r),ft(f,s,r),ft(f,u,r),Nt(g,f,r),o=!0},p(f,r){const l={};!v&&r&1&&(v=!0,l.param=f[0].param.kmeans,Rn(()=>v=!1)),g.$set(l)},i(f){o||(Dt(g.$$.fragment,f),o=!0)},o(f){Rt(g.$$.fragment,f),o=!1},d(f){f&&(ut(t),ut(e),ut(s),ut(u)),Vt(g,f)}}}function Yu(i){let t,e,s,u,g,v,o,n,h,f,r,l,a,d,p,c,m,_,b,y,x,C,T=(i[3]*100).toFixed(2)+"",k,E,z,N,$=i[4]?"Evaluating":"Evaluate",J,K,G,Q,tt,it,w,M;const D=[Vu,Nu,Wu],P=[];function R(O,S){return O[0].selected=="kmeans"?0:O[0].selected=="knn"?1:O[0].selected=="perceptron"?2:-1}return~(r=R(i))&&(l=P[r]=D[r](i)),d=new mu({props:{data:i[1]}}),c=new bu({}),c.$on("start",i[5]),c.$on("stop",i[6]),c.$on("continue",i[7]),c.$on("reset",i[8]),tt=new Iu({props:{data:i[2]}}),tt.$on("fire",i[15]),{c(){t=ot("header"),e=ot("h1"),e.textContent="Train your own AI locally in your browser!",s=bt(),u=ot("label"),g=Jt(`Select a model type to train:
        `),v=ot("select"),o=ot("option"),o.textContent="K Means Clustering",n=ot("option"),n.textContent="K Nearest Neighbors",h=ot("option"),h.textContent="Perceptron (1-layer Neural Network)",f=bt(),l&&l.c(),a=bt(),qt(d.$$.fragment),p=bt(),qt(c.$$.fragment),m=bt(),_=ot("footer"),b=ot("h5"),b.textContent="Test the model using MNIST testing dataset (10,000 observations):",y=bt(),x=ot("p"),C=Jt("Error Rate: "),k=Jt(T),E=Jt("%"),z=bt(),N=ot("button"),J=Jt($),K=bt(),G=ot("h5"),G.textContent="Test the model by drawing a digit:",Q=bt(),qt(tt.$$.fragment),o.__value="kmeans",zt(o,o.__value),n.__value="knn",zt(n,n.__value),h.__value="perceptron",zt(h,h.__value),i[0].selected===void 0&&Xi(()=>i[11].call(v)),ht(N,"aria-busy",i[4])},m(O,S){ft(O,t,S),rt(t,e),rt(t,s),rt(t,u),rt(u,g),rt(u,v),rt(v,o),rt(v,n),rt(v,h),Zn(v,i[0].selected,!0),ft(O,f,S),~r&&P[r].m(O,S),ft(O,a,S),Nt(d,O,S),ft(O,p,S),Nt(c,O,S),ft(O,m,S),ft(O,_,S),rt(_,b),rt(_,y),rt(_,x),rt(x,C),rt(x,k),rt(x,E),rt(_,z),rt(_,N),rt(N,J),rt(_,K),rt(_,G),rt(_,Q),Nt(tt,_,null),it=!0,w||(M=[jt(v,"change",i[11]),jt(N,"click",i[10])],w=!0)},p(O,[S]){S&1&&Zn(v,O[0].selected);let A=r;r=R(O),r===A?~r&&P[r].p(O,S):(l&&(Do(),Rt(P[A],1,1,()=>{P[A]=null}),Ao()),~r?(l=P[r],l?l.p(O,S):(l=P[r]=D[r](O),l.c()),Dt(l,1),l.m(a.parentNode,a)):l=null);const L={};S&2&&(L.data=O[1]),d.$set(L),(!it||S&8)&&T!==(T=(O[3]*100).toFixed(2)+"")&&Qn(k,T),(!it||S&16)&&$!==($=O[4]?"Evaluating":"Evaluate")&&Qn(J,$),(!it||S&16)&&ht(N,"aria-busy",O[4]);const W={};S&4&&(W.data=O[2]),tt.$set(W)},i(O){it||(Dt(l),Dt(d.$$.fragment,O),Dt(c.$$.fragment,O),Dt(tt.$$.fragment,O),it=!0)},o(O){Rt(l),Rt(d.$$.fragment,O),Rt(c.$$.fragment,O),Rt(tt.$$.fragment,O),it=!1},d(O){O&&(ut(t),ut(f),ut(a),ut(p),ut(m),ut(_)),~r&&P[r].d(O),Vt(d,O),Vt(c,O),Vt(tt),w=!1,ce(M)}}}function Xu(i,t,e){const s={selected:"kmeans",is_training:!1,param:{kmeans:{max_iter:100,n_clusters:10},knn:{k:10},perceptron:{max_iter:100,learning_rate:.01}}};let u=[],g=[];const v=new zu;async function o(){e(1,u=[]);const y={type:s.selected,param:s.param[s.selected]};await v.send("init_model",y),await v.send("start_training",null)}async function n(){await v.send("stop_training",null)}async function h(){await v.send("start_training",null)}async function f(){await v.send("free_model",null),e(1,u=[])}async function r(y){const x=await v.send("predict",y,[y.buffer]);e(2,g=Array.from(x))}v.on_step=y=>{console.log(`[main][step]: ${y.i}: err: ${y.err}`);const x=s.param[s.selected],C="max_iter"in x?x.max_iter:1;y.i>=C&&n(),y.i<=C&&e(1,u=[...u,{x:y.i,y:y.err}])};let l,a=!1;function d(){e(4,a=!0),v.send("evaluate",null).then(y=>{e(3,l=y),e(4,a=!1)})}function p(){s.selected=So(this),e(0,s)}function c(y){i.$$.not_equal(s.param.kmeans,y)&&(s.param.kmeans=y,e(0,s))}function m(y){i.$$.not_equal(s.param.knn,y)&&(s.param.knn=y,e(0,s))}function _(y){i.$$.not_equal(s.param.perceptron,y)&&(s.param.perceptron=y,e(0,s))}return[s,u,g,l,a,o,n,h,f,r,d,p,c,m,_,({detail:y})=>r(y)]}class Hu extends Ut{constructor(t){super(),Ht(this,t,Xu,Yu,Xt,{})}}function Uu(i){let t,e,s=[{xmlns:"http://www.w3.org/2000/svg"},{width:"1em"},{height:"1em"},{viewBox:"0 0 98 98"},i[0]],u={};for(let g=0;g<s.length;g+=1)u=je(u,s[g]);return{c(){t=Vi("svg"),e=Vi("path"),ht(e,"fill-rule","evenodd"),ht(e,"clip-rule","evenodd"),ht(e,"d","M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"),ht(e,"fill","currentColor"),Yi(t,u)},m(g,v){ft(g,t,v),rt(t,e)},p(g,[v]){Yi(t,u=Sr(s,[{xmlns:"http://www.w3.org/2000/svg"},{width:"1em"},{height:"1em"},{viewBox:"0 0 98 98"},v&1&&g[0]]))},i:yt,o:yt,d(g){g&&ut(t)}}}function Gu(i,t,e){return i.$$set=s=>{e(0,t=je(je({},t),Ni(s)))},t=Ni(t),[t]}class $u extends Ut{constructor(t){super(),Ht(this,t,Gu,Uu,Xt,{})}}function qu(i){let t,e,s=[{xmlns:"http://www.w3.org/2000/svg"},{width:"1em"},{height:"1em"},{viewBox:"0 0 24 24"},i[0]],u={};for(let g=0;g<s.length;g+=1)u=je(u,s[g]);return{c(){t=Vi("svg"),e=Vi("path"),ht(e,"fill","currentColor"),ht(e,"d","M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2S2 6.477 2 12s4.477 10 10 10Zm0-2V4a8 8 0 1 1 0 16Z"),Yi(t,u)},m(g,v){ft(g,t,v),rt(t,e)},p(g,[v]){Yi(t,u=Sr(s,[{xmlns:"http://www.w3.org/2000/svg"},{width:"1em"},{height:"1em"},{viewBox:"0 0 24 24"},v&1&&g[0]]))},i:yt,o:yt,d(g){g&&ut(t)}}}function Ku(i,t,e){return i.$$set=s=>{e(0,t=je(je({},t),Ni(s)))},t=Ni(t),[t]}class Ju extends Ut{constructor(t){super(),Ht(this,t,Ku,qu,Xt,{})}}function Qu(i){let t,e,s,u,g,v,o,n,h,f,r,l,a,d;return o=new $u({}),r=new Ju({}),{c(){t=ot("nav"),e=ot("ul"),e.innerHTML="<li><strong>Digit Recognizer</strong></li>",s=bt(),u=ot("ul"),g=ot("li"),v=ot("a"),qt(o.$$.fragment),n=bt(),h=ot("li"),f=ot("button"),qt(r.$$.fragment),ht(v,"class","contrast"),ht(v,"href","https://github.com/Jgansaown/digit-recognizer"),Ve(f,"padding","0"),Ve(f,"background","none"),Ve(f,"border","none"),Ve(f,"box-shadow","none"),Ve(f,"color","inherit"),ht(t,"class","svelte-10k1ie")},m(p,c){ft(p,t,c),rt(t,e),rt(t,s),rt(t,u),rt(u,g),rt(g,v),Nt(o,v,null),rt(u,n),rt(u,h),rt(h,f),Nt(r,f,null),l=!0,a||(d=jt(f,"click",i[0]),a=!0)},p:yt,i(p){l||(Dt(o.$$.fragment,p),Dt(r.$$.fragment,p),l=!0)},o(p){Rt(o.$$.fragment,p),Rt(r.$$.fragment,p),l=!1},d(p){p&&ut(t),Vt(o),Vt(r),a=!1,d()}}}function vr(i){return()=>getComputedStyle(document.body).getPropertyValue(i)}function Zu(){if(typeof window.localStorage<"u"){const i=window.localStorage.getItem("data-theme");if(i=="dark"||i=="light")return i}}function tf(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function ef(i){let t="dark";Lt.defaults.color=vr("--color"),Lt.defaults.borderColor=vr("--muted-color");function e(){t=t=="dark"?"light":"dark",s(t)}function s(u){document.documentElement.setAttribute("data-theme",u),window.localStorage.setItem("data-theme",u),Object.values(Lt.instances).forEach(g=>g.update())}return en(()=>{const u=Zu();u!=null?t=u:t=tf(),s(t)}),[e]}class nf extends Ut{constructor(t){super(),Ht(this,t,ef,Qu,Xt,{})}}function sf(i){let t,e,s,u,g;return t=new nf({}),u=new Hu({}),{c(){qt(t.$$.fragment),e=bt(),s=ot("article"),qt(u.$$.fragment)},m(v,o){Nt(t,v,o),ft(v,e,o),ft(v,s,o),Nt(u,s,null),g=!0},p:yt,i(v){g||(Dt(t.$$.fragment,v),Dt(u.$$.fragment,v),g=!0)},o(v){Rt(t.$$.fragment,v),Rt(u.$$.fragment,v),g=!1},d(v){v&&(ut(e),ut(s)),Vt(t,v),Vt(u)}}}class rf extends Ut{constructor(t){super(),Ht(this,t,null,sf,Xt,{})}}new rf({target:document.getElementById("app")});
